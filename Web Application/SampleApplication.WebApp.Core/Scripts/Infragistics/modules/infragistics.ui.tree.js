/*
* Infragistics.Web.ClientUI Tree localization resources 12.1.20121.1010
*
* Copyright (c) 2011-2012 Infragistics Inc.
*
* http://www.infragistics.com/
*
*/
$.ig=$.ig||{};if(!$.ig.Tree){$.ig.Tree={};$.extend($.ig.Tree,{locale:{invalidArgumentType:"Invalid argument type provided.",errorOnRequest:"An error has occurred while retrieving data: ",noDataSourceUrl:"The igTree control requires a dataSourceUrl provided in order to initiate a request for data to that URL.",incorrectPath:"A node was not found at the provided path: ",incorrectNodeObject:"The provided argument is not a jQuery node element.",setOptionError:"Runtime changes are not allowed for the following option: "}});
/*
 * Infragistics.Web.ClientUI Tree 12.1.20121.1010
 *
 * Copyright (c) 2011-2012 Infragistics Inc.
 *
 * http://www.infragistics.com/
 *
 * Depends on:
 *  jquery-1.4.4.js
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	ig.templating.js
 *	ig.dataSource.js
 *  ig.ui.shared.js
 *	ig.util.js
 *	ig.ui.tree-en.js
 */
}if(typeof(jQuery)==="undefined"){throw new Error("jQuery is undefined")}(function(a){a.widget("ui.igTree",{css:{tree:"ui-widget ui-igtree",treeCollection:"ui-igtree-collection",treeNode:"ui-igtree-node",treeRoot:"ui-igtree-root ui-widget-content",treeRootNode:"ui-igtree-noderoot",nodeNoChildren:"ui-igtree-node-nochildren",parentNode:"ui-igtree-parentnode",collapseIcon:"ui-icon ui-icon-triangle-1-s",expandIcon:"ui-icon ui-icon-triangle-1-e",nodeExpander:"ui-igtree-expander",nodeNormal:"ui-state-default",nodeHightlight:"ui-state-highlight",nodeHovered:"ui-state-hover",nodeSelected:"ui-state-active",nodeActive:"ui-state-focus",checkbox:"ui-state-default ui-corner-all ui-igcheckbox-normal",checkboxOff:"ui-icon ui-icon-check ui-igcheckbox-normal-off",checkboxOn:"ui-icon ui-icon-check ui-igcheckbox-normal-on",checkboxPartial:"ui-icon ui-icon-check ui-state-disabled ui-igcheckbox-normal-on"},options:{width:null,height:null,checkboxMode:"off",singleBranchExpand:false,hotTracking:true,parentNodeImageUrl:null,parentNodeImageClass:null,parentNodeImageTooltip:null,leafNodeImageUrl:null,leafNodeImageClass:null,leafNodeImageTooltip:null,animationDuration:200,pathSeparator:"_",dataSource:null,dataSourceUrl:null,dataSourceType:null,responseDataKey:null,responseDataType:null,initialExpandDepth:-1,loadOnDemand:false,bindings:{textKey:"Text",textXPath:"@Text",valueKey:"Value",valueXPath:"@Value",imageUrlKey:"ImageUrl",imageUrlXPath:"@ImageUrl",navigateUrlKey:"NavigateUrl",navigateUrlXPath:"@NavigateUrl",targetKey:"Target",expandedKey:"Expanded",primaryKey:null,nodeContentTemplate:null,childDataProperty:"Nodes",childDataXPath:"Children",searchFieldXPath:"Nodes",bindings:{}}},events:{dataBinding:"dataBinding",dataBound:"dataBound",rendering:"rendering",rendered:"rendered",selectionChanging:"selectionChanging",selectionChanged:"selectionChanged",nodeCheckstateChanging:"nodeCheckstateChanging",nodeCheckstateChanged:"nodeCheckstateChanged",nodePopulating:"nodePopulating",nodePopulated:"nodePopulated",nodeCollapsing:"nodeCollapsing",nodeCollapsed:"nodeCollapsed",nodeExpanding:"nodeExpanding",nodeExpanded:"nodeExpanded",nodeClick:"nodeClick",nodeDoubleClick:"nodeDoubleClick"},widget:function(){return this.element},_createWidget:function(c,b){this.options.bindings=null;a.Widget.prototype._createWidget.apply(this,arguments)},_create:function(){var b=this.options;this.dataBind();this.element.addClass(this.css.tree);if(a.browser.msie&&parseInt(a.browser.version,10)===7&&this.element.css("position")==="static"){this.element.css("position","relative")}if(b.width){this.element.css("width",b.width)}if(b.height){this.element.css("height",b.height)}},_setOption:function(d,e){var b=this.css,c;switch(d){case"width":this.element.css("width",e);break;case"height":this.element.css("height",e);break;case"pathSeparator":throw new Error(a.ig.Tree.locale.setOptionError+d);case"bindings":throw new Error(a.ig.Tree.locale.setOptionError+d);case"loadOnDemand":throw new Error(a.ig.Tree.locale.setOptionError+d);case"initialExpandDepth":throw new Error(a.ig.Tree.locale.setOptionError+d);case"parentNodeImageUrl":c=this.element.find("img[data-role=parent-node-image]");if(c.length>0){c.attr("src",e)}else{throw new Error(a.ig.Tree.locale.setOptionError+d)}break;case"parentNodeImageTooltip":c=this.element.find("img[data-role=parent-node-image]");if(c.length<=0){c=this.element.find("span[data-role=parent-node-image]")}if(c.length>0){c.attr("title",e)}else{throw new Error(a.ig.Tree.locale.setOptionError+d)}break;case"parentNodeImageClass":c=this.element.find("span[data-role=parent-node-image]");if(c.length>0){c.removeClass();c.addClass(e)}else{throw new Error(a.ig.Tree.locale.setOptionError+d)}break;case"leafNodeImageUrl":c=this.element.find("img[data-role=leaf-node-image]");if(c.length>0){c.attr("src",e)}else{throw new Error(a.ig.Tree.locale.setOptionError+d)}break;case"leafNodeImageTooltip":c=this.element.find("img[data-role=leaf-node-image]");if(c.length<=0){c=this.element.find("span[data-role=leaf-node-image]")}if(c.length>0){c.attr("title",e)}else{throw new Error(a.ig.Tree.locale.setOptionError+d)}break;case"leafNodeImageClass":c=this.element.find("span[data-role=leaf-node-image]");if(c.length>0){c.removeClass();c.addClass(e)}else{throw new Error(a.ig.Tree.locale.setOptionError+d)}break;case"hotTracking":if(e){this.element.find("li > a").bind({mouseover:function(f){a(f.target).addClass(b.nodeHovered)},mouseout:function(f){a(f.target).removeClass(b.nodeHovered)}})}else{this.element.find("li > a").unbind("mouseover");this.element.find("li > a").unbind("mouseout")}break;case"checkboxMode":if(e.toLowerCase()==="off"){this._removeCheckboxes()}break;case"dataSource":this.dataBind();break;default:break}a.Widget.prototype._setOption.apply(this,arguments)},_removeCheckboxes:function(){this.element.find("span[data-role=checkbox]").remove()},_initDataOptions:function(){var b,d,c;c=this._initDataSourceSchema();if(!this.options.dataSource&&!this.options.dataSourceUrl){if(!this.element.is("ul")){d=this.element.children("ul");this.options.dataSource=d[0]}else{this.options.dataSource=this.element[0]}}else{if(!this.options.dataSource&&this.options.dataSourceUrl){this.options.dataSource=this.options.dataSourceUrl}}b={callback:this._constructFromData,callee:this,dataSource:this.options.dataSource,defaultChildrenDataProperty:this.options.bindings.childDataProperty,responseDataType:this.options.responseDataType,primaryKey:this.options.primaryKey,schema:c};if(this.options.dataSourceType){b.type=this.options.dataSourceType}return b},_initDataSourceSchema:function(){var d={},c=this.options,b=c.bindings;if(b===null){c.bindings={};d.text={name:"Text",type:"string"};c.bindings.textKey="Text";d.value={name:"Value",type:"string"};c.bindings.valueKey="Value";d.imageUrl={name:"ImageUrl",type:"string"};c.bindings.imageUrlKey="ImageUrl";d.navigateUrl={name:"NavigateUrl",type:"string"};c.bindings.navigateUrlKey="NavigateUrl";d.childData={name:"Nodes",type:"object"};c.bindings.childDataProperty="Nodes";d.target={name:"Target",type:"string"};c.bindings.targetKey="Target";b=c.bindings}else{if(c.dataSourceType==="xml"){if(b.searchFieldXPath){d.searchField=b.searchFieldXPath}}}d.fields=[];if(b.textKey){d.fields.push({name:b.textKey,type:"string",xpath:b.textXPath});d.textKey=b.textKey}if(b.valueKey){d.fields.push({name:b.valueKey,type:"string",xpath:b.valueXPath});d.valueKey=b.valueKey}if(b.navigateUrlKey){d.fields.push({name:b.navigateUrlKey,type:"string",xpath:b.navigateUrlXPath});d.navigateUrlKey=b.navigateUrlKey}if(b.imageUrlKey){d.fields.push({name:b.imageUrlKey,type:"string",xpath:b.imageUrlXPath});d.imageUrlKey=b.imageUrlKey}if(b.targetKey){d.fields.push({name:b.targetKey,type:"string"});d.targetKey=b.targetKey}if(b.expandedKey){d.fields.push({name:"Expanded",type:"boolean"});d.expandedKey=b.expandedKey}if(b.primaryKey){d.fields.push({name:b.primaryKey,type:"string"});d.primaryKey=b.primaryKey}d.fields.push({name:b.childDataProperty,type:"object",xpath:b.childDataXPath});d.childDataProperty=b.childDataProperty;if(!d.searchField&&c.responseDataKey){d.searchField=c.responseDataKey}return d},_initDataSource:function(b){var c=this.options;if(!(c.dataSource instanceof a.ig.HierarchicalDataSource)){c.dataSource=new a.ig.HierarchicalDataSource(b)}},_constructFromData:function(){var c,b=this.options.dataSource._rootds.data();this._triggerDataBound(b);this._triggerRendering(b);this.element.attr("data-scroll",true);if(this.element.is("ul")){this.element.empty();c=this.element;c.addClass(this.css.treeCollection).addClass(this.css.treeRoot).attr("data-depth",0);c.html(this._initChildrenRecursively("",b));this._attachEvents(c);this._triggerRendered()}else{this.element.empty();c='<ul class="'+this.css.treeCollection+" "+this.css.treeRoot+'" data-depth="0">';c+=this._initChildrenRecursively("",b);c+="</ul>";c=a(c);this._attachEvents(c);c.appendTo(this.element);this._triggerRendered()}},_attachEvents:function(d){var e=this,b=this.css,c,f;d.find("span[data-role=expander]").bind("click",function(g){e.toggle(a(g.target).closest("li[data-role=node]"),g)});if(this.options.hotTracking){d.find("li > a").bind({click:function(g){f=a(g.target).closest("a");c=e._triggerNodeClick(g,f.parent());if(c){e.select(f.parent(),g);if(a.browser.webkit){f.focus()}}else{g.preventDefault()}},dblclick:function(g){g.preventDefault();e._triggerNodeDoubleClick(g,a(g.target.parentNode))},keydown:function(g){e._kbNavigation(g)},focus:function(g){e._focusNode(g)},blur:function(g){e._blurNode(g)},mouseover:function(g){f=a(g.target).closest("a");f.addClass(b.nodeHovered)},mouseout:function(g){f=a(g.target).closest("a");f.removeClass(b.nodeHovered)}})}else{d.find("li > a").bind({click:function(g){f=a(g.target).closest("a");c=e._triggerNodeClick(g,f.parent());if(c){e.select(f.parent(),g);if(a.browser.webkit){f.focus()}}else{g.preventDefault()}},dblclick:function(g){g.preventDefault();e._triggerNodeDoubleClick(g,a(g.target.parentNode))},keydown:function(g){e._kbNavigation(g)},focus:function(g){e._focusNode(g)},blur:function(g){e._blurNode(g)}})}d.find("span[data-role=checkbox] > span").bind({click:function(g){e.toggleCheckstate(a(g.target).closest("li[data-role=node]"),g)},mouseover:function(g){a(g.target).closest("span[data-role=checkbox]").addClass(b.nodeHovered)},mouseout:function(g){a(g.target).closest("span[data-role=checkbox]").removeClass(b.nodeHovered)}})},_initChildrenRecursively:function(n,f,g,c){var e,m=this.options,d,b,o,h="block",l=[],j=0,k;if(!g){g=0}b=this._retrieveCurrentDepthBinding(g);if(!f.hasOwnProperty("length")&&f.hasOwnProperty(b.textKey)){f=[f]}for(j;j<f.length;j++){e="";o="";if(n.length<=0){d=b.hasOwnProperty("primaryKey")&&f[j].hasOwnProperty(b.primaryKey)?f[j][b.primaryKey]:j}else{d=b.hasOwnProperty("primaryKey")&&f[j].hasOwnProperty(b.primaryKey)?n+m.pathSeparator+f[j][b.primaryKey]:n+m.pathSeparator+j}if(b.hasOwnProperty("valueKey")&&f[j].hasOwnProperty(b.valueKey)){o=f[j][b.valueKey]}k='<li class="'+this._buildNodeCssString(f[j],g,b)+'" data-path="'+d+'" data-value="'+o+'" data-role="node">';if((f[j][b.childDataProperty]&&f[j][b.childDataProperty].length>0)||(f[j][b.childDataProperty]&&m.loadOnDemand)){if((g<=m.initialExpandDepth&&!m.loadOnDemand)||(b.hasOwnProperty("expandedKey")&&f[j].hasOwnProperty(b.expandedKey))){k+=this._renderExpanderImage(true)}else{k+=this._renderExpanderImage(false);h="none"}}if(m.checkboxMode&&m.checkboxMode.toLowerCase()!=="off"){k+=this._renderCheckbox(c)}k+=this._renderNodeImage(f[j],b);if(!b.nodeContentTemplate){k+=this._renderAnchor(f[j],b)}else{k+=this._renderNodeTemplate(f[j],b.nodeContentTemplate)}if((f[j][b.childDataProperty]&&f[j][b.childDataProperty].length>0)||(f[j][b.childDataProperty]&&m.loadOnDemand)){e='<ul style="display: '+h+'" data-depth="'+(g+1)+'"';if(f[j][b.childDataProperty].length>0&&!m.loadOnDemand){e+=">"+this._initChildrenRecursively(d,f[j][b.childDataProperty],g+1)}else{e+=' data-populated="false">'}e+="</ul>"}k+=e;k+="</li>";l.push(k)}return l.join("")},_buildNodeCssString:function(d,e,b){var c=this.css,f=c.treeNode;if(e===0){f+=" "+c.treeRootNode}if((d[b.childDataProperty]&&d[b.childDataProperty].length>0)||(d[b.childDataProperty]&&this.options.loadOnDemand)){f+=" "+c.parentNode}else{f+=" "+c.nodeNoChildren}return f},_retrieveCurrentDepthBinding:function(c){var b=this.options.bindings,d=0;for(d;d<c;d++){if(b.hasOwnProperty("bindings")){b=b.bindings}else{break}}return b},_renderExpanderImage:function(c){var e=this,b=e.css,d="";if(c){d='<span data-role="expander" data-exp="true" class="'+b.collapseIcon+" "+b.nodeExpander+'"></span>'}else{d='<span data-role="expander" data-exp="false" class="'+b.expandIcon+" "+b.nodeExpander+'"></span>'}return d},_renderAnchor:function(c,b){var d,e;if(b.hasOwnProperty("navigateUrlKey")&&c[b.navigateUrlKey]&&c[b.navigateUrlKey].length>0){d=c[b.navigateUrlKey]}else{d="#"}if(b.targetKey&&b.targetKey.length>0){e=c[b.targetKey]}else{e="_self"}return'<a href="'+d+'" target="'+e+'">'+c[b.textKey]+"</a>"},_renderNodeTemplate:function(b,e){var c=a("<div></div>"),d;if(typeof a.ig.tmpl==="function"){c.html(a.ig.tmpl(e,b));if(c.children("a").length<=0){d='<a href="#">'+c.html()+"</a>"}else{if(!c.children("a").attr("href")){c.children("a").attr("href","#");d=c.html()}else{d=c.html()}}}else{a.tmpl(e,b).appendTo(c);if(c.children("a").length<=0){d='<a href="#">'+c.html()+"</a>"}else{if(!c.children("a").attr("href")){c.children("a").attr("href","#");d=c.html()}else{d=c.html()}}}return d},_renderCheckbox:function(b){var d=this,c=d.css;return'<span data-chk="'+(b?"on":"off")+'" data-role="checkbox" class="'+c.checkbox+'"><span class="'+(b?c.checkboxOn:c.checkboxOff)+'"></span></span>'},_renderNodeImage:function(c,b){var f=this.options,d,e="";d=(c[b.childDataProperty]&&c[b.childDataProperty].length>0)||(c[b.childDataProperty]&&f.loadOnDemand);if(b.hasOwnProperty("imageUrlKey")&&c.hasOwnProperty(b.imageUrlKey)&&c[b.imageUrlKey].length>0){e='<img src="'+c[b.imageUrlKey]+'" alt="error" />'}if(f.parentNodeImageUrl&&d){e+='<img src="'+f.parentNodeImageUrl+'" alt="error" title="'+(f.parentNodeImageTooltip!==null?f.parentNodeImageTooltip:"")+'" data-role="parent-node-image" />'}else{if(f.parentNodeImageClass&&d){e+='<span title="'+(f.parentNodeImageTooltip!==null?f.parentNodeImageTooltip:"")+'" class="'+f.parentNodeImageClass+'" data-role="parent-node-image"></span>'}else{if(!d&&f.leafNodeImageUrl){e+='<img src="'+f.leafNodeImageUrl+'" alt="error" title="'+(f.leafNodeImageTooltip!==null?f.leafNodeImageTooltip:"")+'" data-role="leaf-node-image" />'}else{if(!d&&f.leafNodeImageClass){e+='<span title="'+(f.leafNodeImageTooltip!==null?f.leafNodeImageTooltip:"")+'" class="'+f.leafNodeImageClass+'" data-role="leaf-node-image"></span>'}}}}return e},_focusNode:function(b){a(b.target).addClass(this.css.nodeActive)},_blurNode:function(b){a(b.target).removeClass(this.css.nodeActive)},_kbNavigation:function(c){var g=this.options,b=this.css,e=a(c.target.parentNode),f,h=e.index(),d;if(c.keyCode===a.ui.keyCode.UP){f=this._nextVisibleNodeUp(e,h);if(!f){return}if(c.ctrlKey){e.children("a").blur();f.children("a").focus()}else{if(c.shiftKey&&g.multipleSelection){g=this.options}else{e.children("a").blur();f.children("a").focus();this.select(f,null)}}c.preventDefault()}else{if(c.keyCode===a.ui.keyCode.DOWN){f=this._nextVisibleNodeDown(e,h);if(!f){return}if(c.ctrlKey){e.children("a").blur();f.children("a").focus()}else{if(c.shiftKey&&g.multipleSelection){g=this.options}else{e.children("a").blur();f.children("a").focus();this.select(f,null)}}c.preventDefault()}else{if(c.keyCode===a.ui.keyCode.RIGHT){if(e.children("ul").length>0){d=e.children("."+b.nodeExpander);if(!d.attr("data-exp")||d.attr("data-exp")==="false"){this.toggle(e,null)}else{f=e.find("ul > li:first");if(f.length>0){if(c.ctrlKey){e.children("a").blur();f.children("a").focus()}else{if(c.shiftKey&&g.multipleSelection){g=this.options}else{e.children("a").blur();f.children("a").focus();this.select(f,null)}}}}}}else{if(c.keyCode===a.ui.keyCode.LEFT){d=e.children("."+b.nodeExpander);if(d.attr("data-exp")&&d.attr("data-exp")!=="false"){this.toggle(e,null)}else{if(e.parent().parent().is("li")){f=e.parent().parent();if(c.ctrlKey){e.children("a").blur();f.children("a").focus()}else{if(c.shiftKey&&g.multipleSelection){g=this.options}else{e.children("a").blur();f.children("a").focus();this.select(f,null)}}}}}else{if(c.keyCode===a.ui.keyCode.NUMPAD_ADD){if(e.children("ul").length>0){d=e.children("."+b.nodeExpander);if(!d.attr("data-exp")||d.attr("data-exp")==="false"){this.toggle(e,null)}}}else{if(c.keyCode===a.ui.keyCode.NUMPAD_SUBTRACT){if(e.children("ul").length>0){d=e.children("."+b.nodeExpander);if(d.attr("data-exp")&&d.attr("data-exp")!=="false"){this.toggle(e,null)}}}else{if(c.keyCode===a.ui.keyCode.SPACE){if(g.checkboxMode&&g.checkboxMode.toLowerCase()!=="off"){this.toggleCheckstate(e,null);c.preventDefault()}}else{if(c.keyCode===a.ui.keyCode.HOME){e.children("a").blur();e=this.element.find("li:first");if(e.length>0){e.children("a").focus();this.select(e)}c.preventDefault()}else{if(c.keyCode===a.ui.keyCode.END){e.children("a").blur();e=this._lastVisibleNode();if(e){e.children("a").focus();this.select(e)}c.preventDefault()}}}}}}}}}},_nextVisibleNodeDown:function(c,d){var b=c.children("."+this.css.nodeExpander),e,g=d,f=null;if(b.length>0&&b.attr("data-exp")&&b.attr("data-exp")!=="false"&&c.children("ul").children("li:first").length>0){return c.children("ul").children("li:first")}if(g===c.siblings().length){e=c.parent().parent();while(e.is("li")){g=e.index();if(g!==e.siblings().length){f=e.next();break}e=e.parent().parent()}}else{f=c.next()}return f},_nextVisibleNodeUp:function(d,e){var c=d.prev(),b,f=null;if(c.length<=0){if(d.parent().parent().is("li")){f=d.parent().parent()}}else{while(c.length>0){b=c.children("."+this.css.nodeExpander);if(c.children("ul").children("li").length<=0||!b.attr("data-exp")||b.attr("data-exp")==="false"){f=c;break}else{c=c.children("ul").children("li:last")}}}return f},_lastVisibleNode:function(){var c=this.element.is("ul")?this.element.children("li:last"):this.element.children("ul").children("li:last"),b,d;if(c.length<=0){d=null}else{while(c.length>0){b=c.children("."+this.css.nodeExpander);if(c.children("ul").children("li").length<=0||!b.attr("data-exp")||b.attr("data-exp")==="false"){d=c;break}else{c=c.children("ul").children("li:last")}}}return d},_populatingNode:null,_populateNodeData:function(i,f,d){if(!i){throw new Error(a.ig.Tree.locale.errorOnRequest+f)}var j=this._populatingNode.ul,h=this.nodeDataFor(this._populatingNode.node.attr("data-path")),e=j.attr("data-depth"),b=this._retrieveCurrentDepthBinding(e-1),c,g=d.data();if(this.options.checkboxMode.toLowerCase()==="tristate"){c=this.isChecked(this._populatingNode.node)}j.empty();j.hide();h[b.childDataProperty]=g;this._triggerNodePopulated(null,this._populatingNode.node);this._triggerRendering(g);j.html(this._initChildrenRecursively(this._populatingNode.node.attr("data-path"),g,parseInt(j.attr("data-depth"),10),c));j.attr("data-populated",true);this._attachEvents(j);this._triggerRendered();this.toggle(this._populatingNode.node);this._populatingNode.indicator.hide();this._populatingNode.indicator.destroy();this._populatingNode=null},_prepareRequest:function(j,f){var k=this.options,n,m,h,d,e,g,b,l,i,o,c;if(this._populatingNode!==null){return}i=this._triggerNodePopulating(f,j);if(i){n=this._buildRequestString(j);b=this._retrieveCurrentDepthBinding(parseInt(j.children("ul").attr("data-depth"),10));if(!n){return}m=n[0];h=n[1];d=this.nodeDataFor(j.attr("data-path"));l=this._retrieveCurrentDepthBinding(parseInt(j.children("ul").attr("data-depth"),10)-1);if(d.hasOwnProperty(l.childDataProperty)){d=d[l.childDataProperty]}if(d&&d.__deferred&&d.__deferred.uri){d=new a.ig.JSONPDataSource({dataSource:d.__deferred.uri+"?$format=json&$callback=?",responseDataKey:k.responseDataKey});o=j.children("ul");a('<li style="width: 20px">&nbsp;</li>').appendTo(o);o.show();g=o.children("li").igLoading({includeVerticalOffset:false}).data("igLoading").indicator();g.show();this._populatingNode={ul:o,node:j,indicator:g};d.dataBind(this._populateNodeData,this)}else{if(d.length>0&&!k.dataSourceUrl){o=j.children("ul");if(this.options.checkboxMode.toLowerCase()==="tristate"){c=this.isChecked(j)}this._triggerNodePopulated(f,j);this._triggerRendering(d);o.html(this._initChildrenRecursively(j.attr("data-path"),d,parseInt(o.attr("data-depth"),10),c));o.attr("data-populated",true);this._attachEvents(o);this._triggerRendered();this.toggle(j)}else{if(k.dataSourceUrl&&k.dataSourceUrl.lastIndexOf("?")===-1){k.dataSourceUrl+="?"}else{if(!k.dataSourceUrl){throw new Error(a.ig.Tree.locale.noDataSourceUrl)}}e=new a.ig.DataSource({dataSource:k.dataSourceUrl+"&"+this._encodeUrlPath(m,h)+"&"+this._encodeBinding(b)+"&depth="+j.parent().attr("data-depth"),dataSourceType:"remoteUrl"});o=j.children("ul");a('<li style="width: 20px">&nbsp;</li>').appendTo(o);o.show();g=o.children("li").igLoading({includeVerticalOffset:false}).data("igLoading").indicator();g.show();this._populatingNode={ul:o,node:j,indicator:g};e.dataBind(this._populateNodeData,this)}}}},_buildRequestString:function(e){var f,d="",g="",b=this.options.bindings,c,h;f=e.attr("data-path").split(this.options.pathSeparator);for(c=0;c<f.length;c++){if(d.length>0){d+="/"}d+=b.childDataProperty;if(g.length>0){g+="/"}g+=(b.primaryKey?b.primaryKey+":":"")+f[c];if(b.bindings){b=b.bindings}}if(g.length<=0){h=null}else{h=[g,d]}return h},_encodeBinding:function(b){var d="binding=",c;for(c in b){if(b.hasOwnProperty(c)&&c!=="bindings"&&c!=="nodeContentTemplate"){d+=c.toString()+":"+b[c]+","}}d=d.substr(0,d.length-1);return d},_encodeUrlPath:function(c,b){var d;if(c.lastIndexOf("/")===-1){c+="/@"+b;d="path="+c}else{d="path="+c.substr(c.lastIndexOf("/")+1,c.length)+"/@"+b.substr(b.lastIndexOf("/")+1,b.length)}return d},dataBind:function(){var b;b=this._initDataOptions();this._initDataSource(b);this._triggerDataBinding();this.options.dataSource.dataBind(this._constructFromData,this)},toggleCheckstate:function(i,g){var l=this,j=l.options,f=l.css,d,e,b,c,k,h;if(!i){throw new Error(a.ig.Tree.locale.incorrectNodeObject)}if(!j.checkboxMode||j.checkboxMode.toLowerCase()==="off"){return}b=i.children("span[data-role=checkbox]");c=b.children("span");h=l._triggerNodeCheckstateChanging(g,i);if(h){if(j.checkboxMode.toLowerCase()==="tristate"){if(b.attr("data-chk")==="on"||b.attr("data-chk")==="partial"){d=i.find("span[data-role=checkbox]");e=d.children("span");b.attr("data-chk","off");c.removeClass(f.checkboxOn).removeClass(f.checkboxPartial).addClass(f.checkboxOff);d.attr("data-chk","off");e.removeClass(f.checkboxOn).removeClass(f.checkboxPartial).addClass(f.checkboxOff);k=b.parent().parent().parent();while(k&&k.is("li")){if(k.find("ul > li > span[data-chk=on]").length<=0){b=k.children("span[data-role=checkbox]");c=b.children("span");b.attr("data-chk","off");c.removeClass(f.checkboxOn).removeClass(f.checkboxPartial).addClass(f.checkboxOff);k=this.parentNode(k)}else{b=k.children("span[data-role=checkbox]");c=b.children("span");b.attr("data-chk","partial");c.removeClass(f.checkboxOn).removeClass(f.checkboxOff).addClass(f.checkboxPartial);k=this.parentNode(k)}}}else{d=i.find("span[data-role=checkbox]");e=d.children("span");b.attr("data-chk","on");c.removeClass(f.checkboxOff).removeClass(f.checkboxPartial).addClass(f.checkboxOn);d.attr("data-chk","on");e.removeClass(f.checkboxOff).removeClass(f.checkboxPartial).addClass(f.checkboxOn);k=b.parent().parent().parent();while(k&&k.is("li")){if(k.find("ul > li > span[data-chk=on]").length===k.find("ul > li").length){b=k.children("span[data-role=checkbox]");c=b.children("span");b.attr("data-chk","on");c.removeClass(f.checkboxOff).removeClass(f.checkboxPartial).addClass(f.checkboxOn);k=this.parentNode(k)}else{b=k.children("span[data-role=checkbox]");c=b.children("span");b.attr("data-chk","partial");c.removeClass(f.checkboxOn).removeClass(f.checkboxOff).addClass(f.checkboxPartial);k=this.parentNode(k)}}}}else{if(b.attr("data-chk")==="on"||b.attr("data-chk")==="partial"){b.attr("data-chk","off");c.removeClass(f.checkboxOn).removeClass(f.checkboxPartial).addClass(f.checkboxOff)}else{b.attr("data-chk","on");c.removeClass(f.checkboxOff).addClass(f.checkboxOn)}}l._triggerNodeCheckstateChanged(g,i)}},toggle:function(g,c){var j=this,h=j.options,b=j.css,f,k,l,e=0,d;if(!g){throw new Error(a.ig.Tree.locale.incorrectNodeObject)}if(!c){d=g.children("."+b.nodeExpander)}else{d=a(c.target).closest("span[data-role=expander]")}if(g.children("ul").attr("data-populated")&&g.children("ul").attr("data-populated")==="false"){this._prepareRequest(g,c);return}if(d.attr("data-exp")&&d.attr("data-exp")!=="false"){f=j._triggerNodeCollapsing(c,g);if(f){a(g).children("ul").hide(h.animationDuration,function(){j._triggerNodeCollapsed(c,g)});d.removeClass(b.collapseIcon).addClass(b.expandIcon).attr("data-exp",false)}}else{f=j._triggerNodeExpanding(c,g);if(f){if(h.singleBranchExpand){k=g.siblings();for(e;e<k.length;e++){l=a(k[e]).children("."+b.nodeExpander);if(l.length>0&&(l.attr("data-exp")==="true"||l.attr("data-exp")===true)){f=j._triggerNodeCollapsing(c,a(k[e]));if(f){a(k[e]).children("ul").hide(h.animationDuration,a.proxy(this._triggerNodeCollapsed(c,a(k[e])),this));l.removeClass(b.collapseIcon).addClass(b.expandIcon).attr("data-exp",false)}}}}g.children("ul").show(h.animationDuration,function(){j._triggerNodeExpanded(c,g)});d.removeClass(b.expandIcon).addClass(b.collapseIcon).attr("data-exp",true)}}},expandToNode:function(c){var d,b;if(c&&c.length>0){d=this.parentNode(c);b=this.options.animationDuration;this.options.animationDuration=0;while(d){this.expand(d);d=this.parentNode(d)}this.options.animationDuration=b}else{throw new Error(a.ig.Tree.locale.incorrectNodeObject)}},expand:function(e){var g=this,f=g.options,b=g.css,h,j,d=0,c;if(!e||e.length<=0){throw new Error(a.ig.Tree.locale.incorrectNodeObject)}if(e.children("ul").attr("data-populated")&&e.children("ul").attr("data-populated")==="false"){this._prepareRequest(e);return}c=e.children("."+b.nodeExpander);if(!c.attr("data-exp")||c.attr("data-exp")==="false"){if(f.singleBranchExpand){h=e.siblings();for(d;d<h.length;d++){j=a(h[d]).children("."+b.nodeExpander);if(j.length>0&&(j.attr("data-exp")==="true"||j.attr("data-exp")===true)){a(h[d]).children("ul").hide(f.animationDuration);j.removeClass(b.collapseIcon).addClass(b.expandIcon).attr("data-exp",false)}}}e.children("ul").show(f.animationDuration);c.removeClass(b.expandIcon).addClass(b.collapseIcon).attr("data-exp",true)}},collapse:function(d){var f=this,e=f.options,b=f.css,c;if(!d||d.length<=0){throw new Error(a.ig.Tree.locale.incorrectNodeObject)}c=d.children("."+b.nodeExpander);if(c.attr("data-exp")&&c.attr("data-exp")!=="false"){a(d).children("ul").hide(e.animationDuration);c.removeClass(b.collapseIcon).addClass(b.expandIcon).attr("data-exp",false)}},parentNode:function(b){if(!b){throw new Error(a.ig.Tree.locale.incorrectNodeObject)}return b.parent().parent().is("li")?b.parent().parent():null},nodeByPath:function(b){return this.element.find('li[data-path="'+b+'"]')},nodesByValue:function(b){return this.element.find('li[data-value="'+b+'"]')},checkedNodes:function(){var c=this.element.find("span[data-chk=on]").parent(),d=0,b=[];if(c.length>0){for(d;d<c.length;d++){b.push(this.nodeFromElement(a(c[d])))}return b}},uncheckedNodes:function(){var c=this.element.find("span[data-chk=off]").parent(),d=0,b=[];if(c.length>0){for(d;d<c.length;d++){b.push(this.nodeFromElement(a(c[d])))}return b}},partiallyCheckedNodes:function(){var c=this.element.find("span[data-chk=partial]").parent(),d=0,b=[];if(c.length>0){for(d;d<c.length;d++){b.push(this.nodeFromElement(a(c[d])))}return b}},select:function(e,c){if(!e||e.length<=0){throw new Error(a.ig.Tree.locale.incorrectNodeObject)}var b=this.css,f=e.attr("data-path"),d,g=false;if(c&&(e.children("a").attr("href")==="#"||e.children("a").attr("href")===document.URLUnencoded+"#")){g=true}if(!this._selectedNode){this._selectedNode=[{path:null,element:null,data:null,binding:null}]}if(this._selectedNode[0].path!==null){if(this._selectedNode[0].path!==f){d=this._triggerSelectionChanging(c,e);if(d){this._selectedNode[0].element.children("a").removeClass(b.nodeSelected);e.children("a").addClass(b.nodeSelected);this._selectedNode[0]=this.nodeFromElement(e);this._triggerSelectionChanged(c)}else{if(c){g=true}}}}else{d=this._triggerSelectionChanging(c,e);if(d){e.children("a").addClass(b.nodeSelected);this._selectedNode[0]=this.nodeFromElement(e);this._triggerSelectionChanged(c)}else{if(c){g=true}}}if(g){c.preventDefault()}},deselect:function(c){if(!c){throw new Error(a.ig.Tree.locale.incorrectNodeObject)}var e=this.options,b=this.css,d=c.attr("data-path");if(!this._selectedNode){this._selectedNode=[{path:null,element:null,data:null,binding:null}]}if(e.multipleSelection){e=this.options}else{if(this._selectedNode[0].path!==null){if(this._selectedNode[0].path===d){c.children("a").removeClass(b.nodeSelected);this._selectedNode[0].path=null;this._selectedNode[0].element=null;this._selectedNode[0].data=null;this._selectedNode[0].binding=null}}}},clearSelection:function(){var b=this.css,c=0;if(this._selectedNode[0].path!==null){for(c;c<this._selectedNode.length;c++){this._selectedNode[c].element.children("a").removeClass(b.nodeSelected)}this._selectedNode=[{path:null,element:null,data:null,binding:null}]}},selectedNode:function(){if(!this._selectedNode){this._selectedNode=[{path:null,element:null,data:null,binding:null}]}return this._selectedNode[0]},findNodesByText:function(j,f){var d,b,h,g,c=[],e;if(f&&f.length>0){d=this.nodeDataFor(f.attr("data-path"));b=this._retrieveCurrentDepthBinding(f.parent().attr("data-depth"));if(b.hasOwnProperty("childDataProperty")&&d.hasOwnProperty(b.childDataProperty)){d=d[b.childDataProperty];h=f.attr("data-path")+this.options.pathSeparator;if(b.hasOwnProperty("bindings")){b=b.bindings}}else{return c}}else{d=this.options.dataSource.root().data();b=this.options.bindings;h=""}if(d){for(e=0;e<d.length;e++){if(d[e][b.textKey].toString()===j){if(b.hasOwnProperty("primaryKey")&&d[e].hasOwnProperty(b.primaryKey)){g=this.nodeByPath(h+d[e][b.primaryKey]);c.push(this.nodeFromElement(g));c=c.concat(this.findNodesByText(j,g))}else{g=this.nodeByPath(h+e);c.push(this.nodeFromElement(g));c=c.concat(this.findNodesByText(j,g))}}else{if(b.hasOwnProperty("primaryKey")&&d[e].hasOwnProperty(b.primaryKey)){g=this.nodeByPath(h+d[e][b.primaryKey]);c=c.concat(this.findNodesByText(j,g))}else{g=this.nodeByPath(h+e);c=c.concat(this.findNodesByText(j,g))}}}}return c},findImmediateNodesByText:function(j,f){var d,e,b,c=[],h,g;if(f&&f.length>0){b=this._retrieveCurrentDepthBinding(f.parent().attr("data-depth"));d=this.nodeDataFor(f.attr("data-path"));if(b.hasOwnProperty("childDataProperty")&&d.hasOwnProperty(b.childDataProperty)){d=d[b.childDataProperty];h=f.attr("data-path");if(b.hasOwnProperty("bindings")){b=b.bindings}}else{return c}for(e=0;e<d.length;e++){if(d[e][b.textKey].toString()===j){if(b.hasOwnProperty("primaryKey")&&d[e].hasOwnProperty(b.primaryKey)){g=this.nodeByPath(h+this.options.pathSeparator+d[e][b.primaryKey]);c.push(this.nodeFromElement(g))}else{g=this.nodeByPath(h+this.options.pathSeparator+e);c.push(this.nodeFromElement(g))}}}}else{b=this.options.bindings;d=this.options.dataSource.root().data();for(e=0;e<d.length;e++){if(d[e][b.textKey].toString()===j){if(b.hasOwnProperty("primaryKey")&&d[e].hasOwnProperty(b.primaryKey)){g=this.nodeByPath(d[e][b.primaryKey]);c.push(this.nodeFromElement(g))}else{g=this.nodeByPath(e);c.push(this.nodeFromElement(g))}}}}return c},nodeByIndex:function(b,d){var c;if(!d){if(this.element.is("ul")){c=this.element.children().eq(b)}else{c=this.element.children("ul").children().eq(b)}}else{c=d.children("ul").children().eq(b)}return c},nodeFromElement:function(b){if(b.length>0){var c={path:b.attr("data-path"),element:b,data:this.nodeDataFor(b.attr("data-path")),binding:this._retrieveCurrentDepthBinding(b.parent().attr("data-depth"))};return c}},children:function(d){var c=[],e=this,b,f;if(d&&d.length>0){f=d.children("ul");if(f.length>0){f.children("li").each(function(g){b=a(this);c.push(e.nodeFromElement(b))})}return c}throw new Error(a.ig.Tree.locale.incorrectNodeObject)},childrenByPath:function(e){var d=this.nodeByPath(e),c=[],f=this,b,g;if(d.length>0){g=d.children("ul");if(g.length>0){g.children("li").each(function(h){b=a(this);c.push(f.nodeFromElement(b))})}return c}throw new Error(a.ig.Tree.locale.incorrectPath+e)},isSelected:function(b){if(!this._selectedNode){this._selectedNode=[{path:null,element:null,data:null,binding:null}]}if(b&&b.length>0){return this._selectedNode[0].path===b.attr("data-path")}throw new Error(a.ig.Tree.locale.incorrectNodeObject)},isExpanded:function(c){if(c&&c.length>0){var b=c.children("span[data-role=expander]");if(b.length>0){return b.attr("data-exp")==="true"}}else{throw new Error(a.ig.Tree.locale.incorrectNodeObject)}},isChecked:function(c){if(c&&c.length>0){var b=c.children("span[data-role=checkbox]");if(b.length>0){return b.attr("data-chk")==="on"}}else{throw new Error(a.ig.Tree.locale.incorrectNodeObject)}},checkState:function(c){if(c&&c.length>0){var b=c.children("span[data-role=checkbox]");if(b.length>0){return b.attr("data-chk")}}else{throw new Error(a.ig.Tree.locale.incorrectNodeObject)}},_triggerSelectionChanging:function(c,d){var b={owner:this,selectedNodes:this._selectedNode,newNodes:[this._constructNodeObject(d)]};return this._trigger(this.events.selectionChanging,c,b)},_triggerSelectionChanged:function(c){var b={owner:this,selectedNodes:this._selectedNode,newNodes:this._selectedNode};this._trigger(this.events.selectionChanged,c,b)},_triggerNodeCollapsing:function(c,d){var b={owner:this,node:this._constructNodeObject(d)};return this._trigger(this.events.nodeCollapsing,c,b)},_triggerNodeCollapsed:function(c,d){var b={owner:this,node:this._constructNodeObject(d)};this._trigger(this.events.nodeCollapsed,c,b)},_triggerNodeExpanding:function(c,d){var b={owner:this,node:this._constructNodeObject(d)};return this._trigger(this.events.nodeExpanding,c,b)},_triggerNodeExpanded:function(c,d){var b={owner:this,node:this._constructNodeObject(d)};this._trigger(this.events.nodeExpanded,c,b)},_triggerNodePopulating:function(c,d){var b=this._constructNodeObject(d);return this._trigger(this.events.nodePopulating,c,b)},_triggerNodePopulated:function(c,d){var b=this._constructNodeObject(d);this._trigger(this.events.nodePopulated,c,b)},_triggerNodeCheckstateChanging:function(c,d){var e=d.children("span[data-role=checkbox]").attr("data-chk"),b={owner:this,node:this._constructNodeObject(d),currentState:e,newState:e==="off"?"on":"off",currentCheckedNodes:this.checkedNodes()};return this._trigger(this.events.nodeCheckstateChanging,c,b)},_triggerNodeCheckstateChanged:function(c,d){var e=d.children("span[data-role=checkbox]").attr("data-chk"),b={owner:this,node:this._constructNodeObject(d),newState:e,newCheckedNodes:this.checkedNodes(),newPartiallyCheckedNodes:this.partiallyCheckedNodes()};return this._trigger(this.events.nodeCheckstateChanged,c,b)},_triggerNodeClick:function(c,d){var b={owner:this,node:this._constructNodeObject(d)};return this._trigger(this.events.nodeClick,c,b)},_triggerNodeDoubleClick:function(c,d){var b=this._constructNodeObject(d);return this._trigger(this.events.nodeDoubleClick,c,b)},_triggerDataBinding:function(){var b={owner:this};this._trigger(this.events.dataBinding,null,b)},_triggerDataBound:function(c){var b={owner:this,dataView:c};this._trigger(this.events.dataBound,null,b)},_triggerRendering:function(c){var b={owner:this,dataView:c};this._trigger(this.events.rendering,null,b)},_triggerRendered:function(){var b={owner:this};this._trigger(this.events.rendered,null,b)},_constructNodeObject:function(b){var c=this.nodeDataFor(b!==null?b.attr("data-path"):null),d={path:b!==null?b.attr("data-path"):null,element:b!==null?b:null,data:c,binding:b!==null?this._retrieveCurrentDepthBinding(parseInt(b.parent().attr("data-depth"),10)):null};return d},nodeDataFor:function(f){if(!f){return}var g=f.split(this.options.pathSeparator),c=this.options.dataSource._rootds.data(),d,e,b=this.options.bindings;for(d=0;d<g.length-1;d++){if(!b.hasOwnProperty("primaryKey")){c=c[parseInt(g[d],10)][b.childDataProperty]}else{for(e=0;e<c.length;e++){if(c[e].hasOwnProperty(b.primaryKey)&&c[e][b.primaryKey].toString()===g[d].toString()){c=c[e][b.childDataProperty];break}}}if(b.hasOwnProperty("bindings")){b=b.bindings}}if(!b.hasOwnProperty("primaryKey")&&c.length){c=c[parseInt(g[g.length-1],10)]}else{for(e=0;e<c.length;e++){if(c[e].hasOwnProperty(b.primaryKey)&&c[e][b.primaryKey].toString()===g[d].toString()){c=c[e];break}}}return c},destroy:function(){a.Widget.prototype.destroy.apply(this,arguments);this.element.find("a").unbind();this.element.find("span").unbind();this.element.removeClass(this.css.tree);this.element.removeClass(this.css.treeCollection);this.element.removeClass(this.css.treeRoot);if(this.options.width){this.element.css("width","")}if(this.options.height){this.element.css("height","")}this.element.removeAttr("data-depth");this.element.empty();return this}});a.extend(a.ui.igTree,{version:"12.1.20121.1010"})}(jQuery));