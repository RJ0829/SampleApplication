/*
* Infragistics.Web.MobileUI Rating 12.1.20121.1010
*
* Copyright (c) 2011-2012 Infragistics Inc.
*
* http://www.infragistics.com/
*
* Depends on: 
*  jquery-1.6.4.js
*	jquery.ui.core.js
*/
(function(a){a.widget("mobile.igRating",a.mobile.widget,{options:{value:null,voteCount:5,voteWidth:0,voteHeight:0,readOnly:false,inputName:null},css:{normal:"ui-igrating ui-state-default ui-widget-content",selected:"ui-igrating-selected ui-state-highlight",vote:"ui-igrating-vote ui-icon ui-icon-star",voteSelected:"ui-igrating-voteselected",voteReadOnly:"ui-igrating-votereadonly",voteReadOnlySelected:"ui-igrating-votereadonlyselected"},events:{valueChange:null},_create:function(){var d,k,c,f,j={fontSize:"1px",width:"100%",height:"100%",position:"relative",overflow:"hidden"},i=this.options,g=this.element,h=this,e=this.css;d=this._count(i);k=g[0].style;h._old={width:k.width,height:k.height,html:g[0].innerHTML};h._swap=g.css("direction")==="rtl";f=h._elem=a("<div/>").css(j).addClass(e.normal).appendTo(g);c=a("<div/>").css(j).appendTo(f);h._doVotes(i,c);h._val=h._toNum(i.value);h._doVal(h._val);f.bind(h._evts={vmousedown:function(l){h._doEvt(l)}})},_toNum:function(c){if(!c){return 0}return(isNaN(c)||c<0)?0:c},_count:function(c){c=parseInt(c.voteCount,10);return isNaN(c)?5:Math.max(c,1)},_doVotes:function(r,d){var s,h,n,w,j,t,g,v=d,e=this._count(r),u={width:"100%",height:"100%"},c={left:"0px",top:"0px",position:"absolute",overflow:"hidden",border:"none",background:"none",whiteSpace:"nowrap"},p=-1,q=this,f=this.css,k=this._elem,l=this.element;if(!d){d=q._div.parent();q._div.remove();q._sel.remove();q._selSwap=null}j=q._div=a("<div/>").addClass(f.vote).css(c).appendTo(d);if(r.readOnly){j.addClass(f.voteReadOnly)}n=parseInt(r.voteHeight,10);w=parseInt(r.voteWidth,10);if(isNaN(n)||n<2){n=j.css("height");n=(!n||n.indexOf("px")<1)?16:parseInt(n,10)}if(isNaN(w)||w<2){w=j.css("width");w=(!w||w.indexOf("px")<1)?16:parseInt(w,10)}j.removeClass(f.vote).removeClass(f.voteReadOnly);s=q._sel=a("<div/>").addClass(f.selected).css(u).css(c).appendTo(d);if(q._swap){q._selSwap=s=a("<div/>").css(u).appendTo(q._sel)}h={display:"inline-block",width:w,height:n,textIndent:"0px",overflow:"visible"};while(++p<e){t=a("<span />").addClass(f.vote).css(h).appendTo(j);if(r.readOnly){t.addClass(f.voteReadOnly)}g=r.cssVotes?r.cssVotes[p]:null;if(g&&g[0]){t.addClass(g[0])}t[0]._i=p;t=a("<span />").addClass(f.vote).addClass(f.voteSelected).css(h).appendTo(s);if(r.readOnly){t.addClass(f.voteReadOnlySelected)}if(g&&g[1]){t.addClass(g[1])}t[0]._i=p;if(q._swap&&!q._selSwap){q._selSwap=t}}q._size=w;w*=e;k.css({height:n+"px",width:w+"px"});try{n+=((p=Math.max(k.outerHeight()-k.innerHeight(),0))>10)?2:p;w+=((p=Math.max(k.outerWidth()-k.innerWidth(),0))>10)?2:p}catch(m){}l.css({height:n+"px",width:w+"px"});j.css(u);if(!v){q.value(q.value())}},_doEvt:function(c){var f,d=this,e=this.options;if(e.readOnly||!d._sel){return}f=d._valFromEvt(c);if(f<0){return}d._doVal(f,c);c.preventDefault()},_setOption:function(d,f){var c,e=this.options;if(e[d]===f){return}c=this._count(e);e[d]=f;if(d.indexOf("vote")===0||d==="readOnly"){this._doVotes(e)}if(d.indexOf("value")>=0){this._doVal(f,d.length>6)}},_valFromEvt:function(d){var j,e,l,h,f,k=d?d.target:null,g=this.options,c=this._count(g);f=(k&&k.nodeName==="SPAN")?k._i:null;if(f===null||f===undefined){return -1}if(!k.unselectable){k.unselectable="on"}h=d.offsetX;if(h===null||h===undefined){h=d.layerX;if((h===null||h===undefined)&&d.originalEvent){h=d.originalEvent.offsetX}}if(d.originalEvent&&d.originalEvent.type.indexOf("touch")!==-1){if(h<=0){h+=d.clientX+0.05}if(this._swap){e=parseInt(k.parentNode.style.marginLeft.replace("px",""),10);if(isNaN(e)){e=0}h-=e}}else{j=this._size;e=-1*parseInt(k.parentNode.style.marginLeft.replace("px",""),10);if(isNaN(e)){e=0}if(this._swap){h+=e}j*=this._swap?c-f-1:f;e=-(k.offsetLeft);if(this._swap){h-=e}if(this._swap&&a.browser.mozilla&&e<j){h+=e}if(j>h&&!this._swap){h+=j}h+=0.05}l=this._swap?Math.floor(h/this._size):Math.ceil(h/this._size);if(this._swap){l=c-l}return Math.max(Math.min(l,c),0)},_doVal:function(k,d){var c,g=this.options,i=this._sel,h=this._size,j=this._swap?this._selSwap:null,e,f;if(i){i=i[0];if(i){i=i.style}}if(!i){return}c=this._count(g);if(isNaN(k)){k=-1}if(d&&d.type&&!this._trigger("valueChange",d,{value:k,oldValue:this._val})){return}this._val=g.value=k;e=g.inputName;if(e){f=a('input[name="'+e+'"]');if(f.length===0){f=a('<input type="hidden" name="'+e+'" />').appendTo(this.element.parent())}f.val(k)}if(j){k=c-k}k=g.readOnly?Math.round(k*2)/2:Math.round(k);k=Math.floor(k*h+0.3);k+="px";if(j){j=j[0];if(j){j=j.style}}if(j){i.left=k;j.marginLeft="-"+k}else{i.width=k}},value:function(c){if(typeof c!=="number"){return this._val}this._doVal(c,false);return this},destroy:function(){var d=this._old,c=this.element;if(!this._elem){return this}this._elem.remove();c[0].style.width=d.width;c[0].style.height=d.height;c[0].innerHTML=d.html;a.Widget.prototype.destroy.apply(this,arguments);this._elem=this._sel=this._selSwap=this._evts=null;return this}});function b(c){var d=document;if(c){d=c.target}a.each(a(d).find(":jqmData(role='igrating')"),function(e,f){a(f).igRating(a(f).jqmData())})}if(a.ig&&a.ig.loader){a.ig.loader().preinit(b)}a(document).bind("pagecreate create",b);a.extend(a.mobile.igRating,{version:"12.1.20121.1010"})}(jQuery));