/*
* Infragistics.Web.ClientUI ListView localization resources 12.1.20121.1010
*
* Copyright (c) 2011-2012 Infragistics Inc.
*
* http://www.infragistics.com/
*
*/
$.ig=$.ig||{};if(!$.ig.mobileListView){$.ig.mobileListView={};$.ig.mobileListViewFiltering={};$.ig.mobileListViewLoadOnDemand={};$.ig.mobileListViewSorting={};$.ig.mobileListView.locale={noSuchWidget:"No such widget loaded: ",optionChangeNotSupported:"Changing the following option after the igListView has been created is not supported:",emptyListText:"There are no list items!",goBackLabel:"Go back",detailsLabel:"Details",searchTrayExpandLabel:"Sort/Filter",searchTrayCollapseLabel:"Collapse"};$.ig.mobileListViewFiltering.locale={keywordSearchLabel:"",keywordAllStateText:"All Fields",filterPresetsLabel:"Filter Presets:",searchBarPlaceHolder:"Filter Items...",filterAllStateText:"All",showLabel:"Show ",cancelButtonLabel:"Cancel"};$.ig.mobileListViewLoadOnDemand.locale={loadMoreItemsLabel:"Load more items",noMoreItemsLabel:"No items left to load"};$.ig.mobileListViewSorting.locale={sortPresetsLabel:"Sort Presets:",sortDefaultStateText:"Default",sortByLabel:"Sort by "};
/*
 * Infragistics.Web.MobileUI ListView 12.1.20121.1010
 *
 * Copyright (c) 2011-2012 Infragistics Inc.
 *
 * http://www.infragistics.com/
 *
 * Depends on: 
 *  jquery-1.6.4.js
 *	jquery.ui.core.js
 *	ig.dataSource.js
 *  ig.ui.shared.js
 *	ig.util.js
 */
}(function($){var _originalBindings=null;$.widget("mobile.igList",$.mobile.widget,{css:{igList:"ig-listview",baseList:"ui-listview",insetList:"ui-listview-inset ui-corner-all ui-shadow",searchArea:"ui-listview-filter ui-bar-{0}",searchTray:"ui-iglist-tray",searchTrayCollapsed:"ui-iglist-tray-collapsed",insetSearchArea:"ui-listview-filter-inset",insetSearchTray:"ui-listview-filter-inset",searchTrayFooter:"ui-iglist-tray-footer ui-bar-{0}",searchTrayFooterCollapsed:"ui-iglist-tray-footer-collapsed",searchTrayCollapse:"ui-iglist-tray-collapse ui-bar-{0}",searchTrayCollapseOpen:"ui-iglist-tray-collapse-open",searchTrayFooterBtnHolder:"ui-btn-text",searchTrayExpandText:"ui-iglist-tray-footer-empty",searchTrayExpandIcon:"ui-icon ui-icon-arrow-d ui-iglist-tray-footer-empty-icon",searchTrayCollapseIcon:"ui-icon ui-icon-arrow-u",searchTrayFooterBtnOpen:"tray-btn-open ui-icon-arrow-u",insetSearchTrayFooter:"ui-iglist-tray-footer-inset",baseListItem:"ui-li ui-btn ui-btn-up-{0}",readOnlyListItem:"ui-li ui-li-static ui-body-{0}",count:"ui-li-count ui-btn-up-{0} ui-btn-corner-all",liIconRight:"ui-btn-icon-right ui-li-has-arrow",liHasCount:"ui-li-has-count",liHasThumb:"ui-li-has-thumb",liHasIcon:"ui-li-has-icon",imageIcon:"ui-li-icon ui-li-thumb",imageThumb:"ui-li-thumb",detailsTemplate:"ui-iglist-details",listDivider:"ui-li ui-li-divider ui-btn ui-bar-{0} ui-li-has-count"},options:{inset:false,numberedList:false,dataSource:null,dataSourceUrl:null,dataSourceType:null,responseDataKey:null,responseTotalRecCountKey:null,localSchemaTransform:true,itemTemplate:null,itemDetailsTemplate:null,imageMode:"thumbnail",showCount:true,itemHeaderSize:"h2",bindings:{textKey:"Text",textXPath:"@Text",imageUrlKey:"ImageUrl",imageUrlXPath:"@ImageUrl",navigateUrlKey:"NavigateUrl",navigateUrlXPath:"@NavigateUrl",countKey:"Count",countXPath:"@Count",headerKey:"Header",headerXPath:"@Header",descriptionKey:"Description",descriptionXPath:"@Description",primaryKey:null,isDividerKey:"IsDivider",detailsTitleKey:"Title",detailsTitleXPath:"@Title",customBindings:[]},searchTheme:"c",searchFooterTheme:"d",countTheme:"c",subPageHeaderTheme:"b",listDividerTheme:"b",itemTheme:null,searchTrayExpandLabel:null,features:[{}]},events:{dataBinding:"dataBinding",dataBound:"dataBound",dataRendering:"dataRendering",dataRendered:"dataRendered",renderingTray:"renderingTray",renderedTray:"renderedTray",renderingTrayFooterBar:"renderingTrayFooterBar",renderedTrayFooterBar:"renderedTrayFooterBar",footerRendering:"footerRendering",footerRendered:"footerRendered",itemsRendering:"itemsRendering",itemsRendered:"itemsRendered",subPageCreating:"subPageCreating",subPageCreated:"subPageCreated",schemaGenerated:"schemaGenerated",requestError:"requestError"},_setOption:function(key,value){$.Widget.prototype._setOption.apply(this,arguments);if(key==="dataSource"){this.options.dataSource=value;this.dataBind()}},_createWidget:function(){this.options.bindings=null;$.Widget.prototype._createWidget.apply(this,arguments)},_create:function(){var self=this,opts=this.options;if(!opts.itemTheme){opts.itemTheme=$.mobile.getInheritedTheme(this.element,"c")}this._firstBind=true;this._updateCss();self.dataBind()},container:function(){var parent=this.element.parent();if(parent&&parent.length>0&&parent[0].id===this.element[0].id+"_container"){return parent}return $("#"+this.element[0].id+"_container")},_locale:function(key){var val=this.options[key];if(val===undefined||val===null){val=$.ig.mobileListView&&$.ig.mobileListView.locale?$.ig.mobileListView.locale[key]:null}return val||""},_updateCss:function(){var css=this.css,opts=this.options;css.baseListItem=css.baseListItem.replace("{0}",opts.itemTheme);css.readOnlyListItem=css.readOnlyListItem.replace("{0}",opts.itemTheme);css.count=css.count.replace("{0}",opts.countTheme);css.searchArea=css.searchArea.replace("{0}",opts.searchTheme);css.searchTray=css.searchTray.replace("{0}",opts.searchTheme);css.searchTrayFooter=css.searchTrayFooter.replace("{0}",opts.searchFooterTheme);css.searchTrayCollapse=css.searchTrayCollapse.replace("{0}",opts.searchFooterTheme);css.listDivider=css.listDivider.replace("{0}",opts.listDividerTheme)},_itemFromTarget:function(target,tagName,attribute){while(target){if(target.tagName&&target.tagName.toLowerCase()===tagName&&target.hasAttribute(attribute)){break}target=target.parentNode}return target},toggleSearchArea:function(){this.container().find("."+this.css.searchTrayFooter.split(" ")[0]).trigger("click");return this},dataBind:function(){var dataOptions,i,noCancel=true,listString,hList;noCancel=this._trigger(this.events.dataBinding,null,{owner:this});if(noCancel){dataOptions=this._generateDataSourceOptions(this.options);this._setupDataSource(dataOptions);this._dataOptions=dataOptions;if(!this._initialized){this._onChangePageHandler=$.proxy(this._onChangePage,this);$(document).bind("pagechange",this._onChangePageHandler);if(this.element.is("div")){this._isWrapped=true;hList=this.options._hParent;if((hList&&hList.options.dataSource&&hList.options.dataSource.tagName&&(hList.options.dataSource.tagName.toLowerCase()==="ul"||hList.options.dataSource.tagName.toLowerCase()==="ol"))||(dataOptions.dataSource&&dataOptions.dataSource.tagName&&(dataOptions.dataSource.tagName.toLowerCase()==="ul"||dataOptions.dataSource.tagName.toLowerCase()==="ol"))){this.listElement=hList?$(hList.options.dataSource):$(dataOptions.dataSource);this.listElement.siblings().remove()}else{if(this.options.numberedList){listString="<ol></ol>"}else{listString="<ul></ul>"}this.element.empty();this.listElement=$(listString).appendTo(this.element).attr("id",this.element[0].id+"_list")}}else{this.listElement=this.element}this.element.data("igFlatList",this);for(i=0;i<this.options.features.length;i++){this._initFeature(this.options.features[i],dataOptions)}this._renderList()}$.mobile.showPageLoadingMsg();this._dataBinding=true;this._requireRecordsClear=true;this.dataSource.dataBind()}},_onChangePage:function(evt,args){if(this._dataBinding){$.mobile.showPageLoadingMsg()}$(document).unbind("pagechange",this._onChangePageHandler);delete this._onChangePageHandler},_renderList:function(){var self=this,css=this.css,opts=this.options,listClass=css.baseList,searchClass,trayFooter,containerId,containerDiv,form=$("<form></form>"),args,noCancel;containerId=this.element[0].id+"_container";containerDiv='<div id="'+containerId+'"> </div>';this.element.wrap(containerDiv).addClass(css.igList);searchClass=css.searchArea;trayFooter=css.searchTrayFooter;if(opts.inset){listClass+=" "+css.insetList;searchClass+=" "+css.insetSearchArea}this.listElement.addClass(listClass);if(opts.itemDetailsTemplate!==null&&opts.itemDetailsTemplate.length>0){this.listElement.bind("click",function(evnt){self._listTap(evnt)})}args={owner:this,tray:null,needTray:0,css:this.css.searchTray};noCancel=this._trigger(this.events.renderingTray,null,args);if(noCancel&&args.needTray){form.addClass(searchClass).append(args.tray).bind({submit:function(){return false}});this._trigger(this.events.renderedTray,null,args);if(args.needTray>1){args.tray.addClass(css.searchTray).addClass(args.css).addClass(css.searchTrayCollapsed);args={owner:this,trayFooter:$("<div>").addClass(css.searchTrayFooter).addClass(css.searchTrayFooterCollapsed)};if(this.options.inset){args.trayFooter.addClass(css.insetSearchTrayFooter)}noCancel=this._trigger(this.events.renderingTrayFooterBar,null,args);if(noCancel){args.trayFooter.append("<span data-trayRole='empty'	class='"+css.searchTrayExpandText+"'>"+this._locale("searchTrayExpandLabel")+"</span><span class='"+css.searchTrayExpandIcon+"'></span>");if(args.trayFooter.find('[data-trayRole="keyword"]').text()){args.trayFooter.find('[data-trayRole="empty"]').hide().next().hide()}form=form.append(args.trayFooter).append($("<div>").addClass(css.searchTrayCollapse).html(this._locale("searchTrayCollapseLabel")+"<span class='"+css.searchTrayCollapseIcon+"'></span>")).wrap("<div>").parent();this._trigger(this.events.renderedTrayFooterBar,null,{owner:this});this._clickFooter=function(event,args){var footer=self.container().find(".ui-iglist-tray-footer");footer.toggleClass(css.searchTrayFooterCollapsed).next().toggleClass(css.searchTrayCollapseOpen).end().prev().toggleClass(css.searchTrayCollapsed)};args.trayFooter.bind("click",this._clickFooter);args.trayFooter.next().bind("click",this._clickFooter);form.children().insertBefore(this.listElement)}}else{form.insertBefore(this.listElement)}this.listElement.parent().find("form").find("li:visible").each(function(){var $this=$(this);$this.width($this.outerWidth())})}args={owner:this,footerContents:$("<div>")};noCancel=this._trigger(this.events.footerRendering,null,args);if(noCancel){args.footerContents.children().insertAfter(this.element);this._trigger(this.events.footerRendered,null,{owner:this})}if(this.dataSource.type()!=="htmlListDom"){this.listElement.empty()}},_initFeature:function(featureObject,dataOptions,destroy){if(!featureObject){return}if(featureObject.name===undefined){return}var widget="igListView"+featureObject.name;if($.type($("#"+this.element[0].id)[widget])!=="function"){throw new Error(this._locale("noSuchWidget")+" "+widget)}if(this.element.data(widget)!==undefined){this.element[widget]("destroy")}this.element[widget](featureObject);this.element.data(widget)._injectList(this)},_generateDataSourceOptions:function(options){var schema,dataOptions;if(!this.options.dataSource&&!this.options.dataSourceUrl&&(this.element.is("ul")||this.element.is("ol"))&&this.element.children().length>0){this.options.dataSource=this.element[0]}dataOptions={callback:$.proxy(this._onDataBound,this),callee:this,responseDataKey:this.options.responseDataKey,localSchemaTransform:this.options.localSchemaTransform,dataSource:this.options.dataSource};if(this.options.dataSourceType!==null){dataOptions.type=this.options.dataSourceType}schema=this._generateDataSourceSchema();if(this.options.bindings&&this.options.bindings.primaryKey){dataOptions.primaryKey=this.options.bindings.primaryKey}if((this.options.dataSource instanceof $.ig.DataSource&&(this.options.dataSource.settings.schema===null||(this.options.dataSource.settings.schema.fields&&this.options.dataSource.settings.schema.fields.length>=0)||!this.options.dataSource.settings.schema.fields))||!(this.options.dataSource instanceof $.ig.DataSource)){dataOptions=$.extend(dataOptions,{schema:schema})}return dataOptions},_generateDataSourceSchema:function(){var schema={},ds=this.options.dataSource,opt=this.options,bindings=opt.bindings,x;schema.fields=[];schema.searchField=this.options.responseDataKey;if(bindings===null){return this._generateBindings(ds)}if(opt.dataSourceType==="xml"){schema.fields=[];if(bindings.textKey){schema.fields.push({name:bindings.textKey,xpath:bindings.textXPath});schema.textKey=bindings.textKey}if(bindings.navigateUrlKey){schema.fields.push({name:bindings.navigateUrlKey,xpath:bindings.navigateUrlXPath});schema.navigateUrlKey=bindings.navigateUrlKey}if(bindings.imageUrlKey){schema.fields.push({name:bindings.imageUrlKey,xpath:bindings.imageUrlXPath});schema.imageUrlKey=bindings.imageUrlKey}if(bindings.countKey){schema.fields.push({name:bindings.countKey,xpath:bindings.countXPath});schema.countXPath=bindings.countKey}if(bindings.headerKey){schema.fields.push({name:bindings.headerKey,xpath:bindings.headerXPath});schema.headerXPath=bindings.headerKey}if(bindings.descriptionKey){schema.fields.push({name:bindings.descriptionKey,xpath:bindings.descriptionXPath});schema.descriptionXPath=bindings.descriptionKey}if(bindings.detailsTitleKey){schema.fields.push({name:bindings.detailsTitleKey,xpath:bindings.detailsTitleXPath});schema.detailsTitleXPath=bindings.detailsTitleKey}if(bindings.searchFieldXPath){schema.searchField=bindings.searchFieldXPath}if(this.options.childLayout){schema.fields.push({name:this.options.childLayout.key,xpath:this.options.childLayout.key});schema.childDataProperty=this.options.childLayout.key}return schema}schema.fields=[];if(bindings.primaryKey){schema.fields.push({name:bindings.primaryKey,type:"string"});schema.primaryKeyKey=bindings.primaryKey}if(bindings.textKey){schema.fields.push({name:bindings.textKey,type:"string"});schema.textKey=bindings.textKey}if(bindings.navigateUrlKey){schema.fields.push({name:bindings.navigateUrlKey,type:"string"});schema.navigateUrlKey=bindings.navigateUrlKey}if(bindings.imageUrlKey){schema.fields.push({name:bindings.imageUrlKey,type:"string"});schema.imageUrlKey=bindings.imageUrlKey}if(bindings.countKey){schema.fields.push({name:bindings.countKey,type:"number"});schema.countKey=bindings.countKey}if(bindings.headerKey){schema.fields.push({name:bindings.headerKey,type:"string"});schema.headerKey=bindings.headerKey}if(bindings.descriptionKey){schema.fields.push({name:bindings.descriptionKey,type:"string"});schema.descriptionKey=bindings.descriptionKey}if(bindings.detailsTitleKey){schema.fields.push({name:bindings.detailsTitleKey,type:"string"});schema.detailsTitleKey=bindings.detailsTitleKey}if(bindings.isDividerKey){schema.fields.push({name:bindings.isDividerKey,type:"bool"});schema.isDividerKey=bindings.isDividerKey}if(bindings.customBindings&&bindings.customBindings.length>0){for(x=0;x<bindings.customBindings.length;++x){schema.fields.push({name:bindings.customBindings[x].fieldName,type:bindings.customBindings[x].dataType});schema[bindings.customBindings[x].fieldName+"Key"]=bindings.customBindings[x].fieldName}}opt.schema=schema;opt.schema.searchField=opt.responseDataKey;if(this.options.childLayout){schema.fields.push({name:this.options.childLayout.childrenDataProperty===undefined?this.options.childLayout.key:this.options.childLayout.childrenDataProperty})}this._trigger(this.events.schemaGenerated,null,{owner:this,schema:schema,dataSource:ds});return schema},_generateBindings:function(ds,addAll){var opt=this.options,schema,x,rec,prop,name,camelCase,bindingName,fieldType,guess,allFields=["Text","NavigateUrl","ImageUrl","Count","Description","Header","DetailsTitle","IsDivider"];if((opt.bindings===null||opt.bindings===undefined)&&ds&&ds.length&&ds.length>0&&$.type(ds)==="array"){opt.bindings={};schema={};schema.fields=[];schema.searchField=this.options.responseDataKey;for(x=0;x<ds.length;++x){rec=ds[x];for(prop in rec){if(rec.hasOwnProperty(prop)){guess=this._guessBindingName(rec,prop);if(guess&&!this._fieldExists(prop,schema)&&allFields.indexOf(guess)>-1){camelCase=this._toCamelCase(guess);bindingName=this._getBindingName(guess);fieldType=this._calcFieldType(guess);schema.fields.push({name:prop,type:fieldType});schema[bindingName]={name:prop,type:fieldType};schema[camelCase]={name:prop,type:fieldType};opt.bindings[bindingName]=prop;allFields.removeAt(allFields.indexOf(guess))}}}}if(addAll){for(x=0;x<allFields.length;++x){name=allFields[x];if(!this._fieldExists(name,schema)){camelCase=this._toCamelCase(name);bindingName=this._getBindingName(name);fieldType=this._calcFieldType(name);schema.fields.push({name:name,type:fieldType});schema[bindingName]={name:name,type:fieldType};opt.bindings[bindingName]=name}}}this._trigger(this.events.schemaGenerated,null,{owner:this,schema:schema,dataSource:ds})}return schema},_toCamelCase:function(val){return val.substr(0,1).toLowerCase()+val.substr(1,val.length-1)},_calcFieldType:function(name){if(name==="Count"){return"number"}if(name==="IsDivider"){return"bool"}return"string"},_getBindingName:function(name){name=this._toCamelCase(name);if(name.indexOf("Key")!==-1){return name}return name+"Key"},_guessBindingName:function(rec,prop){var val=rec[prop];if(prop==="Text"){return"Text"}if(prop==="NavigateUrl"){return"NavigateUrl"}if(prop==="ImageUrl"){return"ImageUrl"}if(prop==="Count"){return"Count"}if(prop==="Description"){return"Description"}if(prop==="Header"){return"Header"}if(prop==="DetailsTitle"){return"DetailsTitle"}if(prop==="IsDivider"){return"IsDivider"}if(prop==="PrimaryKey"){return"PrimaryKey"}if($.type(val)==="string"){if(val.indexOf(".gif")>-1||val.indexOf(".png")>-1||val.indexOf(".jpg")>-1){return"ImageUrl"}if(val.indexOf("http://")===0||val.indexOf(".htm")>-1||val.indexOf(".aspx")>-1){return"NavigateUrl"}return"Text"}if($.type(val)==="number"){return"Count"}if($.type(val)==="boolean"){return"IsDivider"}return null},_fieldExists:function(prop,schema){var i;for(i=0;i<schema.fields.length;i++){if(schema.fields[i].name===prop){return true}}return false},_onDataBound:function(success,errmsg){var listElement=this.element,noCancel=true,isUlOl=false,noCancelError=true;if(success===false){noCancelError=this._trigger(this.events.requestError,null,{owner:this,message:errmsg});if(noCancelError){throw new Error(errmsg)}}this._trigger(this.events.dataBound,null,{owner:this});noCancel=this._trigger(this.events.dataRendering,null,{owner:this,listElement:listElement});if(noCancel){if(this._requireRecordsClear&&!(this.options.dataSource&&this.options.dataSource.tagName&&($(this.options.dataSource).is("ul")||$(this.options.dataSource).is("0l")))){listElement=this._cleanupList()}else{isUlOl=true}delete this._requireRecordsClear;if(!this._initialized){if(!this.options.bindings){this.options.schema=this._generateBindings(this.dataSource.dataView(),this.dataSource.type()!=="remoteUrl")}if(isUlOl){listElement.empty()}}delete this._dataBinding;this._renderData();this.dataSource.settings.paging.appendPage=true;$.mobile.hidePageLoadingMsg();this._trigger(this.events.dataRendered,null,{owner:this})}if(this.options.dataSourceUrl!==null&&this._firstBind){this.options.dataSource=this.options.dataSourceUrl;this.dataSource.settings.dataSource=this.options.dataSourceUrl;this.dataSource.settings.type="remoteUrl";this.dataSource._runtimeType=this.dataSource.analyzeDataSource();this._firstBind=false}if(!this._initialized){this._initialized=true}},_cleanupList:function(){var list=this.listElement;if($.mobile.igListView&&$.mobile.igListView.speedupDOMCleanup===false){list.empty()}else{if(list.children().length>0){this.listElement[0].innerHTML=""}}return list},_renderData:function(){var self=this,i=0,hasSubPages=false,listElement=this.listElement,noCancel=false,ds=this.dataSource.dataView(),dsCount=ds?ds.length:0,items="",opts=this.options,bindings=this.options.bindings,css=this.css,dns="data-"+$.mobile.ns,args,val,liAtts,hasSubPage,liClass,hyperLink,wrapperDivStart,wrapperDivEnd,arrow,isEmpty=true;if(this._requireRecordsClear){listElement=this._cleanupList();delete this._requireRecordsClear}args={owner:this,items:items,index:i,listElement:listElement,dataView:ds};noCancel=this._trigger(this.events.itemsRendering,null,args);if(noCancel){items=args.items;if(bindings&&(bindings.primaryKey===null||bindings.primaryKey===undefined)){bindings.primaryKey="ig_pk"}if(self.options.itemTemplate){for(i=args.index;i<dsCount;++i){val=ds[i];liAtts=dns+"idx='"+i+"'";isEmpty=false;if(bindings.primaryKey!=="ig_pk"){liAtts+=" "+dns+"id='"+val[bindings.primaryKey]+"'"}else{liAtts+=" "+dns+"id='"+this._getVal(val)+"'"}hasSubPage=this._hasSubPage(val);hasSubPages=hasSubPages||hasSubPage;if(hasSubPage){liAtts+=' subPage="false"'}items+="<li ' class='"+css.baseListItem+"' "+liAtts+">"+$.ig.tmpl(self.options.itemTemplate,val,{})+"</li>";args={owner:this,items:items,index:i,listElement:listElement,dataView:ds,value:val};this._trigger("_itemRendered",null,args);items=args.items;items=items.replace("{EXTRACSS}","")}}else{for(i=args.index;i<dsCount;++i){val=ds[i];liClass=css.baseListItem;isEmpty=false;if(val[bindings.isDividerKey]===true){hyperLink="{TEXT}{COUNT}";liAtts="";wrapperDivStart="";wrapperDivEnd="";arrow="";liClass=css.listDivider;if(i===dsCount-1||ds[i+1][bindings.isDividerKey]===true){continue}if(val[bindings.textKey]!==null&&val[bindings.textKey]!==undefined){hyperLink=hyperLink.replace("{TEXT}",val[bindings.textKey])}else{hyperLink=hyperLink.replace("{TEXT}","")}if(val[bindings.countKey]!==null&&val[bindings.countKey]!==undefined){liClass+=" "+css.liHasCount;hyperLink=hyperLink.replace("{COUNT}","<span class='"+css.count+"'>"+val[bindings.countKey]+"</span>")}else{hyperLink=hyperLink.replace("{COUNT}","")}}else{hyperLink="<div class='ui-btn-text'><a {HREF} class='ui-link-inherit ui-link'>{IMG}{HEAD}{DESC}{TEXT}{COUNT}</a></div>";liAtts=dns+"idx='"+i+"'";hasSubPage=this._hasSubPage(val);hasSubPages=hasSubPages||hasSubPage;if(bindings.primaryKey!=="ig_pk"){liAtts+=" "+dns+"id='"+val[bindings.primaryKey]+"'"}else{liAtts+=" "+dns+"id='"+this._getVal(val)+"'"}if(val[bindings.navigateUrlKey]||hasSubPage){liClass+=" "+css.liIconRight;if(hasSubPage){liAtts+=' subPage="false"';hyperLink=hyperLink.replace("{HREF} ","")}else{hyperLink=hyperLink.replace("{HREF} ","href='"+val[bindings.navigateUrlKey]+"'")}arrow="<span class='ui-icon ui-icon-arrow-r ui-icon-shadow'></span>";wrapperDivStart="<div class='ui-li ui-btn-inner'>";wrapperDivEnd="</div>"}else{liClass=css.readOnlyListItem;hyperLink="{IMG}{HEAD}{DESC}{TEXT}{COUNT}";arrow="";wrapperDivStart="";wrapperDivEnd=""}if(bindings.descriptionKey&&val[bindings.descriptionKey]!==null&&val[bindings.descriptionKey]!==undefined){hyperLink=hyperLink.replace("{DESC}","<p class='ui-li-desc'>"+val[bindings.descriptionKey]+"</p>")}else{hyperLink=hyperLink.replace("{DESC}","")}if(opts.itemHeaderSize!=="none"&&val[bindings.headerKey]!==null&&val[bindings.headerKey]!==undefined){hyperLink=hyperLink.replace("{HEAD}","<"+opts.itemHeaderSize+" class='ui-li-heading'>"+val[bindings.headerKey]+"</"+opts.itemHeaderSize+">")}else{hyperLink=hyperLink.replace("{HEAD}","")}if(val[bindings.textKey]!==null&&val[bindings.textKey]!==undefined){hyperLink=hyperLink.replace("{TEXT}",val[bindings.textKey])}else{hyperLink=hyperLink.replace("{TEXT}","")}if(opts.showCount&&val[bindings.countKey]!==null&&val[bindings.countKey]!==undefined){liClass+=" "+css.liHasCount;hyperLink=hyperLink.replace("{COUNT}","<span class='"+css.count+"'>"+val[bindings.countKey]+"</span>")}else{hyperLink=hyperLink.replace("{COUNT}","")}if(opts.imageMode!=="none"&&bindings.imageUrlKey){if(val[bindings.imageUrlKey]!==undefined&&val[bindings.imageUrlKey]!==null&&val[bindings.imageUrlKey].length>0){if(opts.imageMode==="thumbnail"){liClass+=" "+css.liHasThumb;hyperLink=hyperLink.replace("{IMG}","<img src='"+val[bindings.imageUrlKey]+"' class='"+css.imageThumb+"' />")}else{liClass+=" "+css.liHasIcon;hyperLink=hyperLink.replace("{IMG}","<img src='"+val[bindings.imageUrlKey]+"' class='"+css.imageIcon+"' />")}}else{if(opts.imageMode==="thumbnail"){liClass+=" "+css.liHasThumb;hyperLink=hyperLink.replace("{IMG}","<div class='"+css.imageThumb+"'/>")}else{liClass+=" "+css.liHasIcon;hyperLink=hyperLink.replace("{IMG}","<div class='"+css.imageIcon+"'/>")}}}else{hyperLink=hyperLink.replace("{IMG}","")}}items+="<li class='"+liClass+"{EXTRACSS}'"+liAtts+">"+wrapperDivStart+hyperLink+arrow+wrapperDivEnd+"</li>";args={owner:this,items:items,index:i,listElement:listElement,dataView:ds,value:val};this._trigger("_itemRendered",null,args);items=args.items;items=items.replace("{EXTRACSS}","")}}if(items.length===0&&isEmpty){items="<li class='ui-li ui-li-static ui-body-c'>"+this._locale("emptyListText")+"</li>"}if(this._loadOnDemand){listElement.append(items)}else{listElement.html(items)}if(opts.inset){listElement.children().first().addClass("ui-corner-top").find(".ui-btn-inner").not(".ui-li-link-alt span:first-child").addClass("ui-corner-top").end().end().find(".ui-li-thumb").not(".ui-li-icon").addClass("ui-corner-tl").end().end().end().last().addClass("ui-corner-bottom").find(".ui-btn-inner").not(".ui-li-link-alt span:first-child").addClass("ui-corner-bottom").end().end().find(".ui-li-thumb").not(".ui-li-icon").addClass("ui-corner-bl")}this._trigger(this.events.itemsRendered,null,{owner:this,hasSubPages:hasSubPages})}},_hasSubPage:function(){return this.options.itemDetailsTemplate!==undefined&&this.options.itemDetailsTemplate!==null&&this.options.itemDetailsTemplate.length>0},_listTap:function(evnt){var li=evnt.target,$li,index,flatDataSource=this.dataSource.dataView(),dataItem,newPage;while(li&&(li.tagName!=="LI"||li.className.indexOf("ui-li-divider")!==-1)){li=li.parentNode}if(li===null){return}$li=$(li);index=parseInt($li.jqmData("idx"),10);dataItem=flatDataSource[index];if(li.getAttribute("subPage")==="false"){newPage=this._createSubPage(dataItem,$li,index);if(newPage){$.mobile.changePage(newPage,{transition:"slide"});if($li.find("a").length===0){$li.attr("subPage","noLink").data("newPage",newPage)}else{$li.attr("subPage","true").find("a").first().attr("href",newPage.jqmData("url"))}}}else{if(li&&(li.getAttribute("subPage")==="noLink")){$.mobile.changePage($(li).data("newPage"),{transition:"slide"})}}},_createSubPageContent:function(dataItem,listItem){var items=$(null);if(this.options.itemDetailsTemplate){items[0]=$("<div class='"+this.css.detailsTemplate+"'></div>").append($.ig.tmpl(this.options.itemDetailsTemplate,dataItem,{}))[0];items.length=1}return items},_createSubPage:function(dataItem,listItem,index){var parentPage=this.element.closest(".ui-page"),parentUrl=parentPage.jqmData("url"),parentListId=$(this.element).attr("id"),dns="data-"+$.mobile.ns,persistentFooterID=parentPage.find(":jqmData(role='footer')").jqmData("id"),title=this._locale("detailsLabel"),subItems,id=(parentUrl||"")+"&"+$.mobile.subPageUrlKey+"="+parentListId+"-"+this.options.bindings.primaryKey+"/"+dataItem[this.options.bindings.primaryKey],newPage,opts=this.options,backBtn,args,noCancel;if((newPage=$(":jqmData(url='"+id+"')")).length>0){return newPage}if(this.options.bindings&&this.options.bindings.detailsTitleKey&&dataItem[this.options.bindings.detailsTitleKey]){title=dataItem[this.options.bindings.detailsTitleKey]}newPage=null;args={owner:this,subPageTitle:title,extraContents:$("<div>")};noCancel=this._trigger(this.events.subPageCreating,null,args);if(noCancel){title=args.subPageTitle;subItems=this._createSubPageContent(dataItem,listItem);backBtn=$("<a>").css("zIndex",1).text(this._locale("goBackLabel")).bind("click",function(){window.history.back()}).buttonMarkup({inline:true,theme:opts.subPageHeaderTheme});newPage=$("<div "+dns+"role='content'></div>").wrap("<div "+dns+"role='page' "+dns+"url='"+id+"' "+dns+"theme='"+opts.itemTheme+"' "+dns+"count-theme='"+opts.countTheme+"'></div>").append(subItems).append(args.extraContents.children()).before($("<div "+dns+"role='header' "+dns+"theme='"+opts.subPageHeaderTheme+"'><div class='ui-title'>"+title+"</div></div>").prepend(backBtn)).after(persistentFooterID?$("<div "+dns+"role='footer' "+dns+"id='"+persistentFooterID+"'>"):"").parent().appendTo($.mobile.pageContainer);newPage.page();args={owner:this,subPage:newPage};this._trigger(this.events.subPageCreated,null,args)}return newPage},_setupDataSource:function(dataOptions){if(!(this.options.dataSource instanceof $.ig.DataSource)){if($.type(dataOptions.dataSource)==="string"&&dataOptions.dataSource.indexOf("$callback=?")!==-1){this.dataSource=new $.ig.JSONPDataSource(dataOptions)}else{this.dataSource=new $.ig.DataSource(dataOptions)}}else{this.dataSource=this.options.dataSource;if(this.dataSource.settings.responseDataKey!==null){delete dataOptions.responseDataKey;if(dataOptions.schema){dataOptions.schema.searchField=this.dataSource.settings.responseDataKey}}this._tds=this.dataSource.settings.dataSource;this.dataSource.settings.dataSource=null;this.dataSource.settings=$.extend(true,{},this.dataSource.settings,dataOptions);this.dataSource.settings.dataSource=this._tds;this._tds=null;if(dataOptions.schema){this.dataSource._initSchema()}}},_getVal:function(data){var val;if(data.ig_pk){val=data.ig_pk}else{val=$.ig.uid();data.ig_pk=val}return val},_inferOpType:function(){if(this.options.dataSourceUrl||this.dataSource.type()==="remoteUrl"){return"remote"}return"local"},destroy:function(){var prev=this.container().prev(),i;for(i=0;i<this.options.features.length;i++){if(this.options.features[i].name&&this.element.data("igListView"+this.options.features[i].name)){$("#"+this.element[0].id)["igListView"+this.options.features[i].name]("destroy")}}if(prev.length===0){prev=this.container().parent()}this.listElement.empty();prev.append(this.element);this.element.attr("data-level",null).removeClass(this.css.igList+" "+this.css.baseList+" "+this.css.insetList);$.Widget.prototype.destroy.call(this);this.container().remove();this.element.removeData("igFlatList")}});if(typeof define==="function"&&define.amd&&define.amd.jQuery){define("ig.mobileui.flatlist",["ig.util","ig.datasource"],function(){return $.mobile.igList})}$.widget("mobile.igListView",$.mobile.widget,{css:{},options:{initialDataBindDepth:-1,odata:false,defaultChildrenDataProperty:"Children",pathSeparator:"/",autoGenerateLayouts:false,childLayout:{key:null},initSelector:":jqmData(role='iglistview')"},events:{childrenPopulating:"childrenPopulating",childrenPopulated:"childrenPopulated"},_create:function(){var tmpSource;this._regevents(this.element,this);this.options=$.extend(true,{},$.mobile.igList.prototype.options,this.options);if(this.options._fromHtml&&this.options.dataSource){try{tmpSource=this.options.dataSource;this.options.dataSource=eval(this.options.dataSource)}catch(exc){this.options.dataSource=tmpSource}if(this.options.dataSource===undefined&&tmpSource){this.options.dataSource=tmpSource}}if(this.tmpDataSource!==null&&this.tmpDataSource!==undefined){this.options.dataSource=this.tmpDataSource;this._originalOptions.dataSource=this.tmpDataSource}$("<div>").buttonMarkup();this.dataBind()},_createWidget:function(options,element){this.options.features=[];this.options.childLayout=null;if($.mobile.igList.prototype.options.bindings!==null&&$.mobile.igList.prototype.options.bindings!==undefined){_originalBindings=$.mobile.igList.prototype.options.bindings}$.mobile.igList.prototype.options.bindings=null;if(options&&options.dataSource&&($.type(options.dataSource)==="array"||$.type(options.dataSource)==="object")){this.tmpDataSource=options.dataSource;options.dataSource=null;this._originalOptions=options}$.Widget.prototype._createWidget.apply(this,arguments)},dataBind:function(){var hds,hdsoptions,rootds,opts;if(this.options.autoGenerateLayouts){this._generateLayouts()}hdsoptions=this._hdsoptions();hds=new $.ig.HierarchicalDataSource(hdsoptions);this._hds=hds;rootds=this._hds.root();this._tmpds=this.options.dataSource;this.options.dataSource=null;opts=$.extend(true,{},this.options);this.options.dataSource=this._tmpds;this._tmpds=null;opts.dataSource=rootds;if($.type(hdsoptions.dataSource)==="string"){opts.dataSourceUrl=hdsoptions.dataSource}this.element.attr("data-level",0);if(this._root){this._root.igList("option","dataSource",opts.dataSource)}else{opts._hParent=this;this._root=this.element.igList(opts)}},root:function(){return this._root},rootWidget:function(){return this.root().data("igFlatList")},_layouts:function(){this.element.unbind("ig_flatlistdatarendering",this._databoundHandler)},_hdsoptions:function(){var opts,schema,lists;if(!this.options.dataSource&&!this.options.dataSourceUrl){if(!this.element.is("ul")&&!this.element.is("ol")){lists=this.element.children("ul,ol");this.options.dataSource=lists[0]}else{this.options.dataSource=this.element[0]}}else{if(!this.options.dataSource&&this.options.dataSourceUrl){this.options.dataSource=this.options.dataSourceUrl}}opts={responseDataKey:this.options.responseDataKey,responseTotalRecCountKey:this.options.responseTotalRecCountKey,dataSource:this.options.dataSource,localSchemaTransform:this.options.localSchemaTransform,odata:this.options.odata,initialDataBindDepth:this.options.initialDataBindDepth};if(this.options.bindings&&this.options.bindings.primaryKey){opts.primaryKey=this.options.bindings.primaryKey}if(this.options.dataSourceType!==null){opts.type=this.options.dataSourceType}schema=this._hschema();if((this.options.dataSource instanceof $.ig.HierarchicalDataSource&&this.options.dataSource.settings.schema===null)||!(this.options.dataSource instanceof $.ig.HierarchicalDataSource)){opts=$.extend(opts,{schema:schema})}return opts},_hschema:function(){var schema={},ds=this.options.dataSource,opt=this.options,bindings=opt.bindings,guess,x,prop,rec,name,camelCase,bindingName,fieldType,allFields=["Text","NavigateUrl","ImageUrl","Count","Description","Header","DetailsTitle","IsDivider"];schema.fields=[];schema.searchField=this.options.responseDataKey;if(bindings===null){if(ds&&((ds.length&&ds.length>0&&$.type(ds)==="array")||(ds.tagName&&(ds.tagName.toLowerCase()==="ul"||ds.tagName.toLowerCase()==="ol")))){opt.bindings={};for(x=0;x<ds.length;++x){rec=ds[x];for(prop in rec){if(rec.hasOwnProperty(prop)){guess=this._guessBindingName(rec,prop);if(guess&&!this._fieldExists(prop,schema)&&allFields.indexOf(guess)>-1){camelCase=this._toCamelCase(guess);bindingName=this._getBindingName(guess);fieldType=this._calcFieldType(guess);schema.fields.push({name:prop,type:fieldType});schema[bindingName]={name:prop,type:fieldType};schema[camelCase]={name:prop,type:fieldType};opt.bindings[bindingName]=prop;allFields.removeAt(allFields.indexOf(guess))}}}}for(x=0;x<allFields.length;++x){name=allFields[x];if(!this._fieldExists(name,schema)){camelCase=this._toCamelCase(name);bindingName=this._getBindingName(name);fieldType=this._calcFieldType(name);schema.fields.push({name:name,type:fieldType});schema[bindingName]={name:name,type:fieldType};schema[camelCase]={name:name,type:fieldType};opt.bindings[bindingName]=name}}if(this.options.childLayout){schema.childDataProperty={name:this.options.childLayout.key,type:"object"};schema.childData={name:this.options.childLayout.key,type:"object"}}else{if(ds&&ds.tagName&&(ds.tagName.toLowerCase()==="ul"||ds.tagName.toLowerCase()==="ol")){schema.childDataProperty={name:"Children",type:"object"};schema.childData={name:"Children",type:"object"}}}}return schema}if(opt.dataSourceType==="xml"){schema.fields=[];if(bindings.textKey){schema.fields.push({name:bindings.textKey,xpath:bindings.textXPath});schema.textKey=bindings.textKey}if(bindings.navigateUrlKey){schema.fields.push({name:bindings.navigateUrlKey,xpath:bindings.navigateUrlXPath});schema.navigateUrlKey=bindings.navigateUrlKey}if(bindings.imageUrlKey){schema.fields.push({name:bindings.imageUrlKey,xpath:bindings.imageUrlXPath});schema.imageUrlKey=bindings.imageUrlKey}if(bindings.countKey){schema.fields.push({name:bindings.countKey,xpath:bindings.countXPath});schema.countXPath=bindings.countKey}if(bindings.headerKey){schema.fields.push({name:bindings.headerKey,xpath:bindings.headerXPath});schema.headerXPath=bindings.headerKey}if(bindings.descriptionKey){schema.fields.push({name:bindings.descriptionKey,xpath:bindings.descriptionXPath});schema.descriptionXPath=bindings.descriptionKey}if(bindings.searchFieldXPath){schema.searchField=bindings.searchFieldXPath}if(this.options.childLayout){schema.childDataProperty={name:this.options.childLayout.key,type:"object"};schema.childData={name:this.options.childLayout.key,type:"object"}}return schema}schema.fields=[];if(bindings.primaryKey){schema.fields.push({name:bindings.primaryKey,type:"string"});schema.primaryKeyKey=bindings.primaryKey}if(bindings.textKey){schema.fields.push({name:bindings.textKey,type:"string"});schema.textKey=bindings.textKey}if(bindings.navigateUrlKey){schema.fields.push({name:bindings.navigateUrlKey,type:"string"});schema.navigateUrlKey=bindings.navigateUrlKey}if(bindings.imageUrlKey){schema.fields.push({name:bindings.imageUrlKey,type:"string"});schema.imageUrlKey=bindings.imageUrlKey}if(bindings.countKey){schema.fields.push({name:bindings.countKey,type:"number"});schema.countKey=bindings.countKey}if(bindings.headerKey){schema.fields.push({name:bindings.headerKey,type:"string"});schema.headerKey=bindings.headerKey}if(bindings.descriptionKey){schema.fields.push({name:bindings.descriptionKey,type:"string"});schema.descriptionKey=bindings.descriptionKey}if(bindings.isDividerKey){schema.fields.push({name:bindings.isDividerKey,type:"bool"});schema.isDividerKey=bindings.isDividerKey}if(this.options.childLayout){schema.childDataProperty={name:this.options.childLayout.key,type:"object"};schema.childData={name:this.options.childLayout.key,type:"object"}}return schema},_toCamelCase:function(val){return val.substr(0,1).toLowerCase()+val.substr(1,val.length-1)},_calcFieldType:function(name){if(name==="Count"){return"number"}if(name==="IsDivider"){return"bool"}return"string"},_getBindingName:function(name){name=this._toCamelCase(name);if(name.indexOf("Key")!==-1){return name}return name+"Key"},_guessBindingName:function(rec,prop){var val=rec[prop];if(prop==="Text"){return"Text"}if(prop==="NavigateUrl"){return"NavigateUrl"}if(prop==="ImageUrl"){return"ImageUrl"}if(prop==="Count"){return"Count"}if(prop==="Description"){return"Description"}if(prop==="Header"){return"Header"}if(prop==="DetailsTitle"){return"DetailsTitle"}if(prop==="IsDivider"){return"IsDivider"}if(prop==="PrimaryKey"){return"PrimaryKey"}if($.type(val)==="string"){if(val.indexOf(".gif")>-1||val.indexOf(".png")>-1||val.indexOf(".jpg")>-1){return"ImageUrl"}if(val.indexOf("http://")===0||val.indexOf(".htm")>-1||val.indexOf(".aspx")>-1){return"NavigateUrl"}return"Text"}if($.type(val)==="number"){return"Count"}if($.type(val)==="boolean"){return"IsDivider"}return null},_fieldExists:function(prop,schema){var i;for(i=0;i<schema.fields.length;i++){if(schema.fields[i].name===prop){return true}}return false},_parseLayouts:function(layouts,cpath,options){var layout,p,cdp=null;if(options.childLayout){layout=options.childLayout;cdp=layout.key;if(!cdp){cdp=this.options.defaultChildrenDataProperty}p=cpath+this.options.pathSeparator+cdp+":";if(layout.bindings&&layout.bindings.primaryKey){p+=layout.bindings.primaryKey}else{p+="ig_pk"}layouts[p]=layout;this._parseLayouts(layouts,p,layout)}},_optsFor:function(popts){var i,o=[],layout;if(popts.childLayout){layout=popts.childLayout;this._inherit(popts,layout);o.push($.extend(true,{},$.mobile.igList.prototype.options,layout))}if(popts.dataSourceUrl){for(i=0;i<o.length;i++){if(!o[i].dataSource){o[i].dataSourceUrl=popts.dataSourceUrl}else{o[i].dataSourceUrl=o[i].dataSource}}}return o[0]},_inherit:function(parent,child){if(parent.dataSourceType&&!child.dataSourceType){child.dataSourceType=parent.dataSourceType}},_schemaGenerated:function(evnt,args){var hList,i,rec,schema=args.schema,ds=args.dataSource,$this=args.owner,prop,child;hList=$this.options._hParent;if(this.options.dataSource&&this.options.dataSource.tagName&&(this.options.dataSource.tagName.toLowerCase()==="ul"||this.options.dataSource.tagName.toLowerCase()==="ol")&&($this.options.childLayout===null||$this.options.childLayout===undefined)){child=$this.options.childLayout={};child.key="Children"}if(!hList||hList.options.initialDataBindDepth>-1){return}for(i=0;ds&&ds.length&&$.type(ds)==="array"&&i<ds.length;i++){rec=ds[i];for(prop in rec){if(rec.hasOwnProperty(prop)){if(!$this._fieldExists(prop,schema)&&($.type(rec[prop])==="array"||$.type(rec[prop])==="object")){schema.fields.push({name:prop,type:$.ig.getColType(rec[prop])})}}}}},_hierarchicalHasSubPage:function(val){var self=this,opts=this.options,hList=opts._hParent,hasSubPage,childprop,layout,lod;hasSubPage=opts.itemDetailsTemplate!==null&&opts.itemDetailsTemplate.length>0;if(!hasSubPage&&opts.childLayout!==null&&opts.childLayout!==undefined){lod=hList.options.initialDataBindDepth>-1;if(!lod){if(val[opts.childLayout.key]){childprop=opts.childLayout.key;layout=opts.childLayout}childprop=childprop||self.options.defaultChildrenDataProperty;if(childprop){if(layout&&layout.responseDataKey){if(val[childprop]&&val[childprop][layout.responseDataKey]&&val[childprop][layout.responseDataKey].length!==undefined&&val[childprop][layout.responseDataKey].length>0){hasSubPage=true}}else{if(val[childprop]&&val[childprop].length!==undefined&&val[childprop].length>0){hasSubPage=true}}}}else{hasSubPage=true}}return hasSubPage},_hierarchicalCreateSubPageContent:function(dataItem,listItem){var items=this._flatCreateSubPageContent(dataItem,listItem),parent=listItem.closest(".ig-listview").data("igFlatList"),parentOptions=parent.options,hList=this,cOpts,keyspath="",itemId="",parentListItem=parentOptions._parent,ds,childds,sp,childList,parentLevel,level,keyspathvar,isHierarchical,tmplist,tmpkey,pki,rootId,aList,noCancel,result;if(hList.root()&&hList.root().length>0){rootId=hList.root()[0].id}if(parentOptions.childLayout!==undefined&&parentOptions.childLayout!==null){cOpts=hList._optsFor(parentOptions);result=hList._getChildDataSource(parentOptions,cOpts,listItem,parentListItem,aList);itemId=result.itemId;keyspathvar=result.keyspathvar;keyspath=result.keyspath;if(!rootId&&aList){rootId=aList.element.id}else{if(!rootId){rootId=parent.element.id}}childList=$("<div></div>").attr("id",rootId+"_"+listItem.attr("data-id")+"_"+cOpts.key+"_child");parentLevel=parseInt(parent.element.attr("data-level"),10);childList.attr("id",childList.attr("id").replace(",","-")).attr("data-level",parentLevel+1);childds=hList._hds.dataAt(itemId,keyspath+keyspathvar);if($.type(childds)!=="array"&&!cOpts.responseDataKey&&childds!==undefined){childds=[childds]}else{if(childds===null||childds===undefined){childds=[]}}isHierarchical=false;if(cOpts.childLayout){isHierarchical=true}if(hList._hds.settings.dataSource.tagName&&(hList._hds.settings.dataSource.tagName.toLowerCase()==="ul"||hList._hds.settings.dataSource.tagName.toLowerCase()==="ol")){isHierarchical=true}if(isHierarchical){hList._regevents(childList,hList)}cOpts._parent=listItem;cOpts._hParent=hList;level=itemId.split(parentOptions.pathSeparator).length;if(level>this.options.initialDataBindDepth&&this.options.initialDataBindDepth!==-1){sp=true}ds=hList._hdsoptions().dataSource;if(!sp){cOpts.dataSource=childds;if($.type(ds)==="string"){cOpts.dataSourceUrl=ds}if(cOpts.dataSourceUrl&&$.type(cOpts.dataSourceUrl)==="string"){if(cOpts.dataSourceUrl.indexOf("?")!==-1){cOpts.dataSourceUrl+="&"+hList._hds._encodeUrlPath(itemId,cOpts.key)}else{cOpts.dataSourceUrl+="?"+hList._hds._encodeUrlPath(itemId,cOpts.key)}}childList.igList(cOpts);if(cOpts.bindings===null||cOpts.bindings===undefined||cOpts.bindings.primaryKey===null||cOpts.bindings.primaryKey===undefined){tmplist=childList.data("igFlatList");tmpkey=tmplist.dataSource.schema().schema.searchField;if(tmpkey!==null){for(pki=0;pki<cOpts.dataSource[tmpkey].length;pki++){cOpts.dataSource[tmpkey][pki].ig_pk=tmplist.dataSource.data()[pki].ig_pk}}else{for(pki=0;pki<cOpts.dataSource.length;pki++){if(cOpts.dataSource[pki]){cOpts.dataSource[pki].ig_pk=tmplist.dataSource.data()[pki].ig_pk}}}}}else{if(ds instanceof $.ig.DataSource){if(this.options.odata){childds=hList._hds.dataAt(itemId,keyspath+keyspathvar);if(childds.__deferred&&childds.__deferred.uri){cOpts.dataSource=childds.__deferred.uri;if(ds.settings.dataSource.indexOf("$callback=?")!==-1){cOpts.dataSource+="?$callback=?"}if(ds.settings.dataSource.indexOf("$format=")!==-1){if(ds.settings.dataSource.indexOf("$format=json")!==-1){cOpts.dataSource+="&$format=json"}else{cOpts.dataSource+="&$format=atom"}}}}else{cOpts.dataSource=ds.settings.dataSource+"?"+hList._hds._encodeUrlPath(itemId,cOpts.key)}}else{if(cOpts.dataSourceUrl){if(cOpts.dataSourceUrl.indexOf("?")!==-1){cOpts.dataSourceUrl+="&"+hList._hds._encodeUrlPath(itemId,cOpts.key)}else{cOpts.dataSourceUrl+="?"+hList._hds._encodeUrlPath(itemId,cOpts.key)}cOpts.dataSource=cOpts.dataSourceUrl;cOpts.dataSourceType="remoteUrl"}else{if($.type(cOpts.dataSource)==="string"&&$.type(ds)!=="string"){if(cOpts.dataSource.indexOf("?")===-1){cOpts.dataSource+="?"+hList._hds._encodeUrlPath(itemId,cOpts.key)}else{cOpts.dataSource+="&"+hList._hds._encodeUrlPath(itemId,cOpts.key)}cOpts.dataSourceType="remoteUrl"}else{if($.type(ds)==="string"){if(cOpts.dataSource.indexOf("?")===-1){cOpts.dataSource+="?"+hList._hds._encodeUrlPath(itemId,cOpts.key)}else{cOpts.dataSource+="&"+hList._hds._encodeUrlPath(itemId,cOpts.key)}}else{cOpts.dataSource=childds}}}}}if(sp){noCancel=this._trigger(this.events.childrenPopulating,null,{owner:this,parentitem:listItem,id:itemId});if(noCancel){childList.igList(cOpts);this._trigger(this.events.childrenPopulated,null,{owner:this,parentitem:listItem,id:itemId})}}items[items.length++]=childList.parent()[0]}return items},_getChildDataSource:function(parentOptions,cOpts,listItem,parentListItem,aList){var itemId="",keyspath="",keyspathvar="",o,k,curpath=0,hOpts=this.options;if(parentOptions.key){keyspath=parentOptions.key}while(parentListItem){if(curpath!==0){itemId+=hOpts.pathSeparator}aList=parentListItem.closest(".ig-listview").data("igFlatList");o=parentListItem.closest(".ig-listview").data("igFlatList").options;k=o.bindings.primaryKey;itemId+=k+":"+parentListItem.attr("data-id");if(o.key){keyspath+=hOpts.pathSeparator+o.key}parentListItem=o._parent;curpath++}keyspath=keyspath.split(hOpts.pathSeparator).reverse().join(hOpts.pathSeparator);itemId=itemId.split(hOpts.pathSeparator).reverse().join(hOpts.pathSeparator);k=parentOptions.bindings.primaryKey;if(itemId===""){itemId=k+":"+listItem.attr("data-id")}else{itemId+=hOpts.pathSeparator+k+":"+listItem.attr("data-id")}if(keyspath===""){keyspathvar=cOpts.key}else{keyspathvar=hOpts.pathSeparator+cOpts.key}return{itemId:itemId,keyspath:keyspath,keyspathvar:keyspathvar}},_listInitialized:function(event,args){args.owner._hasSubPage=$.proxy(this._hierarchicalHasSubPage,args.owner);this._flatCreateSubPageContent=$.proxy(args.owner._createSubPageContent,args.owner);args.owner._createSubPageContent=$.proxy(this._hierarchicalCreateSubPageContent,this)},_itemsRendered:function(evnt,args){var list=args.owner,hasSubPages=args.hasSubPages;if(hasSubPages&&!(list.options.itemDetailsTemplate!==undefined&&list.options.itemDetailsTemplate!==null&&list.options.itemDetailsTemplate.length>0)){list.element.bind("click",function(evnt){list._listTap(evnt)})}},_regevents:function(e,context){var schemaGenerated,cancelEvent,listInitialized,itemsRendered;schemaGenerated=$.proxy(this._schemaGenerated,context);e.bind("iglistschemagenerated",schemaGenerated);listInitialized=$.proxy(this._listInitialized,context);e.bind("iglistrenderingtray",listInitialized);itemsRendered=$.proxy(this._itemsRendered,context);e.bind("iglistitemsrendered",itemsRendered);cancelEvent=function(e){e.stopPropagation();e.preventDefault();return false}},_generateLayouts:function(){var rec,i,ds=this.options.dataSource;if(($.type(ds)!=="array"&&$.type(ds)!=="object")||ds.length===0){return}if($.type(ds)==="object"&&this.options.responseDataKey){ds=ds[this.options.responseDataKey]||ds}for(i=0;i<ds.length;i++){rec=ds[i];this._generateLayout(rec,this.options)}},_generateLayout:function(record,options){var name,layout,tmpLayout,i,rec,hasRespKey=false;for(name in record){if(record.hasOwnProperty(name)&&($.type(record[name])==="array"||($.type(record[name])==="object"&&options.responseDataKey&&$.type(record[name][options.responseDataKey])==="array"))){rec=record[name];if(options.responseDataKey&&$.type(rec)==="object"){if(rec[options.responseDataKey]&&$.type(rec[options.responseDataKey])==="array"){rec=rec[options.responseDataKey];hasRespKey=true}else{continue}}layout={key:name};if(hasRespKey){layout.responseDataKey=options.responseDataKey}tmpLayout=this._layoutExistsRecursive(this.options,name);if(!tmpLayout){if(options.childLayout===undefined||options.childLayout===null){options.childLayout=layout}}else{layout=tmpLayout}if(rec.length>0){for(i=0;i<rec.length;i++){this._generateLayout(rec[i],layout)}}}}},_layoutExistsRecursive:function(options,key){var tmpLayout=null;tmpLayout=options.key===key?options:tmpLayout;if(!tmpLayout&&options.childLayout){tmpLayout=this._layoutExistsRecursive(options.childLayout,key)}return tmpLayout},destroy:function(){this.tmpDataSource=null;this.rootWidget().destroy();$.Widget.prototype.destroy.call(this)}});function _addDash(c){return"-"+c.toLowerCase()}function parseBindings(element,options){var added=false,nullAtStart=false,binding,value,bindingsPrototype=$.mobile.igList.prototype.options.bindings;if(!options.bindings){nullAtStart=true;options.bindings={}}if(!bindingsPrototype){bindingsPrototype=_originalBindings}for(binding in bindingsPrototype){if(bindingsPrototype.hasOwnProperty(binding)){value=element.jqmData("bindings-"+binding.replace(/[A-Z]/g,_addDash));if(value!==undefined){added=true;options.bindings[binding]=value}}}if(!added&&nullAtStart){options.bindings=null}}function parseSimpleProps(element,options,type){var option,value;for(option in type.prototype.options){if(type.prototype.options.hasOwnProperty(option)){value=element.jqmData(option.replace(/[A-Z]/g,_addDash));if(value!==undefined){options[option]=value}}}}function parseSimpleFlatListProps(element,options){var value;parseSimpleProps(element,options,$.mobile.igList);value=element.jqmData("key");if(value!==undefined){options.key=value}}function parseLevel(list,options,parse){var items,args,subList;if(parse===undefined){parse=true}items=list.children(":jqmData(role='itemTemplate')");if(items.length>0){options.itemTemplate=unescape(items.first().html())}items=list.children(":jqmData(role='detailsTemplate')");if(items.length>0){options.itemDetailsTemplate=unescape(items.first().html())}if(parse){parseSimpleFlatListProps(list,options);parseBindings(list,options);args={element:list,options:options};$(document).trigger("_igListViewHtmlOptions",args);options=args.options}subList=list.children("li").children("ul:jqmData(role='childLayout'), ol:jqmData(role='childLayout')");if(subList.length>0){options.childLayout={};parseLevel(subList,options.childLayout)}}function _igmListAutoInit(e){var target=document;if(e){target=e.target}$($.mobile.igListView.prototype.options.initSelector,target).each(function(i){var $this=$(this),optObj={_fromHtml:true},options=$this.jqmData("options"),list=$this,args,parseLevelOne=true;if($this.data("igListView")){return}if(options){try{optObj=eval(options)}catch(exc){try{optObj=$.parseJSON(options)}catch(exc2){optObj={}}}}if(!(list.is("ul")||list.is("ol"))){parseSimpleFlatListProps($this,optObj);parseBindings($this,optObj);args={element:list,options:optObj,listElement:list.children("ul,ol")};$(document).trigger("_igListViewHtmlOptions",args);parseLevelOne=false;list=list.children("ul,ol")}parseSimpleProps(list,optObj,$.mobile.igListView);parseLevel(list,optObj,parseLevelOne);$this.igListView(optObj)})}if($.ig&&$.ig.loader){$.ig.loader().preinit(_igmListAutoInit)}$(document).bind("pagecreate create",_igmListAutoInit);if(typeof define==="function"&&define.amd&&define.amd.jQuery){define("ig.mobileui.list",["ig.util","ig.datasource","ig.mobileui.flatlist"],function(){return $.mobile.igListView})}$.extend($.mobile.igListView,{version:"12.1.20121.1010"})}(jQuery));