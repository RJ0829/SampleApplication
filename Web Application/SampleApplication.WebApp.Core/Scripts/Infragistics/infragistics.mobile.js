/*
 * Infragistics.Web.ClientUI Util functions 12.1.20121.1010
 *
 * Copyright (c) 2011-2012 Infragistics Inc.
 * 
 * util functions that extend the jQuery  namespace 
 * if something is not already available in jQuery, please add it here. 
 *
 * http://www.infragistics.com/
 *
 * Depends on:
 *  jquery-1.4.4.js
 *
 */
(function(){var b=false,a=/xyz/.test(function(){xyz()})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(j,e){var f=true,c=this.prototype,k,h;if(e){f=false}b=true;k=new this();b=false;function g(m,l){return function(){var o=this._super,n;this._super=c[m];n=l.apply(this,arguments);this._super=o;return n}}for(h in j){if(j.hasOwnProperty(h)){k[h]=f&&typeof j[h]==="function"&&typeof c[h]==="function"&&a.test(j[h])?g(h,j[h]):j[h]}}function d(){if(!b&&this.init){this.init.apply(this,arguments)}}d.prototype=k;d.constructor=d;d.extend=arguments.callee;if(e){d.typeName=function(){return this.prototype.$type};d.baseType=function(){return this.$type.baseType};d.prototype.getType=function(){return this.$type};d.prototype.getHashCode=function(){if(this.$hashCode){return this.$hashCode}this.$hashCode=$.ig.nextHashCode++;return this.$hashCode}}return d};if(typeof define==="function"&&define.amd&&define.amd.jQuery){define("ig.util",[],function(){return Class})}}());$.fn.startsWith=function(a){return this[0].innerHTML.indexOf(a)===0};$.ig=$.ig||{};$.ajaxQueue=function(c,b){var a;if(typeof document.ajaxQueue==="undefined"){document.ajaxQueue={queue:{}}}if(typeof document.ajaxQueue.queue[c]==="undefined"){document.ajaxQueue.queue[c]=[]}if(typeof b==="undefined"){return}a=b.complete;b.complete=function(d,e){document.ajaxQueue.queue[c].shift();if(typeof a!=="undefined"){a(d,e)}if(document.ajaxQueue.queue[c].length>0){$.ajax(document.ajaxQueue.queue[c][0])}};document.ajaxQueue.queue[c].push(b);if(document.ajaxQueue.queue[c].length===1){$.ajax(document.ajaxQueue.queue[c][0])}};Date.prototype.stdTimezoneOffset=function(){var a,b;a=new Date(this.getFullYear(),0,1);b=new Date(this.getFullYear(),6,1);return Math.max(a.getTimezoneOffset(),b.getTimezoneOffset())};Date.prototype.dst=function(){return this.getTimezoneOffset()<this.stdTimezoneOffset()};$.ig.formatter=function(H,G,k,z){var v,I,q,u,F,w,a,j,A,t,x,g,l,o,p,c,C,b,B,D,r,f=H&&H.getTime,E=$.ig.regional.defaults;if(k==="checkbox"&&z){F='<span style="width:100%;display:inline-block;overflow:hidden;text-align:center;">';F+='<span class="ui-state-default ui-corner-all ui-igcheckbox-small" style="display:inline-block">';F+='<span style="display:block" class="'+(H?"":"ui-igcheckbox-small-off ");return F+'ui-icon ui-icon-check ui-igcheckbox-small-on"></span></span></span>'}if(!H&&H!==0&&H!==false){return"&nbsp;"}if(G==="date"||f){if(!H){return"&nbsp;"}if(!f){return H}A=E[(k&&k!=="null"&&k!=="undefined")?k+"Pattern":"datePattern"]||k;I=H.getFullYear();u=H.getMonth()+1;f=H.getDate();q=H.getHours();v=H.getMinutes();F=H.getSeconds();w=H.getMilliseconds();A=A.replace("MMMM","\x01").replace("MMM","\x02").replace("dddd","\x03").replace("ddd","\x04");if(A.indexOf("t")>=0){a=(q>=12)?E.pm:E.am;a=a||" ";if(A.indexOf("tt")>=0){A=A.replace("tt","t")}else{if(a.length>1){a=a.substring(0,1)}}A=A.replace("t","\x05")}if(A.indexOf("h")>=0&&q>12){q-=12}A=A.replace(/H/g,"h");A=A.replace("yyyy",I).replace("yy",((I=I%100)<10)?"0"+I:I).replace("y",I%100).replace("MM",(u<10)?"0"+u:u).replace("M",u);A=A.replace("dd",(f<10)?"0"+f:f).replace("d",f);A=A.replace("hh",(q<10)?"0"+q:q).replace("h",q).replace("mm",(v<10)?"0"+v:v).replace("m",v).replace("ss",(F<10)?"0"+F:F).replace("s",F);A=A.replace("fff",(w<10)?"00"+w:((w<100)?"0"+w:w)).replace("ff",((w=Math.round(w/10))<10)?"0"+w:w).replace("f",Math.round(w/100));A=A.replace("\x01",E.monthNames[u-1]).replace("\x02",E.monthNamesShort[u-1]).replace("\x05",a);A=A.replace("\x03",E.dayNames[H.getDay()]).replace("\x04",E.dayNamesShort[H.getDay()]);return A}f=k==="double";if(!f){b=k===(c="currency");if(!b){B=k===(C="percent");if(!B){r=k==="int"}}}x=typeof H==="number";if(f||x||r||b||B||G==="number"){if(!x){H=parseFloat(H.replace("(","-").replace(/[^0-9\-eE\.\+]/gm,""))}if(isNaN(H)){return"&nbsp;"}D=b?c:(B?C:"numeric");A=E[D+((H<0)?"Negative":"Positive")+"Pattern"]||"n";t=k?k.length:0;if(t>0&&((F=k.charAt(0))==="0"||F==="#")){v=u=0;g=k.indexOf(".");if(g>0){u=t-1-g;while(++g<t){if(k.charAt(g)!=="0"){break}v++}}}else{v=E[D+"MinDecimals"]||0;if(f){u=999}else{u=E[D+"MaxDecimals"];u=(u&&!r)?u:0}}if(H<0){H=-H}H=(u===999)?H.toString(10):H.toFixed(u);if((r=H.indexOf("E"))<0){r=H.indexOf("e")}j="";if(r>0){j=H.substring(r);H=H.substring(0,r)}g=H.indexOf(".");t=H.length;r=0;while(g>0&&u>v+r&&H.charAt(t-1-r)==="0"){r++}if(r>0){H=H.substring(0,t-=r)}if(g===t-1){H=H.substring(0,g)}if(g>0){t=g}F=E[D+"DecimalSeparator"];if(F){H=H.replace(".",F)}F=E[D+"GroupSeparator"];p=F?E[D+"Groups"]:"";l=o=(p.length>0)?p[r=0]:0;while(l>0&&--t>0){if(--l===0){H=H.substring(0,t)+F+H.substring(t);l=p[++r];if(!l||l<1){l=o}else{o=l}}}F=E[D+"Symbol"]||"";return A.replace("-",E.negativeSign).replace("n",H+j).replace("$",F)}if(k){if(k.indexOf(F="{0}")>=0){return k.replace(F,H)}if(k.indexOf(F="[0]")>=0){return k.replace(F,H)}}return(H||H===0)?H:"&nbsp;"};$.ig._regional={monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],am:"AM",pm:"PM",datePattern:"M/d/yyyy",dateLongPattern:"dddd, MMMM dd, yyyy",dateTimePattern:"M/d/yyyy h:mm tt",timePattern:"h:mm tt",timeLongPattern:"h:mm:ss tt",negativeSign:"-",numericNegativePattern:"-$n",numericDecimalSeparator:".",numericGroupSeparator:",",numericGroups:[3],numericMaxDecimals:2,numericMinDecimals:0,currencyPositivePattern:"$n",currencyNegativePattern:"$(n)",currencySymbol:"$",currencyDecimalSeparator:".",currencyGroupSeparator:",",currencyGroups:[3],currencyMaxDecimals:2,currencyMinDecimals:2,percentPositivePattern:"n$",percentNegativePattern:"-n$",percentSymbol:"%",percentDecimalSeparator:".",percentGroupSeparator:",",percentGroups:[3],percentDisplayFactor:100,percentMaxDecimals:2,percentMinDecimals:2};$.ig.regional=$.ig.regional||{};$.ig.regional.defaults=$.ig._regional;$.ig.setRegionalDefault=function(a){if($.ui&&$.ui.igEditor){$.ui.igEditor.setDefaultCulture(a)}else{$.ig.regional.defaults=$.extend($.ig._regional,(typeof a==="string")?$.ig.regional[a]:a)}};$.ig.calcSummaries=function(summaryFunction,data,caller,dataType){var sum=function(data){var sum=0,i;for(i=0;i<data.length;i++){sum+=data[i]}return sum};summaryFunction=summaryFunction.toLowerCase();if(summaryFunction.startsWith("custom")){summaryFunction="custom"}switch(summaryFunction){case"min":if(data.length===0){if(dataType==="date"){return null}return 0}return Math.min.apply(Math,data);case"max":if(data.length===0){if(dataType==="date"){return null}return 0}return Math.max.apply(Math,data);case"sum":return sum(data);case"avg":if(data.length===0){return 0}return sum(data)/data.length;case"count":return data.length;case"custom":if(caller!==undefined&&caller!==null){if($.type(caller)==="function"){return caller(data)}if($.type(caller)==="string"){caller=eval(caller);return caller(data)}}else{return null}break}};$.ig.uid=function(){return((1+Math.random())*parseInt("10000",16)).toString(16).substring(1,5)};$.ig.nextHashCode=0;$.ig.util=$.ig.util||{};$.ig.util.ensureUniqueId=function(b){if(!b.getHashCode){var a=$.ig.nextHashCode++;b.getHashCode=function(){return a}}};$.ig.getColType=function(a){var b=typeof a;if(b==="undefined"){return"string"}else{if(b==="object"&&a instanceof Date){return"date"}else{if(b==="boolean"){return"bool"}else{if(b==="number"){return b}else{if(b==="object"){return"object"}else{return"string"}}}}}};$.ig.typeIdentifierCache={};$.ig.nextTypeIdentifier=0;$.ig.Type=Class.extend({init:function(b,a,c){this.specializationCache={};this.name=b;this.typeArguments=null;this.baseType=null;this.interfaces=null;if(a){this.baseType=a}if(c){this.interfaces=c}if($.ig.typeIdentifierCache[b]){this.identifier=$.ig.typeIdentifierCache[b]}else{this.identifier=$.ig.nextTypeIdentifier++;$.ig.typeIdentifierCache[b]=this.identifier}},typeName:function(){return this.name},getSpecId:function(d){if(d.length===1){if(!d[0]){return"undef"}else{if(!d[0].typeName){return d[0].toString()}else{if(d[0].stringId){return d[0].stringId}else{return d[0].identifier.toString()}}}}var b="";for(var a=0;a<d.length;a++){var c=d[a];if(!d[0]){b+="undef"}else{if(!d[0].typeName){b+=d[0].toString()}else{if(d[0].stringId){b+=d[0].stringId}else{b+=d[0].identifier.toString()}}}}return b},specializationCache:null,specialize:function(){var e=this.getSpecId(arguments);var d=this.specializationCache[e];if(d){return d}d=new $.ig.Type(this.name,this.baseType,this.interfaces);var c=this.typeArguments;var a=false;if(c){a=true}d.typeArguments=[];if(a){for(var b=0;b<c.length;b++){d.typeArguments[b]=arguments[c[b]]}}else{for(var b=0;b<arguments.length;b++){d.typeArguments[b]=arguments[b]}}if(this.baseType&&this.baseType.typeArguments){d.baseType=this.baseType.specialize(arguments)}if(this.interfaces){for(var b=0;b<this.interfaces.length;b++){d.interfaces[b]=this.interfaces[b].specialize(arguments)}}this.specializationCache[e]=d;d.stringId=d.generateString();return d},equals:function(b){if(!(b instanceof $.ig.Type)){return false}if(this.identifier!==b.identifier){return false}if(this.typeArguments===null&&b.typeArguments===null){return true}if(this.typeArguments===null&&b.typeArguments!==null){return false}if(this.typeArguments!==null&&b.typeArguments===null){return false}if(this.typeArguments.length!==b.typeArguments.length){return false}for(var a=0;a<this.typeArguments.Length;a++){if(!(this.typeArguments[a].equals(b.typeArguements[a]))){return false}}return true},checkEquals:function(a,b){if(a instanceof $.ig.Type){return a.equals(b)}else{if(b instanceof $.ig.Type){return b.equals(a)}else{return a==b}}},op_Equality:function(a,b){return a.equals(other)},op_Inequality:function(a,b){return !a.equals(b)},generateString:function(){if(!this.typeArguments||this.typeArguments.length==0){return this.identifier.toString()}else{var c=this.identifier.toString()+"[";var a=true;for(var b=0;b<this.typeArguments.count;b++){if(a){a=false}else{c+=","}c+=this.typeArguments[b].toString()}c+="]";return c}}},true);$.ig.Object=Class.extend({init:function(){},$type:new $.ig.Type("Object")},true);$.ig.Enum=Class.extend({$type:new $.ig.Type("Enum",$.ig.Object.prototype.$type)},true);$.ig.ValueType=Class.extend({$type:new $.ig.Type("ValueType",$.ig.Object.prototype.$type)},true);$.ig.INotifyPropertyChanged=Class.extend({init:function(){},_PropertyChanged:function(){},$type:new $.ig.Type("INotifyPropertyChanged")},true);$.ig.PropertyChangedEventArgs=$.ig.Object.extend({init:function(a){this._propertyName=a},_propertyName:null,propertyName:function(a){if(arguments.length===0){return this._propertyName}else{this._propertyName=a}},$type:new $.ig.Type("PropertyChangedEventArgs",$.ig.Object.$type)},true);$.ig.XmlNodeType=Class.extend({_Attribute:2,_CDATA:4,_Comment:8,_Document:9,_DocumentFragment:11,_DocumentType:10,_Element:1,_Entity:6,_EntityReference:5,_Notation:12,_ProcessingInstruction:7,_Text:3},true);$.ig.XmlDocumentParser=Class.extend({parse:function(d){if(!window.DOMParser){var e=["Msxml2.DOMDocument.3.0","Msxml2.DOMDocument"];for(var c=0;c<e.length;c++){try{var f=new ActiveXObject(progIDs[c]);f.async=false;f.loadXML(d);f.setProperty("SelectionLanguage","XPath");return f}catch(b){}}}else{try{var a=new DOMParser();return a.parseFromString(d,"text/xml")}catch(b){}}return null}},true);$.ig.Array=Array;$.ig.Array.prototype.add=function(a){this[this.length]=a};$.ig.Array.prototype.indexOf=function(b){for(var a=0;a<this.length;a++){if(this[a]==b){return a}}return -1};$.ig.removeFromArray=function(a,b,d){var c=a.slice((d||b)+1||a.length);a.length=b<0?a.length+b:b;return a.push.apply(a,c)};$.ig.Array.prototype.contains=function(b){var a=this.indexOf(b);return(a>=0)};$.ig.Array.prototype.insert=function(a,b){this.splice(a,0,b)};$.ig.Array.prototype.removeAt=function(a){this.splice(a,1)};$.ig.Array.prototype.removeItem=function(b){var a=this.indexOf(b);if(a>=0){this.splice(a,1);return true}return false};$.ig.Array.prototype.getEnumerator=function(){return new $.ig.ArrayEnumerator(this)};$.ig.Array.prototype.count=function(){return this.length};$.ig.Array.prototype.item=function(a,b){if(arguments.length===2){this[a]=b;return b}else{return this[a]}};$.ig.Array.prototype.getLength=function(a){if(a===0){return this.length}else{return this.dimensionLength[a-1]}};$.ig.ArrayEnumerator=Class.extend({init:function(a){this._array=a;this._index=-1},current:function(){return this._array[this._index]},moveNext:function(){this._index++;return(this._index<this._array.length)},reset:function(){this._index=-1}},true);$.ig.Date=Class.extend({init:function(){},$type:new $.ig.Type("Date",$.ig.Object.$type)},true);$.ig.Date.prototype.now=function(){return new Date()};$.ig.Date.prototype.fromMilliseconds=function(a){return a};$.ig.util.canAssign=function(b,c){if($.ig.Type.prototype.checkEquals(b,c)){return true}if(c.interfaces){for(var a=0;a<c.interfaces.length;a++){if($.ig.util.canAssign(b,c.interfaces[a])){return true}}}if(c.baseType){return $.ig.util.canAssign(b,c.baseType)}return false};$.ig.util.cast=function(b,a){if(a==null){return null}var c=a;if(a.$type){c=a.$type}if($.ig.util.canAssign(b,c)){return a}else{return null}};$.ig.Dictionary=Class.extend({init:function(){this.proxy={};this.keysHolder=this.proxy;this._count=0},$type:new $.ig.Type("Dictionary",$.ig.Object.prototype.$type),proxy:null},true);$.ig.Dictionary.prototype.getDictionary=function(b){var a=new $.ig.Dictionary();a.proxy=b;a.keysHolder=b;return a};$.ig.Dictionary.prototype.containsKey=function(a){return this.proxy[a]!==undefined};$.ig.Dictionary.prototype.count=function(){return this._count};$.ig.Dictionary.prototype.item=function(a,b){if(arguments.length===1){return this.proxy[a]}else{if(!this.proxy[a]){this._count++}this.proxy[a]=b}};$.ig.Dictionary.prototype.add=function(a,b){if(!this.proxy[a]){this._count++}this.proxy[a]=b};$.ig.Dictionary.prototype.remove=function(a){delete this.proxy[a];this._count--};$.ig.Dictionary.prototype.keys=function(){return new $.ig.KeyEnumerator(this)};$.ig.Dictionary.prototype.values=function(){return new $.ig.ValueEnumerator(this)};$.ig.Dictionary.prototype.clear=function(){this.proxy={};this.keysHolder=this.proxy;this._count=0};$.ig.EventArgs=$.ig.Object.extend({init:function(){}},true);$.ig.Number=Class.extend({$type:new $.ig.Type("Number",$.ig.Object.prototype.$type)},true);$.ig.Number.prototype.parseInt=function(c,d){return parseInt(c,d)};$.ig.Number.prototype.log10=function(a){return Math.log(a)/Math.log(10)};$.ig.Single=Class.extend({},true);$.ig.Single.prototype.parseFloat=function(a){return parseFloat(a)};$.ig.Int32=Class.extend({$type:new $.ig.Type("Int32",$.ig.Object.prototype.$type)},true);$.ig.Double=Class.extend({$type:new $.ig.Type("Double",$.ig.Object.prototype.$type)},true);$.ig.Delegate=Class.extend({$type:new $.ig.Type("Delegate",$.ig.Object.prototype.$type)},true);$.ig.Delegate.prototype.combine=function(a,b){if(!a){return b}if(!b){return a}var c=function(){a.apply(null,arguments);return b.apply(null,arguments)};c.enumerate=function(d){if(a){if(a.enumerate){a.enumerate(d)}else{d.push(a)}}if(b){if(b.enumerate){b.enumerate(d)}else{d.push(b)}}};return c};$.ig.Delegate.prototype.remove=function(c,d){if(!c){return null}if(!d){return c}var a=[];var b=null;if(c.enumerate){c.enumerate(a)}else{a.push(c)}for(var e=0;e<a.length;e++){if(d.original){if(a[e].original==d.original&&a[e].target==d.target){continue}}if(a[e]==d){continue}b=$.ig.Delegate.prototype.combine(b,a[e])}return b};$.ig.ReflectionUtil=Class.extend({$type:new $.ig.Type("ReflectionUtil",$.ig.Object.prototype.$type)},true);$.ig.ReflectionUtil.prototype.getPropertyGetter=function(b,a){if(typeof b.prototype[a]==="function"){return function(c){return b.prototype[a].apply(c,arguments)}}return function(c){return c[a]}};$.ig.IEnumerable=Class.extend({$type:new $.ig.Type("IEnumerable",null)},true);$.ig.IEnumerator=Class.extend({$type:new $.ig.Type("IEnumerator",null)},true);$.ig.IEqualityComparer$1=Class.extend({$type:new $.ig.Type("IEqualityComparer",$.ig.Object.prototype.$type)},true);$.ig.IList=Class.extend({$type:new $.ig.Type("IList",null,[$.ig.IEnumerable.prototype.$type])},true);$.ig.Error=Class.extend({$type:new $.ig.Type("Error",$.ig.Object.prototype.$type)},true);$.ig.IDictionary=Class.extend({$type:new $.ig.Type("IDictionary",null)},true);$.ig.ValueEnumerator=Class.extend({init:function(a){this._dict=a;this._index=-1;this._count=0;this._values=[];for(var b in this._dict.proxy){this._values[this._count]=this._dict.proxy[b];this._count++}},current:function(){return this._values[this._index]},moveNext:function(){this._index++;return(this._index<this._count)},reset:function(){this._index=-1},getEnumerator:function(){this.reset();return this},$type:new $.ig.Type("ValueEnumerator",$.ig.Object.prototype.$type,[$.ig.IEnumerable.prototype.$type])},true);$.ig.KeyEnumerator=Class.extend({init:function(a){this._dict=a;this._index=-1;this._count=0;this._keys=[];for(var b in this._dict.proxy){this._keys[this._count]=b;this._count++}},current:function(){return this._keys[this._index]},moveNext:function(){this._index++;return(this._index<this._count)},reset:function(){this._index=-1},getEnumerator:function(){this.reset();return this},$type:new $.ig.Type("KeyEnumerator",$.ig.Object.prototype.$type,[$.ig.IEnumerable.prototype.$type])},true);$.ig.intDivide=function(a,b){var c=a/b;if(c>=0){return Math.floor(c)}else{return Math.ceil(c)}};$.ig.Nullable$1=Class.extend({$t:null,init:function(a,b){this.$t=a;this.$type=this.$type.specialize(this.$t);$.ig.Object.prototype.init.call(this);this._value=b},hasValue:function(){return this._value!==null},_value:null,value:function(a){if(arguments.length===1){this._value=a}else{return this._value}},getValueOrDefault:function(){if(this.hasValue()){return this._value}else{return getDefaultValue()}},getDefaultValue:function(){if($.ig.util.canAssign($.ig.Number.prototype.$type,$t)){return 0}else{if($.ig.util.canAssign($.ig.Boolean.prototype.$type,$t)){return false}else{return null}}},getValueOrDefault1:function(a){if(this.hasValue()){return this._value}else{return a}},isNullable:true,$type:new $.ig.Type("Nullable$1",$.ig.Object.prototype.$type)},true);$.ig.util.toNullable=function(b,c){if(c&&c.isNullable){return c}var a=new $.ig.Nullable$1(b,c);return a};$.ig.util.nullableAdd=function(a,b){if(a.isNullable&&!a.hasValue()){return null}if(b.isNullable&&!b.hasValue()){return null}var c=a;var d=b;if(a.isNullable){c=a.value()}if(b.isNullable){d=b.value()}return $.ig.util.toNullable($.ig.Number.prototype.$type,c+d)};$.ig.util.nullableSubtract=function(a,b){if(a.isNullable&&!a.hasValue()){return null}if(b.isNullable&&!b.hasValue()){return null}var c=a;var d=b;if(a.isNullable){c=a.value()}if(b.isNullable){d=b.value()}return $.ig.util.toNullable($.ig.Number.prototype.$type,c-d)};$.ig.util.nullableMultiply=function(a,b){if(a.isNullable&&!a.hasValue()){return null}if(b.isNullable&&!b.hasValue()){return null}var c=a;var d=b;if(a.isNullable){c=a.value()}if(b.isNullable){d=b.value()}return $.ig.util.toNullable($.ig.Number.prototype.$type,c*d)};$.ig.util.nullableDivide=function(a,b){if(a.isNullable&&!a.hasValue()){return null}if(b.isNullable&&!b.hasValue()){return null}var c=a;var d=b;if(a.isNullable){c=a.value()}if(b.isNullable){d=b.value()}return $.ig.util.toNullable($.ig.Number.prototype.$type,c/d)};$.ig.util.nullableModulus=function(a,b){if(a.isNullable&&!a.hasValue()){return null}if(b.isNullable&&!b.hasValue()){return null}var c=a;var d=b;if(a.isNullable){c=a.value()}if(b.isNullable){d=b.value()}return $.ig.util.toNullable($.ig.Number.prototype.$type,c%d)};$.ig.util.nullableGreaterThan=function(a,b){if(a.isNullable&&!a.hasValue()){return false}if(b.isNullable&&!b.hasValue()){return false}var c=a;var d=b;if(a.isNullable){c=a.value()}if(b.isNullable){d=b.value()}return c>d};$.ig.util.nullableGreaterThanOrEqual=function(a,b){if(a.isNullable&&!a.hasValue()){return false}if(b.isNullable&&!b.hasValue()){return false}var c=a;var d=b;if(a.isNullable){c=a.value()}if(b.isNullable){d=b.value()}return c>=d};$.ig.util.nullableLessThan=function(a,b){if(a.isNullable&&!a.hasValue()){return false}if(b.isNullable&&!b.hasValue()){return false}var c=a;var d=b;if(a.isNullable){c=a.value()}if(b.isNullable){d=b.value()}return c<d};$.ig.util.nullableLessThanOrEqual=function(a,b){if(a.isNullable&&!a.hasValue()){return false}if(b.isNullable&&!b.hasValue()){return false}var c=a;var d=b;if(a.isNullable){c=a.value()}if(b.isNullable){d=b.value()}return c<=d};$.ig.util.nullableEquals=function(a,c){var b=(a==null)||(a.IsNullable&&!a.hasValue());var d=(c==null)||(c.IsNullable&&!c.hasValue());if(b&&d){return true}if(b!=d){return false}var e=a;var f=c;if(a.isNullable){e=a.value()}if(c.isNullable){f=c.value()}return e==f};$.ig.util.nullableNotEquals=function(a,b){if(a.isNullable&&!a.hasValue()){return false}if(b.isNullable&&!b.hasValue()){return false}var c=a;var d=b;if(a.isNullable){c=a.value()}if(b.isNullable){d=b.value()}return c!=d};$.ig.util.wellKnownColors={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};$.ig.util.stringToColor=function(d){var c={a:255,r:0,g:0,b:0};var a=d.replace(" ","").toLowerCase();if($.ig.util.wellKnownColors[a]!==undefined){d=$.ig.util.wellKnownColors[a]}if(d.lastIndexOf("rgb",0)===0){d=d.replace("rgb","").replace(" ","").replace("(","").replace(")","");var b=d.split(",");c.r=parseInt(b[0]);c.g=parseInt(b[1]);c.b=parseInt(b[2])}else{if(d.lastIndexOf("rgba",0)===0){d=d.replace("rgba","").replace(" ","").replace("(","").replace(")","");var b=d.split(",");c.r=parseInt(b[0]);c.g=parseInt(b[0]);c.b=parseInt(b[1]);c.a=parseFloat(b[2])*255}else{d=d.replace("#","").replace(" ","");if(d.length===6){c.r=parseInt(d.substr(0,2),16);c.g=parseInt(d.substr(2,2),16);c.b=parseInt(d.substr(4,2),16)}else{if(d.length===3){c.r=parseInt(d.substr(0,1)+d.substr(0,1),16);c.g=parseInt(d.substr(1,1)+d.substr(1,1),16);c.b=parseInt(d.substr(2,1)+d.substr(2,1),16)}}}}return c};$.ig.util.getBinary=function(h,a,d){var b,g,f,j=false;if(typeof XMLHttpRequest=="undefined"){try{f=ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(c){}try{f=ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(c){}f=new ActiveXObject("Microsoft.XMLHTTP")}else{f=new XMLHttpRequest()}if(f.overrideMimeType){f.overrideMimeType("text/plain; charset=x-user-defined")}else{if(typeof VBArray!="undefined"){j=true}}f.onreadystatechange=function(){if(f.readyState==4){if(f.status==200){if(j){b=new VBArray(f.responseBody).toArray();for(var e=0;e<b.length;e++){b[e]=String.fromCharCode(b[e])}g=b.join("");a(g)}else{a(f.responseText)}}else{d(f.error)}}};f.open("GET",h,true);f.send(null)};$.ig.util.extCopy=function(g,a){var c,d,e;for(d=0;d<a.length;d++){var b=a[d][0];var f=a[d][1];for(e=0;e<b.length;e++){for(c=0;c<f.length;c++){b[e].prototype[f[c]]=g.prototype[f[c]]}}}};$.ig.util.bulkDefine=function(d){var c=0,a=null,b=null;for(c=0;c<d.length;c++){a=d[c];b=a.split(":");$.ig[a]=$.ig[a]||Class.extend({$type:new $.ig.Type(a,$.ig.Object.prototype.$type),$placeholder:true},true)}};$.ig.util.defType=function(d,a,c){var b=true;if($.ig[d]&&!$.ig[d].prototype.$placeholder){b=false}if(b){$.ig[d]=$.ig[a].extend(c)}};$.ig.util.getClassCount=function(a,h){var n=document.styleSheets,l=0,c,m,b,d;a=a.toLowerCase();if(!n){return 0}for(var g=0;g<n.length;g++){try{c=n[g];m=c.rules?c.rules:c.cssRules;if(!m){continue}for(var k=0;k<m.length;k++){b=m[k].selectorText;if(b){b=b.toLowerCase();if(h){if(b.indexOf(a)==0){d=parseInt(b.replace(a,""));l=Math.max(l,d)}}else{if(b==a){l++}}}}}catch(f){}}return l};(function(a){a.ig.util.profiler={};var b={};a.ig.util.profiler.recordTime=function(d,e){var c="meth: "+d;if(!b[c]){b[c]=[]}b[c][b[c].length]=e};a.ig.util.profiler.reset=function(){b={}};a.ig.util.profiler.logReport=function(){var h=[];var e=0;var m=0;var c=0;for(var l in b){if(l.indexOf("meth:")===0){var g={};g.name=l.substr(5);m=0;for(var d=0;d<b[l].length;d++){m=m+b[l][d]}var c=m/b[l].length;g.avg=c;g.callCount=b[l].length;h[e]=g;e++}}h.sort(function(j,k){if(j.avg<k.avg){return 1}if(j.avg>k.avg){return -1}if(j.avg==k.avg){return 0}});for(var f=0;f<Math.min(200,h.length);f++){console.log(h[f].name+" avg: "+h[f].avg+" callCount: "+h[f].callCount)}}}(jQuery));Function.prototype.invoke=function(){return this.apply(null,arguments)};Function.prototype.on=function(c){var b=this;var a=function(){return b.apply(c,arguments)};a.original=this;a.target=c;return a};String.prototype.startsWith=function(a){return this.indexOf(a)===0};String.prototype.endsWith=function(b){var a=this.length-b.length;return a>=0&&this.lastIndexOf(b)===a};String.prototype.empty="";String.prototype.remove=function(b,a){if(!a||((b+a)>this.length)){return this.substr(0,b)}return this.substr(0,b)+this.substr(b+a)};String.prototype.compareTo=function(a){if(this==a){return 0}if(this<a){return -1}return 1};String.getHashCode=function(){return this};String.isNullOrEmpty=function(a){return !a||a.length<1};String.prototype.equals=function(a){return this==a};Array.prototype.insertRange=function(b,c){var a=0;if(this.length==0){for(a=0;a<c.length;a++){this[b++]=c[a]}}else{for(a=0;a<c.length;a++){this.splice(b++,0,c[a])}}};Array.prototype.clone=function(){return $.extend(true,[],this)};Array.prototype.clear=function(){this.length=0};Math.log10=function(a){return Math.log(a)/Math.log(10)};Math.logBase=function(a,b){return Math.log(a)/Math.log(b)};Math.sign=function(a){if(a<0){return -1}else{if(a>0){return 1}else{return 0}}};Number.getHashCode=function(){return this};Number.isInfinity=function(a){return a===Infinity||a===-Infinity};
/*
* Infragistics.Web.ClientUI data source localization resources 12.1.20121.1010
*
* Copyright (c) 2011-2012 Infragistics Inc.
*
* http://www.infragistics.com/
*
*/
$.ig=$.ig||{};if(!$.ig.DataSourceLocale){$.ig.DataSourceLocale={};$.extend($.ig.DataSourceLocale,{locale:{invalidDataSource:"The supplied data source is invalid. It happens to be a scalar.",unknownDataSource:"Cannot determine the data source type. Please specify if it is JSON or XML data.",errorParsingArrays:"There was an error parsing the array data and applying the defined data schema: ",errorParsingJson:"There was an error parsing the JSON data and applying the defined data schema: ",errorParsingXml:"There was an error parsing the XML data and applying the defined data schema: ",errorParsingHtmlTable:"There was an error extracting the data from the HTML Table and applying the schema : ",errorExpectedTbodyParameter:"Expected a tbody or a table as a parameter.",errorTableWithIdNotFound:"The HTML Table with the following ID was not found: ",errorParsingHtmlTableNoSchema:"There was an error parsing the Table DOM: ",errorParsingJsonNoSchema:"There was an error parsing/evaluating the JSON string: ",errorParsingXmlNoSchema:"There was an error parsing the XML string: ",errorXmlSourceWithoutSchema:"The supplied data source is an xml document, but there is no defined data schema ($.IgDataSchema) ",errorUnrecognizedFilterCondition:" The filter condition that was passed was not recognized: ",errorRemoteRequest:"The remote request to fetch data has failed: ",errorSchemaMismatch:"The input data doesn't match the schema, the following field couldn't be mapped: ",errorSchemaFieldCountMismatch:"The input data doesn't match the schema in terms of number of fields. ",errorUnrecognizedResponseType:"The response type was either not set correctly, or it was not possible to detect it automatically. Please set settings.responseDataType and/or settings.responseContentType.",hierarchicalTablesNotSupported:"Tables are not supported for HierarchicalSchema",cannotBuildTemplate:"The jQuery template could not be built. There are no records present in the data source, and no columns defined.",unrecognizedCondition:"Unrecognized filtering condition in the following expression: ",fieldMismatch:"The following expression contains an invalid field or filtering condition: ",noSortingFields:"There are no fields specified. You need to specify at least one field to sort by, when calling sort().",filteringNoSchema:"There is no schema / fields specified. You need to specify a schema with field definitions and types to be able to filter the data source."}});
/*
 * Infragistics.Web.ClientUI Data Binding Plugin 12.1.20121.1010
 *
 * Copyright (c) 2011-2012 Infragistics Inc.
 * 
 * igDataSource provides the following functionality:
 * - read and parse local XML , JSON , and HTML data
 * - normalize / transform the above data according to a schema
 * - data type conversion (date, string, number, etc.)
 * - define relationships between two and more flat data sources - with primary/foreign keys, etc
 * - build URL params for requests that get remote data 
 * - in case of scenarios such as paging, understand and prase the response - expect that it's in a predefined format that can be additionall configured by the developer
 * - get data from WCF services  
 * - ability to combine local with remote functionality  
 * - queueing AJAX requests
 *	paging,filtering (searching), and sorting functionality that are control-independent are also implemented here
 *	the idea of this code is to serve as a data-source abstraction layer (client-side data source control)
 *	that may well be used by all other client-side controls , such as dropdown, tree, menu, etc. 
 *
 * http://www.infragistics.com/
 *
 * Depends on:
 *  jquery-1.4.4.js
 *	ig.util.js
 *
 */
}(function($){$.ig=$.ig||{};$.ig.DataSource=$.ig.DataSource||Class.extend({settings:{id:"ds",outputResultsName:null,callback:null,callee:null,data:[],dataSource:null,dataBinding:null,dataBound:null,type:"unknown",schema:null,primaryKey:null,responseTotalRecCountKey:null,responseDataKey:null,responseDataType:null,responseContentType:null,localSchemaTransform:true,urlParamsEncoding:null,urlParamsEncoded:null,paging:{enabled:false,type:"remote",pageSize:5,pageSizeUrlKey:null,pageIndexUrlKey:null,pageIndex:0,appendPage:false},filtering:{type:"remote",caseSensitive:false,applyToAllData:true,customFunc:null,filterExprUrlKey:null,filterLogicUrlKey:"filterLogic",expressions:[],exprString:""},sorting:{defaultDirection:"none",defaultFields:[],applyToAllData:true,customFunc:null,compareFunc:null,customConvertFunc:null,type:"remote",caseSensitive:false,sortUrlKey:null,sortUrlAscValueKey:null,sortUrlDescValueKey:null,expressions:[],exprString:""},summaries:{type:"remote",summaryExprUrlKey:"summaries",summariesResponseKey:"summaries",summaryExecution:"afterfilteringandpaging",columnSettings:[]},fields:[],serializeTransactionLog:true,aggregateTransactions:false,autoCommit:false,updateUrl:null,rowAdded:null,rowUpdated:null,rowInserted:null,rowDeleted:null},init:function(options){var tempSource,tempCallee;if(options){tempSource=options.dataSource;if(tempSource&&($.type(tempSource)==="array"||$.type(tempSource)==="object")){options.dataSource=null;if(options.callee){tempCallee=options.callee;options.callee=null}}this.settings=$.extend(true,{},$.ig.DataSource.prototype.settings,options);if(tempSource&&($.type(tempSource)==="array"||$.type(tempSource)==="object")){options.dataSource=tempSource;this.settings.dataSource=tempSource;if(tempCallee){this.settings.callee=tempCallee;tempCallee=null}}}this.settings.paging.pageIndex=0;this._isBound=false;this._url=null;this._dsCallback=null;this._data=[];this._dataView=[];if(this.settings.type==="unknown"){this._runtimeType=this.analyzeDataSource()}else{this._runtimeType=this.settings.type}this._parser=new $.ig.TypeParser();this._schema=null;this._isSortingReq=false;this._isFilteringReq=false;this._isPagingReq=false;this._isSummariesReq=false;this._dataSummaries=[];this._recCount=0;this._hasCount=false;this._initSchema();this._filteredDataView=[];this._transactionLog=[];this._accumulatedTransactionLog=[];return this},_initSchema:function(){if(this.settings.schema){if(this.settings.schema instanceof $.ig.DataSchema){this._schema=this.settings.schema}else{if(this.settings.type!=="unknown"){this._schema=new $.ig.DataSchema(this.settings.type,this.settings.schema)}else{this._schema=new $.ig.DataSchema(this._runtimeType,this.settings.schema)}}}},fields:function(fields){if(fields===undefined||fields===null){return this.settings.fields}else{this.settings.fields=fields;return this}},analyzeDataSource:function(){var ds=this.dataSource(),$ds,dc;if(ds===undefined||ds===null){return"empty"}else{if($.type(ds)==="function"){return"function"}else{if($.type(ds)==="array"){return"array"}else{if($.type(ds)==="number"||$.type(ds)==="boolean"||$.type(ds)==="date"){return"invalid"}else{if($.type(ds)==="string"){ds=$.trim(ds);if(ds.startsWith("/")){return"remoteUrl"}$ds=$(ds);if($("#"+this.settings.id).length>0&&ds.toLowerCase().startsWith("<table")){return"htmlTableString"}if(ds.toLowerCase().startsWith("<table")){dc="<div id='"+this.settings.id+"' style='display:none;visibility:hidden;'>"+ds+"</div>";$(dc).appendTo($("body"));return"htmlTableString"}if(!ds.startsWith("[")&&!ds.startsWith("{")&&!ds.startsWith("<")){if(!ds.startsWith("http://")&&$("#"+ds).length>0&&$("#"+ds)[0].nodeName.toLowerCase()==="table"){return"htmlTableId"}this._url=ds;return"remoteUrl"}return"unknown"}else{if(ds.nodeName&&ds.nodeName.toLowerCase()==="table"){return"htmlTableDom"}else{if(ds.nodeName&&(ds.nodeName.toLowerCase()==="ul"||ds.nodeName.toLowerCase()==="ol")){return"htmlListDom"}else{return"unknown"}}}}}}}},dataView:function(){return this._dataView},data:function(){return this._data},transformedData:function(transformedExecution){switch(transformedExecution){case"priortofilteringandpaging":this._transformedData=this._data;break;case"afterfilteringbeforepaging":break;case"afterfilteringandpaging":this._transformedData=this.dataView();break;default:this._transformedData=this._dataView;break}return this._transformedData},dataSummaries:function(){var s=this.settings.summaries,type=s.type;if(type==="local"){this._dataSummaries=this.transformedData(s.summaryExecution)}return this._dataSummaries},schema:function(s,t){if(s===undefined||s===null){return this._schema}else{if(s instanceof $.ig.DataSchema){this._schema=s}else{if(t===null||t===undefined){this._schema=new $.ig.DataSchema(s.type,s)}else{this._schema=new $.ig.DataSchema(t,s)}}return this}},pagingSettings:function(p){if(p===undefined||p===null){return this.settings.paging}else{this.settings.paging=p;return this}},filterSettings:function(f){if(f===undefined||f===null){return this.settings.filtering}else{this.settings.filtering=f;return this}},sortSettings:function(s){if(s===undefined||s===null){return this.settings.sorting}else{this.settings.sorting=s;return this}},summariesSettings:function(s){if(s===undefined||s===null){return this.settings.summaries}else{this.settings.summaries=s;return this}},dataSource:function(ds){if(ds===undefined||ds===null){return this.settings.dataSource}else{this.settings.dataSource=ds;this.analyzeDataSource();return this}},type:function(t){if(t===undefined||t===null){return this._runtimeType}else{this.settings.type=t;return this}},findRecordByKey:function(key,ds){var i;if(!ds){for(i=0;i<this._data.length;i++){if(this._data[i][this.settings.primaryKey]===key){return this._data[i]}}}else{for(i=0;i<ds.length;i++){if(ds[i][this.settings.primaryKey]===key){return ds[i]}}}return null},removeRecordByKey:function(key){var i,len,data=this._data,view=this._dataView,filter=this._filteredData,prime=this.settings.primaryKey;while(true){len=data?data.length:0;for(i=0;i<len;i++){if(data[i]&&data[i][prime]===key){$.ig.removeFromArray(data,i);break}}if(data===filter){return}data=(data===view)?filter:view}},removeRecordByIndex:function(index){var i,len,record,data=this._data,view=this._dataView,filter=this._filteredData;if(!data||isNaN(index)||index<0||index>=data.length){return}record=data[index];$.ig.removeFromArray(data,index);data=(data===view)?filter:view;while(record){len=data?data.length:0;for(i=0;i<len;i++){if(data[i]===record){$.ig.removeFromArray(data,i);break}}if(data===filter){return}data=filter}},setCellValue:function(rowId,colId,val,autoCommit){var t=this._createCellTransaction(rowId,colId,val);this._addTransaction(t);if(autoCommit===true){this.commit(rowId)}return t},updateRow:function(rowId,rowObject,autoCommit){var t=this._createRowTransaction(rowId,rowObject),oldRow=(this.settings.primaryKey===null)?this._data[parseInt(rowId,10)]:this.findRecordByKey(rowId),rowIndex=(this.settings.primaryKey===null)?rowId:this._data.indexOf(oldRow);this._addTransaction(t);if(autoCommit===true){this.commit(rowId)}if($.type(this.settings.rowUpdated)==="function"){if(this.settings.callee){this.settings.rowUpdated.apply(this.settings.callee,[{rowIndex:rowIndex,newRow:rowObject,oldRow:oldRow},this])}else{this.settings.rowUpdated({rowIndex:rowIndex,newRow:rowObject,oldRow:oldRow},this)}}return t},addRow:function(rowId,rowObject,autoCommit){var t=this._createNewRowTransaction(rowId,rowObject);this._addTransaction(t);if(autoCommit===true){this.commit(rowId)}if($.type(this.settings.rowAdded)==="function"){if(this.settings.callee){this.settings.rowAdded.apply(this.settings.callee,[{rowId:rowId,row:rowObject},this])}else{this.settings.rowAdded({rowId:rowId,row:rowObject},this)}}return t},insertRow:function(rowId,rowObject,rowIndex,autoCommit){var t=this._createInsertRowTransaction(rowId,rowObject,rowIndex);this._addTransaction(t);if(autoCommit===true){this.commit(rowId)}if($.type(this.settings.rowInserted)==="function"){if(this.settings.callee){this.settings.rowInserted.apply(this.settings.callee,[{rowId:rowId,row:rowObject,rowIndex:rowIndex},this])}else{this.settings.rowInserted({rowId:rowId,row:rowObject,rowIndex:rowIndex},this)}}return t},deleteRow:function(rowId,autoCommit){var t=this._createDeleteRowTransaction(rowId),row=(this.settings.primaryKey===null)?this._data[parseInt(rowId,10)]:this.findRecordByKey(rowId),rowIndex=(this.settings.primaryKey===null)?rowId:this._data.indexOf(row),isNewRow=false,i,j,rowId;for(i=0;this.settings.aggregateTransactions&&i<this._transactionLog.length;i++){if(this._transactionLog[i].type==="newrow"&&this._transactionLog[i].rowId===rowId){isNewRow=true;rowId=this._transactionLog[i].rowId;this._removeTransactionByTransactionId(this._transactionLog[i].tid);for(j=0;j<this._accumulatedTransactionLog.length;j++){if(this._accumulatedTransactionLog[j].rowId===rowId){$.ig.removeFromArray(this._accumulatedTransactionLog,j)}}break}}if(!(this.settings.aggregateTransactions&&isNewRow)){this._addTransaction(t);if(autoCommit===true){this.commit(rowId)}if($.type(this.settings.rowDeleted)==="function"){if(this.settings.callee){this.settings.rowDeleted.apply(this.settings.callee,[{rowId:rowId,row:row,rowIndex:rowIndex},this])}else{this.settings.rowDeleted({rowId:rowId,row:row,rowIndex:rowIndex},this)}}}},getDetachedRecord:function(t){var o=$.type(this._data[0])==="array"?[]:{},i,originalRec;if(this.settings.primaryKey===null){originalRec=this._data[parseInt(t.rowId,10)]}else{originalRec=this.findRecordByKey(t.rowId)}if(this._data[0]!=="array"){for(i in originalRec){if(originalRec.hasOwnProperty(i)){o[i]=originalRec[i]}}}else{for(i=0;i<originalRec.length;i++){o[i]=originalRec[i]}}if(t.type==="cell"){o[t.col]=t.value;return o}else{if(o!=="array"){for(i in t.row){if(t.row.hasOwnProperty(i)){o[i]=t.row[i]}}}else{for(i=0;i<t.row.length;i++){o[i]=t.row[i]}}return o}},commit:function(id){if(id!==null&&id!==undefined){this._commitTransactionsByRowId(id)}else{this._transactionLog.reverse();while(this._transactionLog.length>0){this._commitTransaction(this._transactionLog.pop())}}},rollback:function(id){var i;if(id!==null&&id!==undefined){this._rollbackTransactionsByRowId(id)}else{i=this._transactionLog.length;while(i-->0){this._rollbackTransaction(this._transactionLog[i])}}},pendingTransactions:function(){return this._transactionLog},allTransactions:function(){return this._accumulatedTransactionLog},_createCellTransaction:function(rowId,colId,val){return{type:"cell",rowId:rowId,tid:this._generateTransactionId(),col:colId,value:val}},_createRowTransaction:function(rowId,rowObject){return{type:"row",tid:this._generateTransactionId(),row:rowObject,rowId:rowId}},_createNewRowTransaction:function(rowId,rowObject){return{type:"newrow",tid:this._generateTransactionId(),row:rowObject,rowId:rowId}},_createInsertRowTransaction:function(rowId,rowObject,rowIndex){return{type:"insertrow",tid:this._generateTransactionId(),row:rowObject,rowId:rowId,rowIndex:rowIndex}},_createDeleteRowTransaction:function(rowId){return{type:"deleterow",tid:this._generateTransactionId(),rowId:rowId}},_addTransaction:function(t){var exists=false,i=0,prop,globalt,j,dirty=true,k;if(t.type==="cell"){for(i=0;i<this._transactionLog.length;i++){if(this._transactionLog[i].rowId===t.rowId&&this._transactionLog[i].col===t.col){exists=true;if(this.settings.autoCommit===false&&this.settings.aggregateTransactions===true){for(j=0;j<this.dataView().length;j++){if(this.dataView()[j][this.settings.primaryKey]===t.rowId&&this.dataView()[j][t.col]===t.value){for(k=0;k<this._accumulatedTransactionLog.length;k++){if(this._accumulatedTransactionLog[k].rowId===this._transactionLog[i].rowId){$.ig.removeFromArray(this._accumulatedTransactionLog,k)}}this._removeTransactionByTransactionId(this._transactionLog[i].tid);dirty=false}}}if(dirty){this._transactionLog[i].value=t.value;this._syncGlobalTransaction(this._transactionLog[i])}}}for(j=0;j<this._transactionLog.length;j++){if(this._transactionLog[j].type==="newrow"&&this._transactionLog[j].rowId===t.rowId){if(t.type==="row"){this._transactionLog[j].value=t.value}else{this._transactionLog[j].row[t.col]=t.value}this._syncGlobalTransaction(this._transactionLog[j]);return}}}else{if(t.type==="row"){for(i=0;i<this._transactionLog.length;i++){if(this._transactionLog[i].rowId===t.rowId){exists=true;if(this.settings.autoCommit===false&&this.settings.aggregateTransactions===true){dirty=false;for(j=0;j<this.dataView().length;j++){if(this.dataView()[j][this.settings.primaryKey]===t.rowId){for(prop in t.row){if(t.row.hasOwnProperty(prop)&&t.row[prop]!==this.dataView()[j][prop]){dirty=true;break}}break}}for(j=0,!dirty;j<this._transactionLog.length;j++){if(this._transactionLog[j].type==="newrow"&&this._transactionLog[j].rowId===t.rowId){this._transactionLog[j].row=t.row;this._syncGlobalTransaction(this._transactionLog[j]);return}}}if(dirty){this._transactionLog[i].row=t.row;this._syncGlobalTransaction(this._transactionLog[i])}else{for(k=0;k<this._accumulatedTransactionLog.length;k++){if(this._accumulatedTransactionLog[k].rowId===this._transactionLog[i].rowId){$.ig.removeFromArray(this._accumulatedTransactionLog,k)}}this._removeTransactionByTransactionId(this._transactionLog[i].tid)}}}}}if(!exists){this._transactionLog.push(t);globalt=$.extend(true,{},t);if(globalt.type==="cell"&&$.type(globalt.value)==="date"){globalt.value="/Date("+globalt.value.getTime()+")/"}else{if(globalt.type==="row"||globalt.type==="insertrow"||globalt.type==="newrow"){for(prop in globalt.row){if(globalt.row.hasOwnProperty(prop)&&$.type(globalt.row[prop])==="date"){globalt.row[prop]="/Date("+globalt.row[prop].getTime()+")/"}}}}this._accumulatedTransactionLog.push(globalt)}},_syncGlobalTransaction:function(t){var i,prop;if(!t){return}if(t.type==="cell"){for(i=0;i<this._accumulatedTransactionLog.length;i++){if(this._accumulatedTransactionLog[i].rowId===t.rowId){if($.type(t.value)==="date"){this._accumulatedTransactionLog[i].value="/Date("+t.value.getTime()+")/"}else{this._accumulatedTransactionLog[i].value=t.value}break}}}else{if(t.type==="row"||t.type==="insertrow"||t.type==="newrow"){for(i=0;i<this._accumulatedTransactionLog.length;i++){if(this._accumulatedTransactionLog[i].rowId===t.rowId){for(prop in t.row){if(t.row.hasOwnProperty(prop)){if($.type(t.row[prop])==="date"){this._accumulatedTransactionLog[i].row[prop]="/Date("+t.row[prop].getTime()+")/"}else{this._accumulatedTransactionLog[i].row[prop]=t.row[prop]}}}}}}}},_removeTransactionByTransactionId:function(tid,removeFromAll){var i;for(i=0;i<this._transactionLog.length;i++){if(this._transactionLog[i].tid===tid){$.ig.removeFromArray(this._transactionLog,i);break}}if(removeFromAll===true){for(i=0;i<this._accumulatedTransactionLog.length;i++){if(this._accumulatedTransactionLog[i].tid===tid){$.ig.removeFromArray(this._accumulatedTransactionLog,i);break}}}},_removeTransactionsByRecordId:function(id){var i;for(i=0;i<this._transactionLog.length;i++){if(this._transactionLog[i].rowId===id){$.ig.removeFromArray(this._transactionLog,i);break}}},_addRow:function(row,index){var data=this._data,view=this._dataView,filter=this._filteredData;while(data){if(index>=0&&index<data.length){data.splice(index,0,row)}else{data.push(row)}if(data===filter){return}data=(data===view)?filter:view}},_commitTransaction:function(t){var i,prop,rec,origRec,origDs=this._origDs;if(this.settings.primaryKey===null){rec=this._data[parseInt(t.rowId,10)];if(this.settings.localSchemaTransform===true&&origDs){origRec=origDs[parseInt(t.rowId,10)]}}else{rec=this.findRecordByKey(t.rowId);if(this.settings.localSchemaTransform===true&&origDs){origRec=this.findRecordByKey(t.rowId,origDs)}}if(t.type==="cell"){rec[t.col]=t.value;if(origRec){origRec[t.col]=t.value}}else{if(t.type==="row"){if($.type(t.row)==="array"){for(i=0;i<t.row.length;i++){rec[i]=t.row[i];if(origRec){origRec[i]=t.row[i]}}}else{for(prop in t.row){if(t.row.hasOwnProperty(prop)){rec[prop]=t.row[prop];if(origRec){origRec[prop]=t.row[prop]}}}}}else{if(t.type==="deleterow"){if(this.settings.primaryKey===null){this.removeRecordByIndex(parseInt(t.rowId,10))}else{this.removeRecordByKey(t.rowId)}}else{if(t.type==="newrow"){this._addRow(t.row,-1)}else{if(t.type==="insertrow"){this._addRow(t.row,t.rowIndex)}}}}}this._removeTransactionByTransactionId(t.tid)},_rollbackTransaction:function(t){this._removeTransactionByTransactionId(t.tid,true)},_commitTransactionsByRowId:function(id){var i;for(i=0;i<this._transactionLog.length;i++){if(this._transactionLog[i].rowId===id){this._commitTransaction(this._transactionLog[i])}}},_rollbackTransactionsByRowId:function(id){var i;for(i=0;i<this._transactionLog.length;i++){if(this._transactionLog[i].rowId===id){this._rollbackTransaction(this._transactionLog[i])}}},transactionsAsString:function(){return JSON.stringify(this._accumulatedTransactionLog)},_generateTransactionId:function(){return((1+Math.random())*parseInt("10000",16)).toString(16).substring(1,5)},saveChanges:function(){if(this.settings.updateUrl!==null){var me=this;$.post(this.settings.updateUrl,{ig_transactions:JSON.stringify(this._accumulatedTransactionLog)},function(data,textStatus,jqXHR){me._saveChangesSuccess(data,textStatus,jqXHR)})}},_saveChangesSuccess:function(data,textStatus,jqXHR){if(data.Success){this.commit();this._transactionLog=[];this._accumulatedTransactionLog=[]}var schs=this._saveChangesHandlers,i=schs?schs.length:0;while(i-->0){schs[i](data,textStatus,jqXHR)}},_addChangesSuccessHandler:function(functionDelegate){if(this._saveChangesHandlers===undefined){this._saveChangesHandlers=[]}this._saveChangesHandlers[this._saveChangesHandlers.length]=functionDelegate},_removeChangesSuccessHandler:function(functionDelegate){if(this._saveChangesHandlers!==undefined){var index=this._saveChangesHandlers.indexOf(functionDelegate);if(index>-1){this._saveChangesHandlers=this._saveChangesHandlers.slice(0,index).concat(this._saveChangesHandlers.slice(index+1,this._saveChangesHandlers.length))}}},dataBind:function(callback,callee){var table,tableObj,dsObj,s,p=this.settings,args,ds,resKey,resPath,noCancel=true,i;this._transactionLog=[];this._accumulatedTransactionLog=[];if(!callback){callback=p.callback}args={cancel:false};if($.isFunction(p.dataBinding)){noCancel=p.dataBinding(this,args);if(noCancel===undefined){noCancel=true}}if(noCancel){if(this.settings.type==="unknown"&&(this._runtimeType===null||this._runtimeType===undefined)){this._runtimeType=this.analyzeDataSource()}switch(this._runtimeType){case"function":this._data=p.dataSource();if(this.schema()){this._data=this.schema().transform(this._data)}break;case"array":if(this.schema()&&this.settings.localSchemaTransform){this._data=this.schema().transform(this.dataSource());if(this.dataSource().Metadata){this._metadata=this.dataSource().Metadata}this._origDs=this.dataSource()}else{this._data=this.dataSource()}break;case"htmlTableDom":case"htmlTableId":case"htmlTableString":if(this._tableBound){break}this._runtimeType=this.analyzeDataSource();if(this._runtimeType==="htmlTableId"){tableObj=$("#"+this.dataSource());table=this._validateTable(tableObj)}else{if(this._runtimeType==="htmlTableString"){tableObj=$("#"+this.settings.id+" > table");table=this._validateTable(tableObj)}else{table=this.dataSource()}}if(this.schema()&&this.settings.localSchemaTransform){this._data=this.schema().transform(table)}else{this._data=this.tableToObject(table)}this._tableBound=true;break;case"htmlListDom":this._data=this.schema().transform(this.dataSource());break;case"invalid":throw new Error($.ig.DataSourceLocale.locale.invalidDataSource);case"unknown":case"json":case"xml":if(this.settings.type!=="json"&&p.type!=="xml"){throw new Error($.ig.DataSourceLocale.locale.unknownDataSource)}else{resKey=this.settings.responseDataKey;if($.type(this.dataSource())==="string"){if(p.type==="json"){dsObj=this.stringToJSONObject(this.dataSource())}else{dsObj=this.stringToXmlObject(this.dataSource())}}else{dsObj=this.dataSource()}if(this.schema()&&this.settings.localSchemaTransform===true){this._data=this.schema().transform(dsObj);if(resKey!==null&&resKey!==undefined){this._origDs=this._findPath(dsObj,resKey)}else{this._origDs=dsObj}}else{if((!this.schema()||this.settings.localSchemaTransform===false)&&p.type==="json"){if(resKey!==null&&resKey!==undefined){this._data=this._origDs=this._findPath(dsObj,resKey)}else{this._data=dsObj}this._origDs=dsObj}else{if(!this.schema()&&p.type==="xml"){throw new Error($.ig.DataSourceLocale.locale.errorXmlSourceWithoutSchema)}}}this.totalRecordsCount(null,this.settings.responseTotalRecCountKey,dsObj,this);if(dsObj.Metadata){this._metadata=dsObj.Metadata}this.summariesResponse(this.settings.summaries.summariesResponseKey,dsObj)}break;case"remoteUrl":this._remoteData(callback,callee);break;case"empty":this._data=[];this._dataView=[];this._dataSummaries=[];break;default:break}this._dataView=this._data;this._filter=false;s=p.sorting;if(s.type==="local"&&this._runtimeType!=="remoteUrl"&&s.defaultFields.length>0){this.sort(s.defaultFields,s.defaultDirection,false)}if(p.paging.enabled&&p.paging.type==="local"&&this._runtimeType!=="remoteUrl"){this._page()}ds=this;this._populateTransformedData();if(this._runtimeType!=="remoteUrl"){this._invokeCallback(callee,callback)}if($.isFunction(p.dataBound)&&!args.cancel){p.dataBound(this)}}return this},_findPath:function(dsObj,resKey){var resPath,ds=dsObj;resPath=resKey.split(".");if(resPath.length>0){for(i=0;i<resPath.length;i++){ds=ds[resPath[i]]}}return ds},summariesResponse:function(key,dsObj){var rec,resPath,i;if(key!==null&&key!==""){rec=dsObj;resPath=key.split(".");if(key.length>0){for(i=0;i<resPath.length;i++){rec=rec[resPath[i]]}this._dataSummaries=rec}else{this._dataSummaries=dsObj}if(this._dataSummaries===undefined||this._dataSummaries===null){this._dataSummaries=[]}}},_populateTransformedData:function(data){if(data!==null&&data!==undefined){this._transformedData=data}else{this._transformedData=this._data}},_invokeCallback:function(callee,callback){var cbResolved,calleeResolved;cbResolved=callback||this.settings.callback;calleeResolved=callee||this.settings.callee;if(cbResolved){if(calleeResolved){cbResolved.apply(calleeResolved,[true,"",this])}else{cbResolved(true,"",this)}}},_remoteData:function(callback,callee){var params,url=this.settings.dataSource,dataType=this.settings.responseDataType,contentType=this.settings.responseContentType,options;params=this._encodeUrl();if(callback){this._customCallback=callback}else{this._customCallback=null}this._callee=callee;options={url:url,data:params,dataType:dataType,async:true,context:this,contentType:contentType,cache:false,dataFilter:this._dataFilter,success:this._successCallback,complete:this._completeCallback,error:this._errorCallback};this._processRequest(options)},_dataFilter:function(data,type){var ds,schema=this.context.schema(),rawData,t=this.context.settings.type,ver;if(type===undefined){type="text"}if(type==="xml"){schema._type="xml";ds=this.context._processXmlResponse(data,this.context)}else{if(type==="json"){if(schema){schema._type="json"}if($.type(data)==="string"){rawData=JSON.parse(data)}else{rawData=data}ds=this.context._processJsonResponse(rawData,this.context)}else{if(jQuery.fn.jquery){ver=jQuery.fn.jquery.split(".")}if(ver&&ver.length>=2){if(parseInt(ver[1],10)>4||parseInt(ver[0],10)>1){this.dataTypes=[];this.dataTypes.push("text")}}data=$.type(data)==="string"?$.trim(data):data;if((data&&$.type(data)==="string"&&(data.startsWith("<?xml")||data.startsWith("<")))||t==="xml"){if(schema){schema._type="xml"}ds=this.context._processXmlResponse(this.context.stringToXmlObject(data),false,this.context)}else{if((data&&$.type(data)==="string"&&data.startsWith("["))||(t==="json"||t==="array")){if(schema){schema._type="json"}ds=this.context._processJsonResponse(JSON.parse(data),this.context)}else{if((data&&$.type(data)==="string"&&data.startsWith("{"))||t==="json"){if(schema){schema._type="json"}ds=this.context._processJsonResponse(JSON.parse(data),this.context)}else{if($.isXMLDoc(data)){if(schema){schema._type="xml"}ds=this.context._processXmlResponse(data,true,this.context)}else{if(data!==""&&data!==null){throw new Error($.ig.DataSourceLocale.locale.errorUnrecognizedResponseType)}}}}}}}return ds},_successCallback:function(data){var x;if(data===undefined||data===null){this._data=[];this._dataView=[]}else{if(this._data.length>0&&this.settings.paging&&this.settings.paging.enabled&&this.settings.paging.appendPage){for(x=0;x<data.length;++x){this._data[this._data.length]=data[x]}}else{this._data=data;this._dataView=data}}this._populateTransformedData();this._isPagingReq=false;this._isFilteringReq=false;this._isSortingReq=false;this._isSummariesReq=false},_errorCallback:function(req,status,error){var f=this._customCallback||this.settings.callback,errmsg,statusMsg;this._isPagingReq=false;this._isFilteringReq=false;this._isSortingReq=false;this._isSummariesReq=false;statusMsg=status===null?" ":" ("+status+") ";errmsg=$.ig.DataSourceLocale.locale.errorRemoteRequest+statusMsg+(error!==undefined?error.message:req&&req.statusText?req.statusText:"");if(f&&this._callee){f.apply(this._callee,[false,errmsg,this])}else{if(f){f(false,errmsg,this)}}},_completeCallback:function(req,status){var f,callee,s=this.settings.sorting,p=this.settings.paging;if(s.type==="local"&&s.defaultFields.length>0){this.sort(s.defaultFields,s.defaultDirection,false)}if(p.enabled&&p.type==="local"){this._page()}f=this._customCallback||this.settings.callback;callee=this._callee||this.settings.callee;if(f&&callee){f.apply(callee,[true,"",this])}else{if(f){f(true,"",this)}}},_processRequest:function(options){if(this.settings.responseDataType==="jsonp"){$.getJSON(options.url,options.data,$.proxy(this._jsonpFilter,this))}else{$.ajax(options)}},_jsonpFilter:function(data,type){var resp,x;this.context=this;resp=this._dataFilter(data,"json");if(!resp.length&&$.type(resp)==="object"){resp=[resp]}if(this._data.length>0&&this.settings.paging&&this.settings.paging.enabled&&this.settings.paging.appendPage){for(x=0;x<resp.length;++x){this._data[this._data.length]=resp[x]}}else{this._data=resp;this._dataView=resp}this._populateTransformedData();this._completeCallback()},_processJsonResponse:function(data,context){var ds,schema=context.schema(),resKey,resPath,i;if(this._response_data){this._response_data(data)}if(schema&&schema.fields&&schema.fields().length>0&&this.settings.localSchemaTransform){ds=schema.transform(data)}else{resKey=context.settings.responseDataKey;if(resKey!==null&&resKey!==undefined){resPath=resKey.split(".");if(resPath.length>0){ds=data;for(i=0;i<resPath.length;i++){ds=ds[resPath[i]]}}else{ds=data}}else{ds=data}}if(context._isPagingReq||context._isFilteringReq){this.totalRecordsCount(null,this.settings.responseTotalRecCountKey,data,context)}if(data.Metadata){this._metadata=data.Metadata}this.summariesResponse(this.settings.summaries.summariesResponseKey,data);return ds},_processXmlResponse:function(data,isParsed,context){var ds,schema=context.schema(),tmpSchema,resKey;if(schema&&schema.fields&&schema.fields().length>0){ds=this.settings.localSchemaTransform?schema.transform(data):data}else{resKey=context.settings.responseDataKey;if(resKey&&resKey!==""){tmpSchema=new $.ig.DataSchema();ds=context._xmlToArray(tmpSchema._findXmlRecordsRoot(data,resKey))}else{ds=context._xmlToArray(data)}}return ds},_xmlToArray:function(data){var ds=[],root=data,i,r,j,name,val,o;o=window.ActiveXObject;if(data&&data.childNodes&&data.childNodes.length===1){root=data.childNodes[0]}for(i=0;i<root.childNodes.length;i++){r=root.childNodes[i];ds[i]=[];for(j=0;j<r.childNodes.length;j++){name=o===undefined?r.childNodes[j].localName:r.childNodes[j].baseName;val=o===undefined?r.childNodes[j].textContent:r.childNodes[j].text;ds[i][name]=val}}return ds},_encodeUrl:function(){var props=this.settings,sParams={},fParams={},pParams={},params,args,selParams={},sumParams={},extraParams={},noCancel=true;args={cancel:false};params={sortingParams:sParams,filteringParams:fParams,pagingParams:pParams,selectParams:selParams,summariesParams:sumParams,extraParams:extraParams};if($.isFunction(props.urlParamsEncoding)){noCancel=props.urlParamsEncoding(this,params)}if(noCancel){this._encodeSelectParams(params);this._encodeSortingParams(params);this._encodeFilteringParams(params);this._encodePagingParams(params);this._encodeSummariesParams(params);if($.isFunction(this.settings.encodeExtraParams)){this.settings.encodeExtraParams(this,params)}if($.isFunction(props.urlParamsEncoded)){props.urlParamsEncoded(this,params)}}return $.extend(true,{},params.sortingParams,params.filteringParams,params.pagingParams,params.selectParams,params.summariesParams,params.extraParams)},_encodeSelectParams:function(params){var selParams=params.selectParams,i;if(!this.settings.localSchemaTransform&&this.schema()&&this.schema().fields().length>0){selParams.$select="";for(i=0;i<this.schema().fields().length;i++){if(i!==0){selParams.$select+=","}selParams.$select+=this.schema().fields()[i].name}}else{if(!this.settings.localSchemaTransform&&this.schema()&&this.schema().fields().length===0){selParams.$select="*"}}},_encodePagingParams:function(params){var p=this.settings.paging;if(p.enabled&&p.type==="remote"){this._isPagingReq=true;if(p.pageIndexUrlKey!==null&&p.pageSizeUrlKey!==null){params.pagingParams[p.pageIndexUrlKey]=this.pageIndex();params.pagingParams[p.pageSizeUrlKey]=this.pageSize()}else{params.pagingParams.$skip=this.pageIndex()*this.pageSize();params.pagingParams.$top=this.pageSize();params.pagingParams.$inlinecount="allpages";if(this.settings.responseTotalRecCountKey===null){this.settings.responseTotalRecCountKey="d.__count"}}}},_encodeSortingParams:function(params){var s=this.settings.sorting,tmpdir,i,sfields,hlayout=null;if(s.type==="remote"){if(s.exprString){sfields=this._parseSortExpressions(s.exprString)}else{sfields=s.expressions}this._isSortingReq=true;for(i=0;i<sfields.length;i++){if(sfields[i].layout){hlayout=sfields[i].layout}if(s.sortUrlAscValueKey!==null&&s.sortUrlDescValueKey!==null&&s.sortUrlKey!==null){tmpdir=(sfields[i].dir&&sfields[i].dir.toLowerCase().startsWith("asc"))?s.sortUrlAscValueKey:s.sortUrlDescValueKey;params.sortingParams[s.sortUrlKey+"("+sfields[i].fieldName+")"]=tmpdir}else{if(params.sortingParams.$orderby===undefined){params.sortingParams.$orderby=""}params.sortingParams.$orderby=params.sortingParams.$orderby+sfields[i].fieldName+" "+sfields[i].dir.toLowerCase();if(i<sfields.length-1){params.sortingParams.$orderby+=","}}}if(hlayout){params.sortingParams.layout=hlayout}}},_encodeFilteringParams:function(params){var f=this.settings.filtering,ffields,i,key,exprNotReq,cond,d;if(f.type==="remote"){if(f.exprString){ffields=this._parseFilterExprString(f.exprString)}else{ffields=f.expressions}for(i=0;i<ffields.length;i++){this._isFilteringReq=true;cond=ffields[i].cond;exprNotReq=cond==="false"||cond==="true"||cond==="today"||cond==="yesterday"||cond==="thisMonth"||cond==="lastMonth"||cond==="nextMonth"||cond==="thisYear"||cond==="lastYear"||cond==="nextYear"||cond==="null"||cond==="notNull"||cond==="empty"||cond==="notEmpty";if(f.filterExprUrlKey!==null){key=f.filterExprUrlKey+"("+ffields[i].fieldName+")";if($.type(ffields[i].expr)==="date"){d=Date.UTC(ffields[i].expr.getFullYear(),ffields[i].expr.getMonth(),ffields[i].expr.getDate(),ffields[i].expr.getHours(),ffields[i].expr.getMinutes())}else{d=ffields[i].expr}if(params.filteringParams[key]===undefined){params.filteringParams[key]=ffields[i].cond+"("+(exprNotReq?"":d)+")"}else{params.filteringParams[key]=params.filteringParams[key]+","+ffields[i].cond+"("+(exprNotReq?"":d)+")"}}else{if(params.filteringParams.$filter===undefined){params.filteringParams.$filter=""}if(ffields[i].cond==="startsWith"){params.filteringParams.$filter+="startswith("+ffields[i].fieldName+",'"+ffields[i].expr+"') eq true"}else{if(ffields[i].cond==="endsWith"){params.filteringParams.$filter+="endswith("+ffields[i].fieldName+",'"+ffields[i].expr+"') eq true"}else{if(ffields[i].cond==="contains"){params.filteringParams.$filter+="indexof("+ffields[i].fieldName+",'"+ffields[i].expr+"') ge 0"}else{if(ffields[i].cond==="doesNotContain"){params.filteringParams.$filter+="indexof("+ffields[i].fieldName+",'"+ffields[i].expr+"') eq -1"}else{if(ffields[i].cond==="equals"){if($.type(ffields[i].expr)==="string"){params.filteringParams.$filter+=ffields[i].fieldName+" eq '"+ffields[i].expr+"'"}else{params.filteringParams.$filter+=ffields[i].fieldName+" eq "+ffields[i].expr}}else{if(ffields[i].cond==="true"){params.filteringParams.$filter+=ffields[i].fieldName+" eq true"}else{if(ffields[i].cond==="false"){params.filteringParams.$filter+=ffields[i].fieldName+" eq false"}else{if(ffields[i].cond==="doesNotEqual"){if($.type(ffields[i].expr)==="string"){params.filteringParams.$filter+=ffields[i].fieldName+" ne '"+ffields[i].expr+"'"}else{params.filteringParams.$filter+=ffields[i].fieldName+" ne "+ffields[i].expr}}else{if(ffields[i].cond==="greaterThan"){params.filteringParams.$filter+=ffields[i].fieldName+" gt "+ffields[i].expr}else{if(ffields[i].cond==="lessThan"){params.filteringParams.$filter+=ffields[i].fieldName+" lt "+ffields[i].expr}else{if(ffields[i].cond==="greaterThanOrEqualTo"){params.filteringParams.$filter+=ffields[i].fieldName+" ge "+ffields[i].expr}else{if(ffields[i].cond==="lessThanOrEqualTo"){params.filteringParams.$filter+=ffields[i].fieldName+" le "+ffields[i].expr}else{if(ffields[i].cond==="null"){params.filteringParams.$filter+=ffields[i].fieldName+" eq null"}else{if(ffields[i].cond==="notNull"){params.filteringParams.$filter+=ffields[i].fieldName+" ne null"}else{if(ffields[i].cond==="empty"){params.filteringParams.$filter+="length("+ffields[i].fieldName+") eq 0"}else{if(ffields[i].cond==="notEmpty"){params.filteringParams.$filter+="length("+ffields[i].fieldName+") gt 0"}}}}}}}}}}}}}}}}if(i<ffields.length-1){params.filteringParams.$filter+=" and "}}}if(f.filterLogicUrlKey!==null&&ffields.length>0){params.filteringParams[f.filterLogicUrlKey]=ffields[0].logic}}},_encodeSummariesParams:function(params){var i,j,s=this.settings.summaries,cs=s.columnSettings,methodsStr,csLength=cs.length;if(s.type==="remote"){for(i=0;i<csLength;i++){methodsStr="";if(cs[i].summaryOperands===undefined||cs[i].summaryOperands===null){continue}for(j=0;j<cs[i].summaryOperands.length;j++){if(cs[i].summaryOperands[j].active===true||cs[i].summaryOperands[j].active===1){methodsStr+=cs[i].summaryOperands[j].type+","}}if(methodsStr!==""){params.summariesParams[s.summaryExprUrlKey+"("+cs[i].columnKey+")"]=methodsStr.slice(0,-1)}}}},_page:function(keepRecords){var count=0,startIndex,endIndex,i=0;if(keepRecords===undefined){keepRecords=false}if(keepRecords){count=this._dataView.length}else{this._dataView=[]}if(!this._filter){startIndex=this.pageIndex()*this.pageSize();endIndex=startIndex+this.pageSize()>=this._data.length?this._data.length:startIndex+this.pageSize();for(i=startIndex;i<endIndex;i++){this._dataView[count++]=this._data[i]}}else{startIndex=this.pageIndex()*this.pageSize();endIndex=startIndex+this.pageSize()>=this._filteredData.length?this._filteredData.length:startIndex+this.pageSize();for(i=startIndex;i<endIndex;i++){this._dataView[count++]=this._filteredData[i]}}},sort:function(fields,direction,keepSortState){var s=this.settings.sorting,schema,sortF,convertFunc,p=this.settings.paging,data,resetPaging=false,settings=this.settings;if(fields===undefined||fields===null){throw new Error($.ig.DataSourceLocale.locale.noSortingFields)}sortF=function(fields,schema,reverse,convertf){reverse=(reverse)?-1:1;function compareVals(x,y){if((x===null||x===undefined)&&(y===null||y===undefined)){return 0}else{if((x===null||x===undefined)&&y!==null&&y!==undefined){return -1}else{if(x!==null&&x!==undefined&&(y===null||y===undefined)){return 1}else{return x>y?1:x<y?-1:0}}}}return function(obj1,obj2){var i,f,arr1=[],arr2=[],a,b;for(i=0;i<fields.length;i++){if(fields[i].layout&&((settings.key&&settings.key!==fields[i].layout)||!settings.key)){continue}f=fields[i];if(f.fieldIndex>=0){f.fieldName=f.fieldIndex}a=obj1[f.fieldName];b=obj2[f.fieldName];if(convertf!==undefined){a=convertf(a,f.fieldName);b=convertf(b,f.fieldName)}if(s.caseSensitive===false){if(a!==undefined&&a!==null&&a.toLowerCase){a=a.toLowerCase()}if(b!==undefined&&b!==null&&b.toLowerCase){b=b.toLowerCase()}}if(f.dir!==undefined&&f.dir!==null){reverse=f.dir.toLowerCase().startsWith("desc");reverse=(reverse)?-1:1}else{if(direction!==undefined&&direction!==null&&direction!==""){reverse=direction.toLowerCase().startsWith("desc");reverse=(reverse)?-1:1}}if(fields.length===1){arr1=reverse*compareVals(a,b);arr2=reverse*compareVals(b,a)}else{if(reverse===-1){arr1.push(-compareVals(a,b));arr2.push(-compareVals(b,a))}else{arr1.push(compareVals(a,b));arr2.push(compareVals(b,a))}}}if(arr1<arr2){return -1}else{if(arr1>arr2){return 1}}return 0}};if(s.applyToAllData&&s.type==="local"){if(this._filter&&((p.type==="local"&&p.enabled===true)||p.enabled===false)){data=this._filteredData}else{data=this.data()}resetPaging=true}else{data=this.dataView()}if($.type(s.customFunc)==="function"){data=s.customFunc(data,fields,direction)}else{schema=this.settings.schema;if(!direction){direction=""}if($.type(s.compareFunc)==="function"){sortF=s.compareFunc}if($.isFunction(s.customConvertFunc)){convertFunc=s.customConvertFunc}if($.type(fields)==="string"){fields=this._parseSortExpressions(fields)}if(fields.length>0){data=data.sort(sortF(fields,schema,direction.toLowerCase().startsWith("asc")?false:true,convertFunc))}}if(resetPaging&&p.type==="local"){if(!this._filter){this._data=data}else{this._filteredData=data}this._page()}else{this._dataView=data}this._populateTransformedData(data);return this},clearLocalSorting:function(){var s=this.settings.sorting,p=this.settings.paging,data,resetPaging=false;if(s.applyToAllData&&s.type==="local"){if(this._filter&&((p.type==="local"&&p.enabled===true)||p.enabled===false)){data=this._filteredData}else{data=this.data()}resetPaging=true}else{data=this.dataView()}if(resetPaging&&p.type==="local"){if(!this._filter){this._data=data}else{this._filteredData=data}this._page()}else{this._dataView=data}this._populateTransformedData();return this},_parseSortExpressions:function(s){var fields=[],tmp,tmp2,i;tmp=s.split(",");for(i=0;i<tmp.length;i++){fields[i]={};tmp2=$.trim(tmp[i]).split(" ");fields[i].fieldName=tmp2[0];fields[i].dir=tmp2[1]}return fields},_convertf:function(val,type){},filter:function(fieldExpressions,boolLogic,keepFilterState,fieldExpressionsOnStrings){var i,j,expr=null,count=0,skipRec=false,f=this.settings.filtering,p=this.settings.paging,data,t,k,schema,fields,tmpbool,resetPaging,allFieldsExpr,stringVal;schema=this.schema();if(schema===null||schema===undefined){throw new Error($.ig.DataSourceLocale.locale.filteringNoSchema)}if($.type(fieldExpressions)==="string"){expr=fieldExpressions}if($.type(fieldExpressionsOnStrings)==="string"){allFieldsExpr=fieldExpressionsOnStrings}else{if($.type(fieldExpressionsOnStrings)==="undefined"){fieldExpressionsOnStrings=[]}}if($.type(fieldExpressions)==="array"&&fieldExpressions.length===0&&$.type(fieldExpressionsOnStrings)==="array"&&fieldExpressionsOnStrings.length===0){return}if(f.applyToAllData&&f.type==="local"){data=this.data();resetPaging=true}else{if(this._cachedDataView&&this._cachedDataView.length>0){data=this._cachedDataView}else{this._cachedDataView=$.merge([],this.dataView());data=this._cachedDataView}}if($.type(f.customFunc)==="function"){data=f.customFunc(fieldExpressions,data);this._filteredData=data;this._dataView=[]}else{this._dataView=[];this._filteredData=[];for(i=0;i<data.length;i++){skipRec=false;if(expr){fieldExpressions=this._parseFilterExprString(expr)}if(allFieldsExpr){fieldExpressionsOnStrings=this._parseFilterExprString(allFieldsExpr)}for(j=0;j<fieldExpressions.length;j++){fields=schema.fields();if(fieldExpressions[j].fieldIndex){if(fieldExpressions[j].fieldIndex<fields.length){t=fields[fieldExpressions[j].fieldIndex].type}skipRec=!this._findMatch(data[i][fieldExpressions[j].fieldIndex],fieldExpressions[j].expr,t,!f.caseSensitive,fieldExpressions[j].cond)}else{for(k=0;k<fields.length;k++){if(fields[k].name===fieldExpressions[j].fieldName){t=fields[k].type;break}}skipRec=!this._findMatch(data[i][fieldExpressions[j].fieldName],fieldExpressions[j].expr,t,!f.caseSensitive,fieldExpressions[j].cond)}tmpbool=(fieldExpressions[j].logic!==null&&fieldExpressions[j].logic!==undefined&&(fieldExpressions[j].logic.toLowerCase()==="or"||fieldExpressions[j].logic.toLowerCase()==="and"))?fieldExpressions[j].logic:boolLogic;if(tmpbool===undefined||tmpbool===null||$.type(tmpbool)!=="string"){tmpbool="and"}if(skipRec&&tmpbool.toLowerCase()==="and"){break}else{if(!skipRec&&tmpbool.toLowerCase()==="or"){break}}}if(!skipRec){for(j=0;j<fieldExpressionsOnStrings.length;j++){fields=schema.fields();if(fieldExpressionsOnStrings[j].fieldIndex){if(fieldExpressionsOnStrings[j].fieldIndex<fields.length){t=fields[fieldExpressionsOnStrings[j].fieldIndex].type}stringVal=data[i][fieldExpressionsOnStrings[j].fieldIndex]?data[i][fieldExpressionsOnStrings[j].fieldIndex].toString():"";skipRec=!this._findMatch(stringVal,fieldExpressionsOnStrings[j].expr,"string",!f.caseSensitive,fieldExpressionsOnStrings[j].cond)}else{for(k=0;k<fields.length;k++){if(fields[k].name===fieldExpressionsOnStrings[j].fieldName){t=fields[k].type;break}}stringVal=data[i][fieldExpressionsOnStrings[j].fieldName]?data[i][fieldExpressionsOnStrings[j].fieldName].toString():"";skipRec=!this._findMatch(stringVal,fieldExpressionsOnStrings[j].expr,"string",!f.caseSensitive,fieldExpressionsOnStrings[j].cond)}tmpbool=(fieldExpressionsOnStrings[j].logic!==null&&fieldExpressionsOnStrings[j].logic!==undefined&&(fieldExpressionsOnStrings[j].logic.toLowerCase()==="or"||fieldExpressionsOnStrings[j].logic.toLowerCase()==="and"))?fieldExpressionsOnStrings[j].logic:boolLogic;if(tmpbool===undefined||tmpbool===null||$.type(tmpbool)!=="string"){tmpbool="and"}if(skipRec&&tmpbool.toLowerCase()==="and"){break}else{if(!skipRec&&tmpbool.toLowerCase()==="or"){break}}}}if(!skipRec){this._filteredData[count++]=data[i]}}}this._filter=true;if(resetPaging&&p.type==="local"&&p.enabled===true){this.settings.paging.pageIndex=0;this.pageSizeDirty(true);this._page()}else{for(i=0;i<this._filteredData.length;i++){this._dataView[i]=this._filteredData[i]}}this._populateTransformedData(this._filteredData);return this},clearLocalFilter:function(){var i,f=this.settings.filtering,p=this.settings.paging,data,resetPaging;if(f.applyToAllData&&f.type==="local"){data=this.data();resetPaging=true}else{if(this._cachedDataView&&this._cachedDataView.length>0){data=this._cachedDataView}else{this._cachedDataView=$.merge([],this.dataView());data=this._cachedDataView}}this._dataView=[];this._filteredData=data;if(resetPaging&&p.type==="local"&&p.enabled===true){this._filter=true;this.settings.paging.pageIndex=0;this.pageSizeDirty(true);this._page()}else{if(p.enabled===false){this._filter=true}for(i=0;i<this._filteredData.length;i++){this._dataView[i]=this._filteredData[i]}}this._populateTransformedData(this._filteredData);return this},_parseFilterExprString:function(expr){var exprs=$.trim(expr).split(/(?=AND+)|(?=OR+)/i),i,j,fields=[],tmp,tmp2,isInvalid=true;for(i=0;i<exprs.length;i++){fields[i]={};tmp=$.trim(exprs[i]).split(/(?= \=+)|(?=<>+)|(?=>+)|(?=<+)|(?=LIKE+)|(?=NOT\WLIKE)+|(?=>\=+)|(?=<\=+)/);if($.trim(exprs[i]).toLowerCase().startsWith("and")){fields[i].logic="AND"}else{if($.trim(exprs[i]).toLowerCase().startsWith("or")){fields[i].logic="OR"}}if(i>0&&(fields[i].logic==="AND"||fields[i].logic==="OR")){fields[i-1].logic=fields[i].logic}if(tmp[0].toLowerCase().startsWith("and")||tmp[0].toLowerCase().startsWith("or")){fields[i].fieldName=$.trim(tmp[0].split(" ")[1])}else{fields[i].fieldName=$.trim(tmp[0])}tmp2=$.trim(tmp[1]).split(" ");if(exprs[i].indexOf("<>")!==-1){tmp2[0]="<>";tmp2[1]=tmp[2].replace(">","")}if(tmp2.length>2){for(j=2;j<tmp2.length;j++){tmp2[1]=tmp2[1]+" "+tmp2[j]}tmp2=[tmp2[0],tmp2[1]]}if(tmp[1].startsWith("NOT")){fields[i].expr=$.trim(tmp[2].replace("LIKE",""))}else{fields[i].expr=tmp2[1]}for(j=0;j<this.schema().schema.fields.length;j++){if(this.schema().schema.fields[j].name===fields[i].fieldName){isInvalid=false;break}}if(isInvalid){throw new Error($.ig.DataSourceLocale.locale.fieldMismatch+fields[i].fieldName)}isInvalid=true;if(tmp2[0]===">"){fields[i].cond="greaterThan"}else{if(tmp2[0]==="LIKE"){if(fields[i].expr.startsWith("%")&&fields[i].expr.endsWith("%")){fields[i].cond="contains"}else{if(fields[i].expr.endsWith("%")){fields[i].cond="startsWith"}else{if(fields[i].expr.startsWith("%")){fields[i].cond="endsWith"}else{fields[i].cond="equals"}}}fields[i].expr=fields[i].expr.replace(/%/g,"")}else{if(tmp2[0]==="NOT LIKE"||tmp2[0]==="NOT"){if(fields[i].expr.startsWith("%")&&fields[i].expr.endsWith("%")){fields[i].cond="doesNotContain"}else{fields[i].cond="doesNotEqual"}fields[i].expr=fields[i].expr.replace(/%/g,"")}else{if(tmp2[0]==="="){fields[i].cond="equals"}else{if(tmp2[0]==="<>"){fields[i].cond="doesNotEqual"}else{if(tmp2[0]==="<"){fields[i].cond="lessThan"}else{if(tmp2[0]==="<="){fields[i].cond="lessThanOrEqualTo"}else{if(tmp2[0]===">="){fields[i].cond="greaterThanOrEqualTo"}else{throw new Error($.ig.DataSourceLocale.locale.unrecognizedCondition+expr)}}}}}}}}}return fields},_findMatch:function(val,expr,t,ignoreCase,cond){var tmpExpr,exprNotReq=cond==="false"||cond==="true"||cond==="today"||cond==="yesterday"||cond==="thisMonth"||cond==="lastMonth"||cond==="nextMonth"||cond==="thisYear"||cond==="lastYear"||cond==="nextYear"||cond==="null"||cond==="notNull"||cond==="empty"||cond==="notEmpty";if(expr===""&&!exprNotReq){return true}tmpExpr=$.trim(expr);if(t==="regexp"||(t==="string"&&tmpExpr.startsWith("/")&&tmpExpr.endsWith("/"))){if(t==="regexp"){return this._findRegExpMatch(val,expr,false)}else{return this._findRegExpMatch(val,tmpExpr.substring(1,tmpExpr.length-1),true)}}else{if(($.type(val)==="date"&&(t===undefined||t===null))||t==="date"){try{expr=this._parser.toDate(expr)}catch(e){}return this._findDateMatch(val,expr,cond)}else{if(($.type(val)==="boolean"&&(t===undefined||t===null))||(t==="boolean"||t==="bool")){return this._findBoolMatch(val,cond)}else{if(($.type(val)==="number"&&(t===undefined||t===null))||t==="number"){return this._findNumericMatch(val,expr,cond)}else{return this._findStringMatch(val,expr,ignoreCase,cond)}}}}},_findStringMatch:function(val,expr,ignoreCase,cond){var localVal;if(val!==null&&val!==undefined){localVal=ignoreCase?val.toLowerCase():val||""}else{localVal=val}if(expr!==null&&expr!==undefined){expr=ignoreCase?expr.toLowerCase():expr}if(cond==="startsWith"){return localVal!==null&&localVal!==undefined&&localVal.startsWith(expr)}else{if(cond==="endsWith"){return localVal!==null&&localVal!==undefined&&localVal.endsWith(expr)}else{if(cond==="contains"){return localVal!==null&&localVal!==undefined&&localVal.indexOf(expr)!==-1}else{if(cond==="doesNotContain"){return localVal!==null&&localVal!==undefined&&localVal.indexOf(expr)===-1}else{if(cond==="equals"){return localVal!==null&&localVal!==undefined&&localVal===expr}else{if(cond==="doesNotEqual"){return localVal!==null&&localVal!==undefined&&localVal!==expr}else{if(cond==="null"){return localVal===null}else{if(cond==="notNull"){return localVal!==null}else{if(cond==="empty"){return localVal===null||localVal===undefined||localVal.length===0}else{if(cond==="notEmpty"){return localVal===null||localVal===undefined||localVal.length!==0}else{throw new Error($.ig.DataSourceLocale.locale.errorUnrecognizedFilterCondition+cond)}}}}}}}}}}},_findRegExpMatch:function(val,expr,str){if(str){return(new RegExp(expr)).test(val)}else{return val.match(expr)}},_findNumericMatch:function(val,expr,cond){if($.type(expr)!=="number"){expr=this._parser.toNumber(expr)}if(cond==="equals"){return val===expr}else{if(cond==="doesNotEqual"){return val!==expr}else{if(cond==="greaterThan"){return val>expr}else{if(cond==="lessThan"){return val<expr}else{if(cond==="greaterThanOrEqualTo"){return val>=expr}else{if(cond==="lessThanOrEqualTo"){return val<=expr}else{if(cond==="null"){return val===null}else{if(cond==="notNull"){return val!==null}else{if(cond==="empty"){return(val===null||val===undefined||isNaN(val))}else{if(cond==="notEmpty"){return(val!==null&&val!==undefined&&!isNaN(val))}else{throw new Error($.ig.DataSourceLocale.locale.errorUnrecognizedFilterCondition+cond)}}}}}}}}}}},_findBoolMatch:function(val,cond){if(cond==="true"){return val}else{if(cond==="false"){return !val}else{if(cond==="null"){return val===null}else{if(cond==="notNull"){return val!==null}else{if(cond==="empty"){return(val===null||val===undefined)}else{if(cond==="notEmpty"){return(val!==null&&val!==undefined)}else{throw new Error($.ig.DataSourceLocale.locale.errorUnrecognizedFilterCondition+cond)}}}}}}},_findDateMatch:function(val,expr,cond){var day1,mins1,secs1,hs1,ms1,yrs1,day2,mins2,secs2,hs2,ms2,yrs2,month1,month2,eq,cur,day3,mins3,secs3,hs3,ms3,yrs3,month3,mday1,mday2,mday3;if(val!==null&&val!==undefined){day1=val.getDay();mday1=val.getDate();mins1=val.getMinutes();secs1=val.getSeconds();hs1=val.getHours();ms1=val.getMilliseconds();yrs1=val.getYear();month1=val.getMonth()}if($.type(expr)==="date"){day2=expr.getDay();mday2=expr.getDate();mins2=expr.getMinutes();secs2=expr.getSeconds();hs2=expr.getHours();ms2=expr.getMilliseconds();yrs2=expr.getYear();month2=expr.getMonth()}else{expr=new Date(expr)}cur=new Date();day3=cur.getDay();mday3=cur.getDate();mins3=cur.getMinutes();secs3=cur.getSeconds();hs3=cur.getHours();ms3=cur.getMilliseconds();yrs3=cur.getYear();month3=cur.getMonth();eq=day1===day2&&mins1===mins2&&hs1===hs2&&yrs1===yrs2&&month1===month2;if(cond==="equals"){return eq}else{if(cond==="doesNotEqual"){return !eq}else{if(cond==="before"){return val<expr}else{if(cond==="after"){return val>expr}else{if(cond==="today"){return mday1===mday3&&month1===month3&&yrs1===yrs3}else{if(cond==="yesterday"){return mday1===mday3-1&&month1===month3&&yrs1===yrs3}else{if(cond==="thisMonth"){return month1===month3&&yrs1===yrs3}else{if(cond==="lastMonth"){if(month3===0){return month1===11&&yrs1===yrs3-1}return month1===month3-1&&yrs1===yrs3}else{if(cond==="nextMonth"){if(month3===11){return month1===0&&yrs1===yrs3+1}return month1===month3+1&&yrs1===yrs3}else{if(cond==="thisYear"){return yrs1===yrs3}else{if(cond==="lastYear"){return yrs1===yrs3-1}else{if(cond==="nextYear"){return yrs1===yrs3+1}else{if(cond==="on"){return yrs1===yrs2&&month1===month2&&mday1===mday2}else{if(cond==="notOn"){return !(yrs1===yrs2&&month1===month2&&mday1===mday2)}else{if(cond==="null"){return val===null}else{if(cond==="notNull"){return val!==null}else{if(cond==="empty"){return(val===null||val===undefined)}else{if(cond==="notEmpty"){return(val!==null&&val!==undefined)}else{throw new Error($.ig.DataSourceLocale.locale.errorUnrecognizedFilterCondition+cond)}}}}}}}}}}}}}}}}}}},totalRecordsCount:function(count,key,dsObj,context){var rec,totalRecPath,i;if(context!==undefined&&context!==null){if(key){totalRecPath=key.split(".");rec=dsObj;for(i=0;i<totalRecPath.length;i++){rec=rec[totalRecPath[i]]}if(dsObj&&rec!==undefined&&rec!==null){if($.type(rec)==="number"){this._recCount=rec}else{this._recCount=parseInt(rec,10)}this.hasTotalRecordsCount(true)}else{this.hasTotalRecordsCount(false)}}else{this.hasTotalRecordsCount(false)}}else{if(count===undefined||count===null){return this._recCount}else{this._recCount=count}}},hasTotalRecordsCount:function(hasCount){if(hasCount===undefined||hasCount===null){return this._hasCount}else{this._hasCount=hasCount}},metadata:function(key){if(key===null||key===undefined||key===""||this._metadata===null||this._metadata===undefined){return this._metadata}return this._metadata[key]},totalLocalRecordsCount:function(){if(!this._filter){return this._data.length}else{return this._dataView.length}},pageCount:function(){var c,realCount;if(!this._filter){realCount=this.totalRecordsCount()>0?this.totalRecordsCount():this._data.length}else{realCount=this.totalRecordsCount()>0?this.totalRecordsCount():this._filteredData.length}c=Math.ceil(realCount/this.settings.paging.pageSize);return c===0?1:c},pageIndex:function(index){if(index===undefined||index===null){return this.settings.paging.pageIndex===undefined?0:this.settings.paging.pageIndex}else{this.settings.paging.pageIndex=parseInt(index,10);this._cachedDataView=null;if(this.settings.paging.type==="local"){this._page(this.settings.paging.appendPage);this._invokeCallback()}else{this.dataBind()}return this}},prevPage:function(){this.pageIndex(this.pageIndex()===0?0:this.pageIndex()-1);return this},nextPage:function(){if(this.pageIndex()>=this.pageCount()-1){return this}this.pageIndex(this.pageIndex()+1);return this},pageSize:function(s){if(s===undefined||s===null){return this.settings.paging.pageSize}else{this.settings.paging.pageSize=parseInt(s,10);if(this.settings.paging.appendPage){this.settings.paging.pageIndex=0;this._cachedDataView=null}if(this.settings.paging.type==="local"){this._page();this._invokeCallback()}else{this.dataBind()}return this}},pageSizeDirty:function(dirty){if(dirty===undefined||dirty===null){return this._dirty}else{this._dirty=dirty}},recordsForPage:function(p){var d=[],si,ps,ei,i,c=0;ps=this.pageSize();si=p*ps;ei=si+ps>=this._data.length?this._data.length:si+ps;for(i=si;i<ei;i++){d[c++]=this._data[i]}return d},tableToObject:function(tableDOM){try{var rows=$(tableDOM).children("tbody").children(),len,data,i,j;len=rows.length>0?rows[0].cells.length:0;data=[];for(i=0;i<rows.length;i++){data[i]=[];for(j=0;j<len;j++){data[i][j]=rows[i].cells[j].innerHTML}}return data}catch(e){throw new Error($.ig.DataSourceLocale.locale.errorParsingHtmlTableNoSchema+e.message)}},_validateTable:function(obj){if(obj.length===0){throw new Error($.ig.DataSourceLocale.locale.errorTableWithIdNotFound+this.dataSource())}else{return obj[0]}},stringToJSONObject:function(s){var data={};try{data=JSON.parse(s)}catch(e){throw new Error($.ig.DataSourceLocale.locale.errorParsingJsonNoSchema+e.message)}return data},stringToXmlObject:function(s){var doc,parser;try{if(window.ActiveXObject){doc=new ActiveXObject("Microsoft.XMLDOM");doc.async="false";doc.loadXML(s)}else{parser=new DOMParser();doc=parser.parseFromString(s,"text/xml")}}catch(e){throw new Error($.ig.DataSourceLocale.locale.errorParsingXmlNoSchema+e.message)}return doc}});$.ig.TypeParser=$.ig.TypeParser||Class.extend({toStr:function(obj){return this.isNullOrUndefined(obj)?"":obj+this.empty()},toDate:function(obj){if(this.isNullOrUndefined(obj)||$.type(obj)==="function"){return null}else{if($.type(obj)==="date"){return obj}else{if(obj.length&&obj.indexOf("/Date(")!==-1){if(this._tzo===undefined){this._tzo=new Date().getTimezoneOffset()*60000}if(this._dst===undefined){this._dst=new Date().dst();if(this._dst){this._tzo=new Date().stdTimezoneOffset()*60000}}return new Date(parseInt(obj.replace("/Date(","").replace(")/",""),10)+this._serverOffset)}else{return new Date(obj)}}}},toNumber:function(obj){return(this.isNullOrUndefined(obj)||$.type(obj)==="function")?null:obj*this.num()},toBool:function(obj){if($.type(obj)==="boolean"){return obj}else{if(this.isNullOrUndefined(obj)||$.type(obj)==="function"){return false}else{if(obj==="1"||obj.toLowerCase()==="true"||obj===1){return true}else{return false}}}},isNullOrUndefined:function(obj){return obj===null||obj===undefined},empty:function(){return""},num:function(){return 1}});$.ig.DataSchema=$.ig.DataSchema||Class.extend({schema:{fields:[],searchField:null,outputResultsName:null},init:function(type,options){if(options){this.schema=$.extend(true,{},$.ig.DataSchema.prototype.schema,options)}this._type=type;this._parser=new $.ig.TypeParser();this._parser._serverOffset=0},transform:function(data){var ndata=[];switch(this._type){case"array":ndata=this._arrays(data);break;case"json":ndata=this._json(data);break;case"xml":ndata=this._xml(data);break;case"htmlTableDom":ndata=this._table(data);break;case"htmlListDom":ndata=this._list(data);break;default:throw new Error("unknown data source type: "+this._type)}return ndata},_setResKey:function(resKey,out){if(!this.isEmpty(resKey)){out[resKey]=[];return out[resKey]}else{return out}},_convertType:function(t,obj){if(t==="string"){return this._parser.toStr(obj)}else{if(t==="date"){return this._parser.toDate(obj)}else{if(t==="number"){return this._parser.toNumber(obj)}else{if(t==="boolean"||t==="bool"){return this._parser.toBool(obj)}else{return obj}}}}},_val:function(field,val,results,i,rec){var t=field.type,j;if(!this.isEmpty(t)){if(this.isEmpty(field.name)){results[i][j]=this._convertType(t,val)}else{results[i][field.name]=this._convertType(t,val)}}else{if(this.isEmpty(field.name)){if(rec){results[i][j]=rec[i][j]}else{results[i][j]=val}}else{if(rec){results[i][field.name]=rec[i][field.name]}else{results[i][field.name]=val}}}},isEmpty:function(o){return o===undefined||o===null||o===""},_arrays:function(data){var i,j,tmp,hasArrays,resKey=this.schema.outputResultsName,out={},results;results=this._setResKey(resKey,out);if(this.isObjEmpty(results)&&$.type(results)!=="array"){results=[];out=results}try{if(data.length>0){hasArrays=$.type(data[0])==="array"}for(i=0;i<data.length;i++){results[i]={};for(j=0;j<this.schema.fields.length;j++){if(hasArrays){tmp=data[i][j]}else{tmp=data[i][this.schema.fields[j].name]}this._val(this.schema.fields[j],tmp,results,i)}}}catch(e){throw new Error($.ig.DataSourceLocale.locale.errorParsingArrays+e.message)}return out},_json:function(data){var i,j,root,resKey=this.schema.outputResultsName,out={},results;results=this._setResKey(resKey,out);if(this.isObjEmpty(results)){results=[];out=results}try{if(data.Metadata&&data.Metadata.timezoneOffset!==undefined&&!isNaN(data.Metadata.timezoneOffset)){this._serverOffset=data.Metadata.timezoneOffset;this._parser._serverOffset=this._serverOffset}else{this._parser._serverOffset=0}if(!this.isEmpty(this.schema.searchField)){root=eval("data."+this.schema.searchField)}else{root=data}if(!root.length&&$.type(root)==="object"){root=[root]}if(root&&root.length&&root.length>0){for(i=0;i<root.length;i++){results[i]={};for(j=0;j<this.schema.fields.length;j++){if(this.schema.fields[j].name!=="ig_pk"){if(root[i][this.schema.fields[j].name]===undefined){throw new Error($.ig.DataSourceLocale.locale.errorSchemaMismatch+this.schema.fields[j].name)}this._val(this.schema.fields[j],root[i][this.schema.fields[j].name],results,i,root)}}}}}catch(e){throw new Error($.ig.DataSourceLocale.locale.errorParsingJson+e.message)}return out},_xml:function(data,recursiveSF){var i,j,root,resNode,item,resKey=this.schema.outputResultsName,out={},results,namespaced,sf,k,r,rc,len1,len2,o,carrysf,ireal=0;o=window.ActiveXObject;results=this._setResKey(resKey,out);if(this.isObjEmpty(results)){results=[];out=results}try{if(!this.isEmpty(this.schema.searchField)){namespaced=this._xmlHasNamespaces(data);if(!namespaced){if(window.ActiveXObject===undefined){if(!recursiveSF||recursiveSF.length<=0){root=data.evaluate(this.schema.searchField,data,null,XPathResult.ANY_TYPE,null)}else{root=data.evaluate(recursiveSF,data,null,XPathResult.ANY_TYPE,null)}}else{root=data.selectNodes(this.schema.searchField)}}else{if(this.schema.searchField.startsWith("//")){sf=this.schema.searchField.substring(2,this.schema.searchField.length)}else{sf=this.schema.searchField}root=this._findXmlRecordsRoot(data,sf)}}else{root=data}if(!namespaced){if(root&&window.ActiveXObject!==undefined){for(i=0;i<root.length;i++){item=root.item(i);results[i]={};for(j=0;j<this.schema.fields.length;j++){resNode=item.selectSingleNode(this.schema.fields[j].xpath);if(resNode){if(resNode.nodeType===1&&this.schema.childDataProperty&&resNode.nodeName===this.schema.childDataProperty){this.schema.searchField=this.schema.childDataProperty;results[i][resNode.nodeName]=this._xml(item)}else{this._val(this.schema.fields[j],resNode.text,results,i)}}else{results[i][this.schema.fields[j].name]=""}}}}else{if(root){i=0;item=root.iterateNext();while(item){results[i]={};for(j=0;j<this.schema.fields.length;j++){resNode=data.evaluate(this.schema.fields[j].xpath,item,null,XPathResult.ANY_TYPE,null).iterateNext();if(resNode){if(resNode.nodeType===1&&this.schema.childDataProperty&&(resNode.nodeName===this.schema.childDataProperty||resNode.nodeName===this.schema.seachField)){if(!recursiveSF||recursiveSF.length<=0){carrysf=this.schema.searchField+"["+(i+1)+"]/"+this.schema.childDataProperty}else{carrysf=recursiveSF+"["+(i+1)+"]/"+this.schema.childDataProperty}results[i][this.schema.childDataProperty]=this._xml(data,carrysf)}else{this._val(this.schema.fields[j],resNode.textContent,results,i)}}else{results[i][this.schema.fields[j].name]=""}}i++;item=root.iterateNext()}}}}else{len1=root.childNodes.length;ireal=0;for(i=0;i<len1;i++){r=root.childNodes[i];results.push({});for(j=0;j<this.schema.fields.length;j++){len2=r.childNodes.length;for(k=0;k<len2;k++){rc=r.childNodes[k];if(this.schema.fields[j].name===(o===undefined?rc.localName:rc.baseName)){this._val(this.schema.fields[j],o===undefined?rc.textContent:rc.text,results,ireal);break}}}if($.isEmptyObject(results[ireal])){results.pop()}else{ireal++}}}}catch(e){throw new Error($.ig.DataSourceLocale.locale.errorParsingXml+e.message)}return out},_findXmlRecordsRoot:function(data,field){var i,len,r,o,ret;o=window.ActiveXObject;if((o===undefined?data.localName:data.baseName)===field){ret=data.parentNode}else{if(data&&data.childNodes&&data.childNodes.length>0){len=data.childNodes.length;for(i=0;i<len;i++){r=data.childNodes[i];if(r.childNodes&&r.childNodes.length>0){ret=this._findXmlRecordsRoot(r,field)}}}}return ret},_xmlHasNamespaces:function(data){var i,ns,r,len,fc;if(data.childNodes&&data.childNodes.length&&data.childNodes.length>0){len=data.childNodes.length;for(i=0;i<len;i++){r=data.childNodes[i];if(!r){return false}ns=r.namespaceURI;if(ns!==""&&ns!==undefined&&ns!==null){return true}}if(r&&r.childNodes&&r.childNodes.length>0){fc=r.childNodes[0];if(!fc){return false}ns=fc.namespaceURI;return(ns!==""&&ns!==undefined&&ns!==null)}}return false},_table:function(data){var i,j,r,tbody,rows,resKey=this.schema.outputResultsName,out={},results;tbody=$(data).find("tbody")[0];$(data).find("thead").remove();results=this._setResKey(resKey,out);if(this.isObjEmpty(results)){results=[];out=results}try{if(tbody&&tbody.nodeName&&tbody.nodeName==="TBODY"){rows=tbody.rows;for(i=0;i<rows.length;i++){r=rows[i];results[i]={};for(j=0;j<this.schema.fields.length;j++){this._val(this.schema.fields[j],r.cells[j].innerHTML,results,i)}}}else{throw new Error($.ig.DataSourceLocale.locale.errorExpectedTbodyParameter)}}catch(e){throw new Error($.ig.DataSourceLocale.locale.errorParsingHtmlTable+e.message)}return out},_list:function(data){var parsedData,img,anchor,id,li,ul,self=this,d=$(data),text,i,header,descriptions,counts,jqmNS="data-";if($.mobile&&$.mobile.ns){jqmNS+=$.mobile.ns}parsedData=[];if(d&&(d.is("ul")||d.is("ol"))&&d.children().length>0){d.children("li:not(["+jqmNS+'role="itemTemplate"], ['+jqmNS+'role="detailsTemplate"], ['+jqmNS+'role="dividerTemplate"])').each(function(index){li=$(this);img=li.children("img");parsedData[index]={};if(self.schema.hasOwnProperty("primaryKey")){self._val(self.schema.primaryKey,li.index(),parsedData,index)}if(self.schema.hasOwnProperty("isDivider")){self._val(self.schema.isDivider,li.attr(jqmNS+"role")==="list-divider",parsedData,index)}if(img.length>0&&img.attr("src")){if(self.schema.hasOwnProperty("imageUrl")){self._val(self.schema.imageUrl,img.attr("src"),parsedData,index)}}anchor=li.children("a");if(anchor.length>0){text=anchor.html();if(anchor.attr("href")){if(self.schema.hasOwnProperty("navigateUrl")){self._val(self.schema.navigateUrl,anchor.attr("href"),parsedData,index)}}if(anchor.attr("target")){if(self.schema.hasOwnProperty("target")){self._val(self.schema.target,anchor.attr("target"),parsedData,index)}}if(img.length===0){img=anchor.children("img");if(img.length>0){img.each(function(){if(this.outerHTML){text=text.replace(this.outerHTML,"")}else{text=text.replace($("<div>").append(this).html(),"")}})}if(img.length>0&&img.attr("src")){if(self.schema.hasOwnProperty("imageUrl")){self._val(self.schema.imageUrl,img.attr("src"),parsedData,index)}}}}else{text="";for(i=0;i<li[0].childNodes.length;i++){if(li[0].childNodes[i].nodeType===3&&li[0].childNodes[i].data){text+=$.trim(li[0].childNodes[i].data)}}}if(self.schema.hasOwnProperty("header")){header=li.children("h1, h2, h3, h4, h5, h6");if(header.length===0&&anchor.length>0){header=anchor.children("h1, h2, h3, h4, h5, h6")}if(header.length>0){self._val(self.schema.header,header.text(),parsedData,index);header.each(function(){if(this.outerHTML){text=text.replace(this.outerHTML,"")}else{text=text.replace($("<div>").append(this).html(),"")}})}}if(self.schema.hasOwnProperty("description")){descriptions=li.children("p, dd");if(descriptions.length===0&&anchor.length>0){descriptions=anchor.children("p, dd")}if(descriptions.length>0){self._val(self.schema.description,descriptions.text(),parsedData,index);descriptions.each(function(){if(this.outerHTML){text=text.replace(this.outerHTML,"")}else{text=text.replace($("<div>").append(this).html(),"")}})}}if(self.schema.hasOwnProperty("count")){counts=li.children("span.ui-li-count");if(counts.length===0&&anchor.length>0){counts=anchor.children("span.ui-li-count")}if(counts.length>0){self._val(self.schema.count,parseInt(counts.text(),10),parsedData,index);counts.each(function(){if(this.outerHTML){text=text.replace(this.outerHTML,"")}else{text=text.replace($("<div>").append(this).html(),"")}})}}if(self.schema.hasOwnProperty("text")){self._val(self.schema.text,text,parsedData,index)}id=li.attr("id");if(id){if(self.schema.hasOwnProperty("value")){self._val(self.schema.value,id,parsedData,index)}}ul=li.children("ul, ol");if(ul.length>0){if(self.schema.hasOwnProperty("childData")&&self.schema.childData.hasOwnProperty("name")){parsedData[index][self.schema.childData.name]=self._list(ul)}}})}return parsedData},isObjEmpty:function(obj){var prop;for(prop in obj){if(obj.hasOwnProperty(prop)){return false}}return true},fields:function(){return this.schema.fields}});$.ig.RemoteDataSource=$.ig.RemoteDataSource||$.ig.DataSource.extend({init:function(options){if(!options){options={}}options.type="remoteUrl";this._super(options);return this}});$.ig.JSONDataSource=$.ig.JSONDataSource||$.ig.DataSource.extend({init:function(options){if(!options){options={}}options.type="json";this._super(options);return this}});$.ig.JSONPDataSource=$.ig.JSONPDataSource||$.ig.DataSource.extend({init:function(options){if(!options){options={}}options.responseDataType="jsonp";this._super(options);return this}});$.ig.XmlDataSource=$.ig.XmlDataSource||$.ig.DataSource.extend({init:function(options){if(!options){options={}}options.type="xml";this._super(options);return this}});$.ig.FunctionDataSource=$.ig.FunctionDataSource||$.ig.DataSource.extend({init:function(options){if(!options){options={}}options.type="function";this._super(options);return this}});$.ig.HtmlTableDataSource=$.ig.HtmlTableDataSource||$.ig.DataSource.extend({init:function(options){if(!options){options={}}options.type="htmlTableDom";this._super(options);return this}});$.ig.ArrayDataSource=$.ig.ArrayDataSource||$.ig.DataSource.extend({init:function(options){if(!options){options={}}options.type="array";this._super(options);return this}});$.ig.MashupDataSource=$.ig.MashupDataSource||$.ig.DataSource.extend({mashupSettings:{ignorePartialRecords:false,dataSource:[]},init:function(options){this._super(options);if(options){this.settings=$.extend(true,{},$.ig.DataSource.prototype.settings,options);this.settings=$.extend(true,{},$.ig.MashupDataSource.prototype.mashupSettings,this.settings)}this._sources=[];this._dataBindingComplete=false;this._sourcesStatus=[];this._hashedDataViews=[];return this},_checkDataBindingComplete:function(status,msg,ownerDs){var i,j,k,hasPrimaryKeys=true,totalLength=0,data=[],d,rindex,keyVal,prop;this._dataBindingComplete=true;for(i=0;i<this._sources.length;i++){if(this._sources[i]===ownerDs){this._sourcesStatus[i]=1}if(this._sourcesStatus[i]===0){this._dataBindingComplete=false}}if(this._dataBindingComplete){for(i=0;i<this._sources.length;i++){if(this._sources[i].settings.primaryKey===""||this._sources[i].settings.primaryKey===null||this._sources[i].settings.primaryKey===undefined){hasPrimaryKeys=false;break}}totalLength=this._sources[0].dataView().length;for(i=0;i<this._sources.length;i++){totalLength=this.settings.ignorePartialRecords?(this._sources[i].dataView().length<totalLength?this._sources[i].dataView().length:totalLength):(this._sources[i].dataView().length>totalLength?this._sources[i].dataView().length:totalLength)}if(hasPrimaryKeys){for(i=0;i<this._sources.length;i++){this._hashedDataViews[i]={};for(j=0;j<this._sources[i].dataView().length;j++){this._hashedDataViews[i][this._sources[i].dataView()[j][this._sources[i].settings.primaryKey]]=this._sources[i].dataView()[j]}}for(i=0;i<totalLength;i++){data[i]={};for(j=0;j<this._sources.length;j++){if(this._sources[j].dataView().length>i){keyVal=this._sources[j].dataView()[i][this._sources[j].settings.primaryKey];data[i]=$.extend(true,{},data[i],this._hashedDataViews[j][keyVal])}else{data[i]=$.extend(true,{},data[i],{})}}}}else{for(i=0;i<totalLength;i++){data[i]={};for(j=0;j<this._sources.length;j++){d=this._sources[j];if(d.dataView()[0].length){for(k=0;k<d.dataView()[0].length;k++){rindex+=k;if(d.schema()&&d.schema().fields().length>0){data[i][d.schema().fields()[k]]=i>=d.dataView().length?"":d.dataView()[i][d.schema().fields()[k]]}else{data[i][rindex]=i>=d.dataView().length?"":d.dataView()[i][k]}}}else{for(prop in d.dataView()[i]){if(d.dataView()[i].hasOwnProperty(prop)){data[i][prop]=i>=d.dataView().length?"":d.dataView()[i][prop]}}}}rindex=0}}this.settings.dataSource=data;this.settings.type="array";this._runtimeType=this.analyzeDataSource();this.dataBind()}},dataBind:function(){var i,ds=this.settings.dataSource;if(this._dataBindingComplete){this._dataBindingComplete=false;this._super()}else{this._dataBindingComplete=false;for(i=0;i<ds.length;i++){if(ds[i] instanceof $.ig.DataSource){this._sources[i]=ds[i]}else{if(ds[i].hasOwnProperty("dataSource")&&ds[i].dataSource instanceof $.ig.DataSource){this._sources[i]=ds[i].dataSource}else{this._sources[i]=new $.ig.DataSource(ds[i])}}this._sources[i].settings.callee=this;this._sources[i].settings.callback=this._checkDataBindingComplete;this._sourcesStatus[i]=0}for(i=0;i<ds.length;i++){this._sources[i].dataBind()}}return this}});$.ig.HierarchicalDataSource=$.ig.HierarchicalDataSource||Class.extend({settings:{autogenerate:false,initialDataBindDepth:0,maxDataBindDepth:-1,defaultChildrenDataProperty:"children",callback:null,callee:null,data:[],dataSource:null,dataBinding:null,dataBound:null,type:"unknown",responseDataType:null,responseContentType:null,localSchemaTransform:true,urlParamsEncoding:null,urlParamsEncoded:null,odata:false,paging:{},sorting:{},filtering:{},schema:[]},init:function(options){if(options){this.__ds=options.dataSource;options.dataSource=null;this.settings=$.extend(true,{},$.ig.HierarchicalDataSource.prototype.settings,options);this.settings.dataSource=this.__ds}this._rootopts=this.settings;this._rootopts.urlParamsEncoded=$.proxy(this._encodeHierarchicalUrlParams,this);if(this._rootopts.dataSource instanceof $.ig.DataSource){this._rootds=this._rootopts.dataSource;this._rootds.settings.urlParamsEncoded=this.settings.urlParamsEncoded;this._rootds.settings.odata=this.settings.odata;if(!this._rootds.settings.schema){this._rootds.settings.schema={}}this._rootds.settings.schema.layouts=this.settings.schema.layouts}else{if($.type(this._rootopts.dataSource)==="string"&&this._rootopts.dataSource.indexOf("$callback=?")!==-1){this._rootds=new $.ig.JSONPDataSource(this._rootopts)}else{this._rootds=new $.ig.DataSource(this._rootopts)}}},dataBind:function(callback,callee){this._rootds.dataBind(callback,callee)},root:function(){if(!this._rootds){this._rootds=new $.ig.DataSource(this._rootopts)}return this._rootds},dataAt:function(path,keyspath){var data=this.root().data(),paths=path.split("/"),kp=keyspath.split("/"),k,i,j,cd=null,ckey=this.settings.primaryKey,ckeyval="",ckeys=[],ckeyvals=[],match=false;for(i=0;i<paths.length;i++){ckey=paths[i].split(":")[0];ckeyval=paths[i].split(":")[1];if(paths[i]!==""){for(j=0;data&&j<data.length;j++){if(ckey&&ckey.indexOf(",")!==-1){ckeys=ckey.split(",");ckeyvals=ckeyval.split(",");for(k=0;k<ckeys.length;k++){if(!data[j][ckeys[k]].charAt&&ckeyvals[k].charAt){ckeyvals[k]=parseInt(ckeyvals[k],10)}match=(data[j][ckeys[k]]===ckeyvals[k]);if(!match){break}}}else{if(data[j][ckey]!==undefined&&!data[j][ckey].charAt&&ckeyval.charAt){ckeyval=parseInt(ckeyval,10)}match=(data[j][ckey]===ckeyval)}if(match){cd=data[j][kp[i]];if(paths.length>1&&i<paths.length-1&&this.root().schema().schema.searchField&&$.type(cd)!=="array"&&cd[this.root().schema().schema.searchField]){cd=cd[this.root().schema().schema.searchField]}break}}data=cd}}return cd},_encodeUrlPath:function(rowid,name){return"path="+rowid+"&layout="+name},_encodeHierarchicalUrlParams:function(owner,args){var expand="",layouts=this.settings.schema.layouts,i,j,tmp,name,lc=0;if(this.settings.odata&&this.settings.initialDataBindDepth!==0){i=j=0;for(name in layouts){if(layouts.hasOwnProperty(name)){lc++}}lc++;for(name in layouts){if(layouts.hasOwnProperty(name)){if($.type(layouts[name])!=="function"){if(name.startsWith("/")){name=name.substring(1,name.length-1)}tmp=name.split("/");for(i=0;i<tmp.length;i++){tmp[i]=tmp[i].substring(0,tmp[i].indexOf(":"))}tmp=tmp.join("/");if(j!==0&&j!==lc-1){expand+=","}expand+=tmp;j++}}}args.selectParams.$expand=expand}else{args.selectParams.dbdepth=this.settings.initialDataBindDepth}}});if(typeof define==="function"&&define.amd&&define.amd.jQuery){define("ig.datasource",["ig.util"],function(){return $.ig.DataSource})}}(jQuery));
/*
* Infragistics.Web.ClientUI templating localization resources 12.1.20121.1010
*
* Copyright (c) 2011-2012 Infragistics Inc.
*
* http://www.infragistics.com/
*
*/
$.ig=$.ig||{};if(!$.ig.Templating){$.ig.Templating={};$.extend($.ig.Templating,{locale:{undefinedArgument:"An error has occurred while trying to retrieve data source property: "}});
/*
 * Infragistics.Web.ClientUI Templating Engine 12.1.20121.1010
 *
 * Copyright (c) 2011-2012 Infragistics Inc.
 * 
 * Engine used for data templating
 *
 * http://www.infragistics.com/
 *
 * Depends on:
 *
 */
}(function(a){a.ig=a.ig||{};a.extend(a.ig,{tmpl:function(d,c,b){var e=d;this.tokens=[];this.args=[];this.i=0;if(typeof c==="function"){if(b){c=c.apply(this,b)}else{c=c.call()}}e=e.replace(this.regExp.comment,"");this._tokenizeTemplate(e);if(this.regExp.block.test(e)){this._hasBlock=true;e=this._tokenizeDirectives(e)}if(!this.tokens){return e}else{if(this._hasBlock){e=this._compileTemplate(e,c)}else{e=this._populateTemplate(e,c)}}delete this.args;delete this.tokens;delete this._hasBlock;delete this.i;return e},encode:function(b){return b!==null&&typeof b!=="undefined"?b.toString().replace(this.regExp.lt,"&lt;").replace(this.regExp.gt,"&gt;").replace(this.regExp.ap,"&#39;").replace(this.regExp.ic,"&#34;"):""},regExp:{comment:/#[^#]*#/g,sub:/\$\{((\w+\.?\w+)+)\}/,nonEncodeSub:/\{\{html\s+(\w+\.?\w+)+\}\}/,forSub:/\$\{((\w+\.\w+)+)\}/,arg:/args\[\d+\](?!.*\+)/,block:/\{\{(\w+).*?\}\}+(.*)(\{\{\/\1\}\})/,blockCont:/\{\{(?!\/)(\S+)(.*)\}\}(.*)/,blockDirective:/\{\{\S+.*?\}\}/,index:/\$i/g,lt:/</g,gt:/>/g,ap:/'/g,ic:/"/g},directives:{"if":{start:"if (",close:") {",end:" }"},elseif:{start:" } else if (",close:") {",end:""},"else":{start:" } else {",close:"",end:""},each:{start:"for (var i = 0; i < $data.length; i++) {",close:"",end:" }"}},_tokenizeTemplate:function(c){var d,b;if(this.regExp.sub.test(c)){d=this.regExp.sub.exec(c);while(d!==null){b=d[1].split(".");c=c.replace(new RegExp("\\$\\{"+d[1]+"\\}","g"),"");d[3]=new RegExp("\\$\\{"+d[1]+"\\}","g");d[1]=b;d[2]=true;this.tokens.push(d);d=this.regExp.sub.exec(c)}}if(this.regExp.nonEncodeSub.test(c)){d=this.regExp.nonEncodeSub.exec(c);while(d!==null){b=d[1].split(".");c=c.replace(new RegExp("\\{\\{html\\s+"+d[1]+"\\}\\}","g"),"");d[3]=new RegExp("\\{\\{html\\s+"+d[1]+"\\}\\}","g");d[1]=b;d[2]=false;this.tokens.push(d);d=this.regExp.nonEncodeSub.exec(c)}}},_tokenizeDirectives:function(c){var d='var result = "";',e=this.regExp.block.exec(c),b;if(c.indexOf(e[0])>0){b=c.split(e[0]);if(b[0]&&b[0].length>0){this.args.push(b[0]);d+="result += args["+this.i+++"];"}}d+=this._handleCompleteBlock(e);if(b&&b.length>0&&b[1].length>0){this.args.push(b[1]);d+="result += args["+this.i+++"];"}d+="return result;";return d},_handleCompleteBlock:function(c){var b=c[0];b=b.replace("{{"+c[1],this.directives[c[1]].start);if(c[1]==="each"){b=this._handleEach(b,c)}else{if(c[1]==="if"){b=this._handleIfElse(b,c)}}return b},_handleEach:function(l,n){var m=l,h,c,b,e,f,k,d,g;c=this.regExp.sub.exec(m);m=m.replace(c[0],"");m=m.replace("$data",c[0]);b=n[2];if(/\$data/.test(b)){b=b.replace(/\$data/g,'" + '+c[0]+'[i] + "');this.args.push(c[0]);this.i++}e=this.regExp.forSub.exec(b);while(e){b=b.replace(new RegExp("\\$\\{"+e[1]+"\\}","g"),'" + '+c[0]+"[i]"+e[1].substr(e[1].indexOf("."))+' + "');e=this.regExp.forSub.exec(b)}b=b.replace(/\$index/g,'" + i + "');m=m.replace(n[2],'result += "'+b+'"');m=m.replace(/\}\}/,this.directives[n[1]].close);m=m.replace(n[3],this.directives[n[1]].end);if(this.regExp.block.test(m)){g=this.regExp.block.exec(m);m=m.replace(g[0],this._handleCompleteBlock(g))}k=this.regExp.sub.exec(m);while(k){d=new RegExp("\\$\\{"+k[1]+"\\}","g");m=m.replace(d,"args["+this.i+++"]");this.args.push(k[0]);k=this.regExp.sub.exec(m)}return m},_handleIfElse:function(g,k){var h=g,c=0,b,f,e,d,j=[];h=h.replace(/\}\}/,this.directives[k[1]].close);d=h.lastIndexOf(k[3]);h=h.substr(0,d)+h.slice(d+k[3].length-1);if(this.regExp.block.test(h)){e=this.regExp.block.exec(h);h=h.replace(e[0],this._handleCompleteBlock(e))}b=k[2].split(this.regExp.blockDirective);j.push(h.slice(0,h.indexOf(") {")+3));j.push(h.slice(h.indexOf(") {")+3));for(c;c<b.length;c++){if(b[c]&&b[c].length&&b[c].length>0){j[1]=j[1].replace(b[c],"result += args["+this.i+++"];");this.args.push(b[c])}}h=j.join("");k=this.regExp.blockCont.exec(h);while(k){h=h.replace("{{"+k[1],this.directives[k[1]].start);h=h.replace(/\}\}/,this.directives[k[1]].close);k=this.regExp.blockCont.exec(h)}f=this.regExp.sub.exec(h);while(f){h=h.replace(new RegExp("\\$\\{"+f[1]+"\\}","g"),"args["+this.i+++"]");this.args.push(f[0]);f=this.regExp.sub.exec(h)}return h},_populateTemplate:function(g,b){var c,d,e="",f;if(!b.length){for(c=0;c<this.tokens.length;c++){g=this._populateArgumentValue(b,this.tokens[c],g)}e=g}else{if(b.length){for(d=0;d<b.length;d++){f=g;for(c=0;c<this.tokens.length;c++){f=this._populateArgumentValue(b[d],this.tokens[c],f)}f=f.replace(this.regExp.index,d);e+=f}}}return e},_compileTemplate:function(o,c){var e,g,h,l="",m,n=[],b="",d;if(!c.length){for(g=0;g<this.args.length;g++){b=this.args[g];for(e=0;e<this.tokens.length;e++){if(b===this.tokens[e][0]){b=this._getArgumentValue(c,this.tokens[e],b);break}else{if(typeof b==="string"){b=this._populateArgumentValue(c,this.tokens[e],b)}}}if(typeof b==="undefined"){throw new Error(a.ig.Templating.locale.undefinedArgument+this.tokens[e][0])}if(typeof b==="string"){b=b.replace(this.regExp.index,0)}n.push(b)}o=o.replace(/\$i/g,0);l=new Function("args",o).call(this,n)||""}else{if(c.length){m=o.replace(this.regExp.index,"args["+this.args.length+"]");d=new Function("args",m);for(g=0;g<c.length;g++){n=[];for(h=0;h<this.args.length;h++){b=this.args[h];for(e=0;e<this.tokens.length;e++){if(b===this.tokens[e][0]){b=this._getArgumentValue(c[g],this.tokens[e],b);break}else{if(typeof b==="string"){b=this._populateArgumentValue(c[g],this.tokens[e],b)}}}if(typeof b==="undefined"){throw new Error(a.ig.Templating.locale.undefinedArgument+this.tokens[e][0])}if(typeof b==="string"){b=b.replace(this.regExp.index,g)}n.push(b)}n.push(g);l+=d.call(this,n)||""}}}return l},_getArgumentValue:function(c,f,b){var e,d;if(f[1].length&&f[1].length>1){e=c;for(d=0;d<f[1].length;d++){e=e[f[1][d]]}if(f[2]&&typeof e==="string"){b=this.encode(e)}else{b=e}}else{if(f[2]&&typeof c[f[1]]==="string"){b=this.encode(c[f[1]])}else{b=c[f[1]]}}return b},_populateArgumentValue:function(c,f,b){var e,d;if(f[1].length&&f[1].length>1){e=c;for(d=0;d<f[1].length;d++){e=e[f[1][d]]}if(f[2]&&typeof e==="string"){b=b.replace(f[3],this.encode(e))}else{b=b.replace(f[3],e)}}else{if(f[2]){b=b.replace(f[3],this.encode(c[f[1]]))}else{b=b.replace(f[3],c[f[1]])}}return b}})}(jQuery));
/*
* Infragistics.Web.ClientUI ListView localization resources 12.1.20121.1010
*
* Copyright (c) 2011-2012 Infragistics Inc.
*
* http://www.infragistics.com/
*
*/
$.ig=$.ig||{};if(!$.ig.mobileListView){$.ig.mobileListView={};$.ig.mobileListViewFiltering={};$.ig.mobileListViewLoadOnDemand={};$.ig.mobileListViewSorting={};$.ig.mobileListView.locale={noSuchWidget:"No such widget loaded: ",optionChangeNotSupported:"Changing the following option after the igListView has been created is not supported:",emptyListText:"There are no list items!",goBackLabel:"Go back",detailsLabel:"Details",searchTrayExpandLabel:"Sort/Filter",searchTrayCollapseLabel:"Collapse"};$.ig.mobileListViewFiltering.locale={keywordSearchLabel:"",keywordAllStateText:"All Fields",filterPresetsLabel:"Filter Presets:",searchBarPlaceHolder:"Filter Items...",filterAllStateText:"All",showLabel:"Show ",cancelButtonLabel:"Cancel"};$.ig.mobileListViewLoadOnDemand.locale={loadMoreItemsLabel:"Load more items",noMoreItemsLabel:"No items left to load"};$.ig.mobileListViewSorting.locale={sortPresetsLabel:"Sort Presets:",sortDefaultStateText:"Default",sortByLabel:"Sort by "};
/*
 * Infragistics.Web.MobileUI ListView 12.1.20121.1010
 *
 * Copyright (c) 2011-2012 Infragistics Inc.
 *
 * http://www.infragistics.com/
 *
 * Depends on: 
 *  jquery-1.6.4.js
 *	jquery.ui.core.js
 *	ig.dataSource.js
 *  ig.ui.shared.js
 *	ig.util.js
 */
}(function($){var _originalBindings=null;$.widget("mobile.igList",$.mobile.widget,{css:{igList:"ig-listview",baseList:"ui-listview",insetList:"ui-listview-inset ui-corner-all ui-shadow",searchArea:"ui-listview-filter ui-bar-{0}",searchTray:"ui-iglist-tray",searchTrayCollapsed:"ui-iglist-tray-collapsed",insetSearchArea:"ui-listview-filter-inset",insetSearchTray:"ui-listview-filter-inset",searchTrayFooter:"ui-iglist-tray-footer ui-bar-{0}",searchTrayFooterCollapsed:"ui-iglist-tray-footer-collapsed",searchTrayCollapse:"ui-iglist-tray-collapse ui-bar-{0}",searchTrayCollapseOpen:"ui-iglist-tray-collapse-open",searchTrayFooterBtnHolder:"ui-btn-text",searchTrayExpandText:"ui-iglist-tray-footer-empty",searchTrayExpandIcon:"ui-icon ui-icon-arrow-d ui-iglist-tray-footer-empty-icon",searchTrayCollapseIcon:"ui-icon ui-icon-arrow-u",searchTrayFooterBtnOpen:"tray-btn-open ui-icon-arrow-u",insetSearchTrayFooter:"ui-iglist-tray-footer-inset",baseListItem:"ui-li ui-btn ui-btn-up-{0}",readOnlyListItem:"ui-li ui-li-static ui-body-{0}",count:"ui-li-count ui-btn-up-{0} ui-btn-corner-all",liIconRight:"ui-btn-icon-right ui-li-has-arrow",liHasCount:"ui-li-has-count",liHasThumb:"ui-li-has-thumb",liHasIcon:"ui-li-has-icon",imageIcon:"ui-li-icon ui-li-thumb",imageThumb:"ui-li-thumb",detailsTemplate:"ui-iglist-details",listDivider:"ui-li ui-li-divider ui-btn ui-bar-{0} ui-li-has-count"},options:{inset:false,numberedList:false,dataSource:null,dataSourceUrl:null,dataSourceType:null,responseDataKey:null,responseTotalRecCountKey:null,localSchemaTransform:true,itemTemplate:null,itemDetailsTemplate:null,imageMode:"thumbnail",showCount:true,itemHeaderSize:"h2",bindings:{textKey:"Text",textXPath:"@Text",imageUrlKey:"ImageUrl",imageUrlXPath:"@ImageUrl",navigateUrlKey:"NavigateUrl",navigateUrlXPath:"@NavigateUrl",countKey:"Count",countXPath:"@Count",headerKey:"Header",headerXPath:"@Header",descriptionKey:"Description",descriptionXPath:"@Description",primaryKey:null,isDividerKey:"IsDivider",detailsTitleKey:"Title",detailsTitleXPath:"@Title",customBindings:[]},searchTheme:"c",searchFooterTheme:"d",countTheme:"c",subPageHeaderTheme:"b",listDividerTheme:"b",itemTheme:null,searchTrayExpandLabel:null,features:[{}]},events:{dataBinding:"dataBinding",dataBound:"dataBound",dataRendering:"dataRendering",dataRendered:"dataRendered",renderingTray:"renderingTray",renderedTray:"renderedTray",renderingTrayFooterBar:"renderingTrayFooterBar",renderedTrayFooterBar:"renderedTrayFooterBar",footerRendering:"footerRendering",footerRendered:"footerRendered",itemsRendering:"itemsRendering",itemsRendered:"itemsRendered",subPageCreating:"subPageCreating",subPageCreated:"subPageCreated",schemaGenerated:"schemaGenerated",requestError:"requestError"},_setOption:function(key,value){$.Widget.prototype._setOption.apply(this,arguments);if(key==="dataSource"){this.options.dataSource=value;this.dataBind()}},_createWidget:function(){this.options.bindings=null;$.Widget.prototype._createWidget.apply(this,arguments)},_create:function(){var self=this,opts=this.options;if(!opts.itemTheme){opts.itemTheme=$.mobile.getInheritedTheme(this.element,"c")}this._firstBind=true;this._updateCss();self.dataBind()},container:function(){var parent=this.element.parent();if(parent&&parent.length>0&&parent[0].id===this.element[0].id+"_container"){return parent}return $("#"+this.element[0].id+"_container")},_locale:function(key){var val=this.options[key];if(val===undefined||val===null){val=$.ig.mobileListView&&$.ig.mobileListView.locale?$.ig.mobileListView.locale[key]:null}return val||""},_updateCss:function(){var css=this.css,opts=this.options;css.baseListItem=css.baseListItem.replace("{0}",opts.itemTheme);css.readOnlyListItem=css.readOnlyListItem.replace("{0}",opts.itemTheme);css.count=css.count.replace("{0}",opts.countTheme);css.searchArea=css.searchArea.replace("{0}",opts.searchTheme);css.searchTray=css.searchTray.replace("{0}",opts.searchTheme);css.searchTrayFooter=css.searchTrayFooter.replace("{0}",opts.searchFooterTheme);css.searchTrayCollapse=css.searchTrayCollapse.replace("{0}",opts.searchFooterTheme);css.listDivider=css.listDivider.replace("{0}",opts.listDividerTheme)},_itemFromTarget:function(target,tagName,attribute){while(target){if(target.tagName&&target.tagName.toLowerCase()===tagName&&target.hasAttribute(attribute)){break}target=target.parentNode}return target},toggleSearchArea:function(){this.container().find("."+this.css.searchTrayFooter.split(" ")[0]).trigger("click");return this},dataBind:function(){var dataOptions,i,noCancel=true,listString,hList;noCancel=this._trigger(this.events.dataBinding,null,{owner:this});if(noCancel){dataOptions=this._generateDataSourceOptions(this.options);this._setupDataSource(dataOptions);this._dataOptions=dataOptions;if(!this._initialized){this._onChangePageHandler=$.proxy(this._onChangePage,this);$(document).bind("pagechange",this._onChangePageHandler);if(this.element.is("div")){this._isWrapped=true;hList=this.options._hParent;if((hList&&hList.options.dataSource&&hList.options.dataSource.tagName&&(hList.options.dataSource.tagName.toLowerCase()==="ul"||hList.options.dataSource.tagName.toLowerCase()==="ol"))||(dataOptions.dataSource&&dataOptions.dataSource.tagName&&(dataOptions.dataSource.tagName.toLowerCase()==="ul"||dataOptions.dataSource.tagName.toLowerCase()==="ol"))){this.listElement=hList?$(hList.options.dataSource):$(dataOptions.dataSource);this.listElement.siblings().remove()}else{if(this.options.numberedList){listString="<ol></ol>"}else{listString="<ul></ul>"}this.element.empty();this.listElement=$(listString).appendTo(this.element).attr("id",this.element[0].id+"_list")}}else{this.listElement=this.element}this.element.data("igFlatList",this);for(i=0;i<this.options.features.length;i++){this._initFeature(this.options.features[i],dataOptions)}this._renderList()}$.mobile.showPageLoadingMsg();this._dataBinding=true;this._requireRecordsClear=true;this.dataSource.dataBind()}},_onChangePage:function(evt,args){if(this._dataBinding){$.mobile.showPageLoadingMsg()}$(document).unbind("pagechange",this._onChangePageHandler);delete this._onChangePageHandler},_renderList:function(){var self=this,css=this.css,opts=this.options,listClass=css.baseList,searchClass,trayFooter,containerId,containerDiv,form=$("<form></form>"),args,noCancel;containerId=this.element[0].id+"_container";containerDiv='<div id="'+containerId+'"> </div>';this.element.wrap(containerDiv).addClass(css.igList);searchClass=css.searchArea;trayFooter=css.searchTrayFooter;if(opts.inset){listClass+=" "+css.insetList;searchClass+=" "+css.insetSearchArea}this.listElement.addClass(listClass);if(opts.itemDetailsTemplate!==null&&opts.itemDetailsTemplate.length>0){this.listElement.bind("click",function(evnt){self._listTap(evnt)})}args={owner:this,tray:null,needTray:0,css:this.css.searchTray};noCancel=this._trigger(this.events.renderingTray,null,args);if(noCancel&&args.needTray){form.addClass(searchClass).append(args.tray).bind({submit:function(){return false}});this._trigger(this.events.renderedTray,null,args);if(args.needTray>1){args.tray.addClass(css.searchTray).addClass(args.css).addClass(css.searchTrayCollapsed);args={owner:this,trayFooter:$("<div>").addClass(css.searchTrayFooter).addClass(css.searchTrayFooterCollapsed)};if(this.options.inset){args.trayFooter.addClass(css.insetSearchTrayFooter)}noCancel=this._trigger(this.events.renderingTrayFooterBar,null,args);if(noCancel){args.trayFooter.append("<span data-trayRole='empty'	class='"+css.searchTrayExpandText+"'>"+this._locale("searchTrayExpandLabel")+"</span><span class='"+css.searchTrayExpandIcon+"'></span>");if(args.trayFooter.find('[data-trayRole="keyword"]').text()){args.trayFooter.find('[data-trayRole="empty"]').hide().next().hide()}form=form.append(args.trayFooter).append($("<div>").addClass(css.searchTrayCollapse).html(this._locale("searchTrayCollapseLabel")+"<span class='"+css.searchTrayCollapseIcon+"'></span>")).wrap("<div>").parent();this._trigger(this.events.renderedTrayFooterBar,null,{owner:this});this._clickFooter=function(event,args){var footer=self.container().find(".ui-iglist-tray-footer");footer.toggleClass(css.searchTrayFooterCollapsed).next().toggleClass(css.searchTrayCollapseOpen).end().prev().toggleClass(css.searchTrayCollapsed)};args.trayFooter.bind("click",this._clickFooter);args.trayFooter.next().bind("click",this._clickFooter);form.children().insertBefore(this.listElement)}}else{form.insertBefore(this.listElement)}this.listElement.parent().find("form").find("li:visible").each(function(){var $this=$(this);$this.width($this.outerWidth())})}args={owner:this,footerContents:$("<div>")};noCancel=this._trigger(this.events.footerRendering,null,args);if(noCancel){args.footerContents.children().insertAfter(this.element);this._trigger(this.events.footerRendered,null,{owner:this})}if(this.dataSource.type()!=="htmlListDom"){this.listElement.empty()}},_initFeature:function(featureObject,dataOptions,destroy){if(!featureObject){return}if(featureObject.name===undefined){return}var widget="igListView"+featureObject.name;if($.type($("#"+this.element[0].id)[widget])!=="function"){throw new Error(this._locale("noSuchWidget")+" "+widget)}if(this.element.data(widget)!==undefined){this.element[widget]("destroy")}this.element[widget](featureObject);this.element.data(widget)._injectList(this)},_generateDataSourceOptions:function(options){var schema,dataOptions;if(!this.options.dataSource&&!this.options.dataSourceUrl&&(this.element.is("ul")||this.element.is("ol"))&&this.element.children().length>0){this.options.dataSource=this.element[0]}dataOptions={callback:$.proxy(this._onDataBound,this),callee:this,responseDataKey:this.options.responseDataKey,localSchemaTransform:this.options.localSchemaTransform,dataSource:this.options.dataSource};if(this.options.dataSourceType!==null){dataOptions.type=this.options.dataSourceType}schema=this._generateDataSourceSchema();if(this.options.bindings&&this.options.bindings.primaryKey){dataOptions.primaryKey=this.options.bindings.primaryKey}if((this.options.dataSource instanceof $.ig.DataSource&&(this.options.dataSource.settings.schema===null||(this.options.dataSource.settings.schema.fields&&this.options.dataSource.settings.schema.fields.length>=0)||!this.options.dataSource.settings.schema.fields))||!(this.options.dataSource instanceof $.ig.DataSource)){dataOptions=$.extend(dataOptions,{schema:schema})}return dataOptions},_generateDataSourceSchema:function(){var schema={},ds=this.options.dataSource,opt=this.options,bindings=opt.bindings,x;schema.fields=[];schema.searchField=this.options.responseDataKey;if(bindings===null){return this._generateBindings(ds)}if(opt.dataSourceType==="xml"){schema.fields=[];if(bindings.textKey){schema.fields.push({name:bindings.textKey,xpath:bindings.textXPath});schema.textKey=bindings.textKey}if(bindings.navigateUrlKey){schema.fields.push({name:bindings.navigateUrlKey,xpath:bindings.navigateUrlXPath});schema.navigateUrlKey=bindings.navigateUrlKey}if(bindings.imageUrlKey){schema.fields.push({name:bindings.imageUrlKey,xpath:bindings.imageUrlXPath});schema.imageUrlKey=bindings.imageUrlKey}if(bindings.countKey){schema.fields.push({name:bindings.countKey,xpath:bindings.countXPath});schema.countXPath=bindings.countKey}if(bindings.headerKey){schema.fields.push({name:bindings.headerKey,xpath:bindings.headerXPath});schema.headerXPath=bindings.headerKey}if(bindings.descriptionKey){schema.fields.push({name:bindings.descriptionKey,xpath:bindings.descriptionXPath});schema.descriptionXPath=bindings.descriptionKey}if(bindings.detailsTitleKey){schema.fields.push({name:bindings.detailsTitleKey,xpath:bindings.detailsTitleXPath});schema.detailsTitleXPath=bindings.detailsTitleKey}if(bindings.searchFieldXPath){schema.searchField=bindings.searchFieldXPath}if(this.options.childLayout){schema.fields.push({name:this.options.childLayout.key,xpath:this.options.childLayout.key});schema.childDataProperty=this.options.childLayout.key}return schema}schema.fields=[];if(bindings.primaryKey){schema.fields.push({name:bindings.primaryKey,type:"string"});schema.primaryKeyKey=bindings.primaryKey}if(bindings.textKey){schema.fields.push({name:bindings.textKey,type:"string"});schema.textKey=bindings.textKey}if(bindings.navigateUrlKey){schema.fields.push({name:bindings.navigateUrlKey,type:"string"});schema.navigateUrlKey=bindings.navigateUrlKey}if(bindings.imageUrlKey){schema.fields.push({name:bindings.imageUrlKey,type:"string"});schema.imageUrlKey=bindings.imageUrlKey}if(bindings.countKey){schema.fields.push({name:bindings.countKey,type:"number"});schema.countKey=bindings.countKey}if(bindings.headerKey){schema.fields.push({name:bindings.headerKey,type:"string"});schema.headerKey=bindings.headerKey}if(bindings.descriptionKey){schema.fields.push({name:bindings.descriptionKey,type:"string"});schema.descriptionKey=bindings.descriptionKey}if(bindings.detailsTitleKey){schema.fields.push({name:bindings.detailsTitleKey,type:"string"});schema.detailsTitleKey=bindings.detailsTitleKey}if(bindings.isDividerKey){schema.fields.push({name:bindings.isDividerKey,type:"bool"});schema.isDividerKey=bindings.isDividerKey}if(bindings.customBindings&&bindings.customBindings.length>0){for(x=0;x<bindings.customBindings.length;++x){schema.fields.push({name:bindings.customBindings[x].fieldName,type:bindings.customBindings[x].dataType});schema[bindings.customBindings[x].fieldName+"Key"]=bindings.customBindings[x].fieldName}}opt.schema=schema;opt.schema.searchField=opt.responseDataKey;if(this.options.childLayout){schema.fields.push({name:this.options.childLayout.childrenDataProperty===undefined?this.options.childLayout.key:this.options.childLayout.childrenDataProperty})}this._trigger(this.events.schemaGenerated,null,{owner:this,schema:schema,dataSource:ds});return schema},_generateBindings:function(ds,addAll){var opt=this.options,schema,x,rec,prop,name,camelCase,bindingName,fieldType,guess,allFields=["Text","NavigateUrl","ImageUrl","Count","Description","Header","DetailsTitle","IsDivider"];if((opt.bindings===null||opt.bindings===undefined)&&ds&&ds.length&&ds.length>0&&$.type(ds)==="array"){opt.bindings={};schema={};schema.fields=[];schema.searchField=this.options.responseDataKey;for(x=0;x<ds.length;++x){rec=ds[x];for(prop in rec){if(rec.hasOwnProperty(prop)){guess=this._guessBindingName(rec,prop);if(guess&&!this._fieldExists(prop,schema)&&allFields.indexOf(guess)>-1){camelCase=this._toCamelCase(guess);bindingName=this._getBindingName(guess);fieldType=this._calcFieldType(guess);schema.fields.push({name:prop,type:fieldType});schema[bindingName]={name:prop,type:fieldType};schema[camelCase]={name:prop,type:fieldType};opt.bindings[bindingName]=prop;allFields.removeAt(allFields.indexOf(guess))}}}}if(addAll){for(x=0;x<allFields.length;++x){name=allFields[x];if(!this._fieldExists(name,schema)){camelCase=this._toCamelCase(name);bindingName=this._getBindingName(name);fieldType=this._calcFieldType(name);schema.fields.push({name:name,type:fieldType});schema[bindingName]={name:name,type:fieldType};opt.bindings[bindingName]=name}}}this._trigger(this.events.schemaGenerated,null,{owner:this,schema:schema,dataSource:ds})}return schema},_toCamelCase:function(val){return val.substr(0,1).toLowerCase()+val.substr(1,val.length-1)},_calcFieldType:function(name){if(name==="Count"){return"number"}if(name==="IsDivider"){return"bool"}return"string"},_getBindingName:function(name){name=this._toCamelCase(name);if(name.indexOf("Key")!==-1){return name}return name+"Key"},_guessBindingName:function(rec,prop){var val=rec[prop];if(prop==="Text"){return"Text"}if(prop==="NavigateUrl"){return"NavigateUrl"}if(prop==="ImageUrl"){return"ImageUrl"}if(prop==="Count"){return"Count"}if(prop==="Description"){return"Description"}if(prop==="Header"){return"Header"}if(prop==="DetailsTitle"){return"DetailsTitle"}if(prop==="IsDivider"){return"IsDivider"}if(prop==="PrimaryKey"){return"PrimaryKey"}if($.type(val)==="string"){if(val.indexOf(".gif")>-1||val.indexOf(".png")>-1||val.indexOf(".jpg")>-1){return"ImageUrl"}if(val.indexOf("http://")===0||val.indexOf(".htm")>-1||val.indexOf(".aspx")>-1){return"NavigateUrl"}return"Text"}if($.type(val)==="number"){return"Count"}if($.type(val)==="boolean"){return"IsDivider"}return null},_fieldExists:function(prop,schema){var i;for(i=0;i<schema.fields.length;i++){if(schema.fields[i].name===prop){return true}}return false},_onDataBound:function(success,errmsg){var listElement=this.element,noCancel=true,isUlOl=false,noCancelError=true;if(success===false){noCancelError=this._trigger(this.events.requestError,null,{owner:this,message:errmsg});if(noCancelError){throw new Error(errmsg)}}this._trigger(this.events.dataBound,null,{owner:this});noCancel=this._trigger(this.events.dataRendering,null,{owner:this,listElement:listElement});if(noCancel){if(this._requireRecordsClear&&!(this.options.dataSource&&this.options.dataSource.tagName&&($(this.options.dataSource).is("ul")||$(this.options.dataSource).is("0l")))){listElement=this._cleanupList()}else{isUlOl=true}delete this._requireRecordsClear;if(!this._initialized){if(!this.options.bindings){this.options.schema=this._generateBindings(this.dataSource.dataView(),this.dataSource.type()!=="remoteUrl")}if(isUlOl){listElement.empty()}}delete this._dataBinding;this._renderData();this.dataSource.settings.paging.appendPage=true;$.mobile.hidePageLoadingMsg();this._trigger(this.events.dataRendered,null,{owner:this})}if(this.options.dataSourceUrl!==null&&this._firstBind){this.options.dataSource=this.options.dataSourceUrl;this.dataSource.settings.dataSource=this.options.dataSourceUrl;this.dataSource.settings.type="remoteUrl";this.dataSource._runtimeType=this.dataSource.analyzeDataSource();this._firstBind=false}if(!this._initialized){this._initialized=true}},_cleanupList:function(){var list=this.listElement;if($.mobile.igListView&&$.mobile.igListView.speedupDOMCleanup===false){list.empty()}else{if(list.children().length>0){this.listElement[0].innerHTML=""}}return list},_renderData:function(){var self=this,i=0,hasSubPages=false,listElement=this.listElement,noCancel=false,ds=this.dataSource.dataView(),dsCount=ds?ds.length:0,items="",opts=this.options,bindings=this.options.bindings,css=this.css,dns="data-"+$.mobile.ns,args,val,liAtts,hasSubPage,liClass,hyperLink,wrapperDivStart,wrapperDivEnd,arrow,isEmpty=true;if(this._requireRecordsClear){listElement=this._cleanupList();delete this._requireRecordsClear}args={owner:this,items:items,index:i,listElement:listElement,dataView:ds};noCancel=this._trigger(this.events.itemsRendering,null,args);if(noCancel){items=args.items;if(bindings&&(bindings.primaryKey===null||bindings.primaryKey===undefined)){bindings.primaryKey="ig_pk"}if(self.options.itemTemplate){for(i=args.index;i<dsCount;++i){val=ds[i];liAtts=dns+"idx='"+i+"'";isEmpty=false;if(bindings.primaryKey!=="ig_pk"){liAtts+=" "+dns+"id='"+val[bindings.primaryKey]+"'"}else{liAtts+=" "+dns+"id='"+this._getVal(val)+"'"}hasSubPage=this._hasSubPage(val);hasSubPages=hasSubPages||hasSubPage;if(hasSubPage){liAtts+=' subPage="false"'}items+="<li ' class='"+css.baseListItem+"' "+liAtts+">"+$.ig.tmpl(self.options.itemTemplate,val,{})+"</li>";args={owner:this,items:items,index:i,listElement:listElement,dataView:ds,value:val};this._trigger("_itemRendered",null,args);items=args.items;items=items.replace("{EXTRACSS}","")}}else{for(i=args.index;i<dsCount;++i){val=ds[i];liClass=css.baseListItem;isEmpty=false;if(val[bindings.isDividerKey]===true){hyperLink="{TEXT}{COUNT}";liAtts="";wrapperDivStart="";wrapperDivEnd="";arrow="";liClass=css.listDivider;if(i===dsCount-1||ds[i+1][bindings.isDividerKey]===true){continue}if(val[bindings.textKey]!==null&&val[bindings.textKey]!==undefined){hyperLink=hyperLink.replace("{TEXT}",val[bindings.textKey])}else{hyperLink=hyperLink.replace("{TEXT}","")}if(val[bindings.countKey]!==null&&val[bindings.countKey]!==undefined){liClass+=" "+css.liHasCount;hyperLink=hyperLink.replace("{COUNT}","<span class='"+css.count+"'>"+val[bindings.countKey]+"</span>")}else{hyperLink=hyperLink.replace("{COUNT}","")}}else{hyperLink="<div class='ui-btn-text'><a {HREF} class='ui-link-inherit ui-link'>{IMG}{HEAD}{DESC}{TEXT}{COUNT}</a></div>";liAtts=dns+"idx='"+i+"'";hasSubPage=this._hasSubPage(val);hasSubPages=hasSubPages||hasSubPage;if(bindings.primaryKey!=="ig_pk"){liAtts+=" "+dns+"id='"+val[bindings.primaryKey]+"'"}else{liAtts+=" "+dns+"id='"+this._getVal(val)+"'"}if(val[bindings.navigateUrlKey]||hasSubPage){liClass+=" "+css.liIconRight;if(hasSubPage){liAtts+=' subPage="false"';hyperLink=hyperLink.replace("{HREF} ","")}else{hyperLink=hyperLink.replace("{HREF} ","href='"+val[bindings.navigateUrlKey]+"'")}arrow="<span class='ui-icon ui-icon-arrow-r ui-icon-shadow'></span>";wrapperDivStart="<div class='ui-li ui-btn-inner'>";wrapperDivEnd="</div>"}else{liClass=css.readOnlyListItem;hyperLink="{IMG}{HEAD}{DESC}{TEXT}{COUNT}";arrow="";wrapperDivStart="";wrapperDivEnd=""}if(bindings.descriptionKey&&val[bindings.descriptionKey]!==null&&val[bindings.descriptionKey]!==undefined){hyperLink=hyperLink.replace("{DESC}","<p class='ui-li-desc'>"+val[bindings.descriptionKey]+"</p>")}else{hyperLink=hyperLink.replace("{DESC}","")}if(opts.itemHeaderSize!=="none"&&val[bindings.headerKey]!==null&&val[bindings.headerKey]!==undefined){hyperLink=hyperLink.replace("{HEAD}","<"+opts.itemHeaderSize+" class='ui-li-heading'>"+val[bindings.headerKey]+"</"+opts.itemHeaderSize+">")}else{hyperLink=hyperLink.replace("{HEAD}","")}if(val[bindings.textKey]!==null&&val[bindings.textKey]!==undefined){hyperLink=hyperLink.replace("{TEXT}",val[bindings.textKey])}else{hyperLink=hyperLink.replace("{TEXT}","")}if(opts.showCount&&val[bindings.countKey]!==null&&val[bindings.countKey]!==undefined){liClass+=" "+css.liHasCount;hyperLink=hyperLink.replace("{COUNT}","<span class='"+css.count+"'>"+val[bindings.countKey]+"</span>")}else{hyperLink=hyperLink.replace("{COUNT}","")}if(opts.imageMode!=="none"&&bindings.imageUrlKey){if(val[bindings.imageUrlKey]!==undefined&&val[bindings.imageUrlKey]!==null&&val[bindings.imageUrlKey].length>0){if(opts.imageMode==="thumbnail"){liClass+=" "+css.liHasThumb;hyperLink=hyperLink.replace("{IMG}","<img src='"+val[bindings.imageUrlKey]+"' class='"+css.imageThumb+"' />")}else{liClass+=" "+css.liHasIcon;hyperLink=hyperLink.replace("{IMG}","<img src='"+val[bindings.imageUrlKey]+"' class='"+css.imageIcon+"' />")}}else{if(opts.imageMode==="thumbnail"){liClass+=" "+css.liHasThumb;hyperLink=hyperLink.replace("{IMG}","<div class='"+css.imageThumb+"'/>")}else{liClass+=" "+css.liHasIcon;hyperLink=hyperLink.replace("{IMG}","<div class='"+css.imageIcon+"'/>")}}}else{hyperLink=hyperLink.replace("{IMG}","")}}items+="<li class='"+liClass+"{EXTRACSS}'"+liAtts+">"+wrapperDivStart+hyperLink+arrow+wrapperDivEnd+"</li>";args={owner:this,items:items,index:i,listElement:listElement,dataView:ds,value:val};this._trigger("_itemRendered",null,args);items=args.items;items=items.replace("{EXTRACSS}","")}}if(items.length===0&&isEmpty){items="<li class='ui-li ui-li-static ui-body-c'>"+this._locale("emptyListText")+"</li>"}if(this._loadOnDemand){listElement.append(items)}else{listElement.html(items)}if(opts.inset){listElement.children().first().addClass("ui-corner-top").find(".ui-btn-inner").not(".ui-li-link-alt span:first-child").addClass("ui-corner-top").end().end().find(".ui-li-thumb").not(".ui-li-icon").addClass("ui-corner-tl").end().end().end().last().addClass("ui-corner-bottom").find(".ui-btn-inner").not(".ui-li-link-alt span:first-child").addClass("ui-corner-bottom").end().end().find(".ui-li-thumb").not(".ui-li-icon").addClass("ui-corner-bl")}this._trigger(this.events.itemsRendered,null,{owner:this,hasSubPages:hasSubPages})}},_hasSubPage:function(){return this.options.itemDetailsTemplate!==undefined&&this.options.itemDetailsTemplate!==null&&this.options.itemDetailsTemplate.length>0},_listTap:function(evnt){var li=evnt.target,$li,index,flatDataSource=this.dataSource.dataView(),dataItem,newPage;while(li&&(li.tagName!=="LI"||li.className.indexOf("ui-li-divider")!==-1)){li=li.parentNode}if(li===null){return}$li=$(li);index=parseInt($li.jqmData("idx"),10);dataItem=flatDataSource[index];if(li.getAttribute("subPage")==="false"){newPage=this._createSubPage(dataItem,$li,index);if(newPage){$.mobile.changePage(newPage,{transition:"slide"});if($li.find("a").length===0){$li.attr("subPage","noLink").data("newPage",newPage)}else{$li.attr("subPage","true").find("a").first().attr("href",newPage.jqmData("url"))}}}else{if(li&&(li.getAttribute("subPage")==="noLink")){$.mobile.changePage($(li).data("newPage"),{transition:"slide"})}}},_createSubPageContent:function(dataItem,listItem){var items=$(null);if(this.options.itemDetailsTemplate){items[0]=$("<div class='"+this.css.detailsTemplate+"'></div>").append($.ig.tmpl(this.options.itemDetailsTemplate,dataItem,{}))[0];items.length=1}return items},_createSubPage:function(dataItem,listItem,index){var parentPage=this.element.closest(".ui-page"),parentUrl=parentPage.jqmData("url"),parentListId=$(this.element).attr("id"),dns="data-"+$.mobile.ns,persistentFooterID=parentPage.find(":jqmData(role='footer')").jqmData("id"),title=this._locale("detailsLabel"),subItems,id=(parentUrl||"")+"&"+$.mobile.subPageUrlKey+"="+parentListId+"-"+this.options.bindings.primaryKey+"/"+dataItem[this.options.bindings.primaryKey],newPage,opts=this.options,backBtn,args,noCancel;if((newPage=$(":jqmData(url='"+id+"')")).length>0){return newPage}if(this.options.bindings&&this.options.bindings.detailsTitleKey&&dataItem[this.options.bindings.detailsTitleKey]){title=dataItem[this.options.bindings.detailsTitleKey]}newPage=null;args={owner:this,subPageTitle:title,extraContents:$("<div>")};noCancel=this._trigger(this.events.subPageCreating,null,args);if(noCancel){title=args.subPageTitle;subItems=this._createSubPageContent(dataItem,listItem);backBtn=$("<a>").css("zIndex",1).text(this._locale("goBackLabel")).bind("click",function(){window.history.back()}).buttonMarkup({inline:true,theme:opts.subPageHeaderTheme});newPage=$("<div "+dns+"role='content'></div>").wrap("<div "+dns+"role='page' "+dns+"url='"+id+"' "+dns+"theme='"+opts.itemTheme+"' "+dns+"count-theme='"+opts.countTheme+"'></div>").append(subItems).append(args.extraContents.children()).before($("<div "+dns+"role='header' "+dns+"theme='"+opts.subPageHeaderTheme+"'><div class='ui-title'>"+title+"</div></div>").prepend(backBtn)).after(persistentFooterID?$("<div "+dns+"role='footer' "+dns+"id='"+persistentFooterID+"'>"):"").parent().appendTo($.mobile.pageContainer);newPage.page();args={owner:this,subPage:newPage};this._trigger(this.events.subPageCreated,null,args)}return newPage},_setupDataSource:function(dataOptions){if(!(this.options.dataSource instanceof $.ig.DataSource)){if($.type(dataOptions.dataSource)==="string"&&dataOptions.dataSource.indexOf("$callback=?")!==-1){this.dataSource=new $.ig.JSONPDataSource(dataOptions)}else{this.dataSource=new $.ig.DataSource(dataOptions)}}else{this.dataSource=this.options.dataSource;if(this.dataSource.settings.responseDataKey!==null){delete dataOptions.responseDataKey;if(dataOptions.schema){dataOptions.schema.searchField=this.dataSource.settings.responseDataKey}}this._tds=this.dataSource.settings.dataSource;this.dataSource.settings.dataSource=null;this.dataSource.settings=$.extend(true,{},this.dataSource.settings,dataOptions);this.dataSource.settings.dataSource=this._tds;this._tds=null;if(dataOptions.schema){this.dataSource._initSchema()}}},_getVal:function(data){var val;if(data.ig_pk){val=data.ig_pk}else{val=$.ig.uid();data.ig_pk=val}return val},_inferOpType:function(){if(this.options.dataSourceUrl||this.dataSource.type()==="remoteUrl"){return"remote"}return"local"},destroy:function(){var prev=this.container().prev(),i;for(i=0;i<this.options.features.length;i++){if(this.options.features[i].name&&this.element.data("igListView"+this.options.features[i].name)){$("#"+this.element[0].id)["igListView"+this.options.features[i].name]("destroy")}}if(prev.length===0){prev=this.container().parent()}this.listElement.empty();prev.append(this.element);this.element.attr("data-level",null).removeClass(this.css.igList+" "+this.css.baseList+" "+this.css.insetList);$.Widget.prototype.destroy.call(this);this.container().remove();this.element.removeData("igFlatList")}});if(typeof define==="function"&&define.amd&&define.amd.jQuery){define("ig.mobileui.flatlist",["ig.util","ig.datasource"],function(){return $.mobile.igList})}$.widget("mobile.igListView",$.mobile.widget,{css:{},options:{initialDataBindDepth:-1,odata:false,defaultChildrenDataProperty:"Children",pathSeparator:"/",autoGenerateLayouts:false,childLayout:{key:null},initSelector:":jqmData(role='iglistview')"},events:{childrenPopulating:"childrenPopulating",childrenPopulated:"childrenPopulated"},_create:function(){var tmpSource;this._regevents(this.element,this);this.options=$.extend(true,{},$.mobile.igList.prototype.options,this.options);if(this.options._fromHtml&&this.options.dataSource){try{tmpSource=this.options.dataSource;this.options.dataSource=eval(this.options.dataSource)}catch(exc){this.options.dataSource=tmpSource}if(this.options.dataSource===undefined&&tmpSource){this.options.dataSource=tmpSource}}if(this.tmpDataSource!==null&&this.tmpDataSource!==undefined){this.options.dataSource=this.tmpDataSource;this._originalOptions.dataSource=this.tmpDataSource}$("<div>").buttonMarkup();this.dataBind()},_createWidget:function(options,element){this.options.features=[];this.options.childLayout=null;if($.mobile.igList.prototype.options.bindings!==null&&$.mobile.igList.prototype.options.bindings!==undefined){_originalBindings=$.mobile.igList.prototype.options.bindings}$.mobile.igList.prototype.options.bindings=null;if(options&&options.dataSource&&($.type(options.dataSource)==="array"||$.type(options.dataSource)==="object")){this.tmpDataSource=options.dataSource;options.dataSource=null;this._originalOptions=options}$.Widget.prototype._createWidget.apply(this,arguments)},dataBind:function(){var hds,hdsoptions,rootds,opts;if(this.options.autoGenerateLayouts){this._generateLayouts()}hdsoptions=this._hdsoptions();hds=new $.ig.HierarchicalDataSource(hdsoptions);this._hds=hds;rootds=this._hds.root();this._tmpds=this.options.dataSource;this.options.dataSource=null;opts=$.extend(true,{},this.options);this.options.dataSource=this._tmpds;this._tmpds=null;opts.dataSource=rootds;if($.type(hdsoptions.dataSource)==="string"){opts.dataSourceUrl=hdsoptions.dataSource}this.element.attr("data-level",0);if(this._root){this._root.igList("option","dataSource",opts.dataSource)}else{opts._hParent=this;this._root=this.element.igList(opts)}},root:function(){return this._root},rootWidget:function(){return this.root().data("igFlatList")},_layouts:function(){this.element.unbind("ig_flatlistdatarendering",this._databoundHandler)},_hdsoptions:function(){var opts,schema,lists;if(!this.options.dataSource&&!this.options.dataSourceUrl){if(!this.element.is("ul")&&!this.element.is("ol")){lists=this.element.children("ul,ol");this.options.dataSource=lists[0]}else{this.options.dataSource=this.element[0]}}else{if(!this.options.dataSource&&this.options.dataSourceUrl){this.options.dataSource=this.options.dataSourceUrl}}opts={responseDataKey:this.options.responseDataKey,responseTotalRecCountKey:this.options.responseTotalRecCountKey,dataSource:this.options.dataSource,localSchemaTransform:this.options.localSchemaTransform,odata:this.options.odata,initialDataBindDepth:this.options.initialDataBindDepth};if(this.options.bindings&&this.options.bindings.primaryKey){opts.primaryKey=this.options.bindings.primaryKey}if(this.options.dataSourceType!==null){opts.type=this.options.dataSourceType}schema=this._hschema();if((this.options.dataSource instanceof $.ig.HierarchicalDataSource&&this.options.dataSource.settings.schema===null)||!(this.options.dataSource instanceof $.ig.HierarchicalDataSource)){opts=$.extend(opts,{schema:schema})}return opts},_hschema:function(){var schema={},ds=this.options.dataSource,opt=this.options,bindings=opt.bindings,guess,x,prop,rec,name,camelCase,bindingName,fieldType,allFields=["Text","NavigateUrl","ImageUrl","Count","Description","Header","DetailsTitle","IsDivider"];schema.fields=[];schema.searchField=this.options.responseDataKey;if(bindings===null){if(ds&&((ds.length&&ds.length>0&&$.type(ds)==="array")||(ds.tagName&&(ds.tagName.toLowerCase()==="ul"||ds.tagName.toLowerCase()==="ol")))){opt.bindings={};for(x=0;x<ds.length;++x){rec=ds[x];for(prop in rec){if(rec.hasOwnProperty(prop)){guess=this._guessBindingName(rec,prop);if(guess&&!this._fieldExists(prop,schema)&&allFields.indexOf(guess)>-1){camelCase=this._toCamelCase(guess);bindingName=this._getBindingName(guess);fieldType=this._calcFieldType(guess);schema.fields.push({name:prop,type:fieldType});schema[bindingName]={name:prop,type:fieldType};schema[camelCase]={name:prop,type:fieldType};opt.bindings[bindingName]=prop;allFields.removeAt(allFields.indexOf(guess))}}}}for(x=0;x<allFields.length;++x){name=allFields[x];if(!this._fieldExists(name,schema)){camelCase=this._toCamelCase(name);bindingName=this._getBindingName(name);fieldType=this._calcFieldType(name);schema.fields.push({name:name,type:fieldType});schema[bindingName]={name:name,type:fieldType};schema[camelCase]={name:name,type:fieldType};opt.bindings[bindingName]=name}}if(this.options.childLayout){schema.childDataProperty={name:this.options.childLayout.key,type:"object"};schema.childData={name:this.options.childLayout.key,type:"object"}}else{if(ds&&ds.tagName&&(ds.tagName.toLowerCase()==="ul"||ds.tagName.toLowerCase()==="ol")){schema.childDataProperty={name:"Children",type:"object"};schema.childData={name:"Children",type:"object"}}}}return schema}if(opt.dataSourceType==="xml"){schema.fields=[];if(bindings.textKey){schema.fields.push({name:bindings.textKey,xpath:bindings.textXPath});schema.textKey=bindings.textKey}if(bindings.navigateUrlKey){schema.fields.push({name:bindings.navigateUrlKey,xpath:bindings.navigateUrlXPath});schema.navigateUrlKey=bindings.navigateUrlKey}if(bindings.imageUrlKey){schema.fields.push({name:bindings.imageUrlKey,xpath:bindings.imageUrlXPath});schema.imageUrlKey=bindings.imageUrlKey}if(bindings.countKey){schema.fields.push({name:bindings.countKey,xpath:bindings.countXPath});schema.countXPath=bindings.countKey}if(bindings.headerKey){schema.fields.push({name:bindings.headerKey,xpath:bindings.headerXPath});schema.headerXPath=bindings.headerKey}if(bindings.descriptionKey){schema.fields.push({name:bindings.descriptionKey,xpath:bindings.descriptionXPath});schema.descriptionXPath=bindings.descriptionKey}if(bindings.searchFieldXPath){schema.searchField=bindings.searchFieldXPath}if(this.options.childLayout){schema.childDataProperty={name:this.options.childLayout.key,type:"object"};schema.childData={name:this.options.childLayout.key,type:"object"}}return schema}schema.fields=[];if(bindings.primaryKey){schema.fields.push({name:bindings.primaryKey,type:"string"});schema.primaryKeyKey=bindings.primaryKey}if(bindings.textKey){schema.fields.push({name:bindings.textKey,type:"string"});schema.textKey=bindings.textKey}if(bindings.navigateUrlKey){schema.fields.push({name:bindings.navigateUrlKey,type:"string"});schema.navigateUrlKey=bindings.navigateUrlKey}if(bindings.imageUrlKey){schema.fields.push({name:bindings.imageUrlKey,type:"string"});schema.imageUrlKey=bindings.imageUrlKey}if(bindings.countKey){schema.fields.push({name:bindings.countKey,type:"number"});schema.countKey=bindings.countKey}if(bindings.headerKey){schema.fields.push({name:bindings.headerKey,type:"string"});schema.headerKey=bindings.headerKey}if(bindings.descriptionKey){schema.fields.push({name:bindings.descriptionKey,type:"string"});schema.descriptionKey=bindings.descriptionKey}if(bindings.isDividerKey){schema.fields.push({name:bindings.isDividerKey,type:"bool"});schema.isDividerKey=bindings.isDividerKey}if(this.options.childLayout){schema.childDataProperty={name:this.options.childLayout.key,type:"object"};schema.childData={name:this.options.childLayout.key,type:"object"}}return schema},_toCamelCase:function(val){return val.substr(0,1).toLowerCase()+val.substr(1,val.length-1)},_calcFieldType:function(name){if(name==="Count"){return"number"}if(name==="IsDivider"){return"bool"}return"string"},_getBindingName:function(name){name=this._toCamelCase(name);if(name.indexOf("Key")!==-1){return name}return name+"Key"},_guessBindingName:function(rec,prop){var val=rec[prop];if(prop==="Text"){return"Text"}if(prop==="NavigateUrl"){return"NavigateUrl"}if(prop==="ImageUrl"){return"ImageUrl"}if(prop==="Count"){return"Count"}if(prop==="Description"){return"Description"}if(prop==="Header"){return"Header"}if(prop==="DetailsTitle"){return"DetailsTitle"}if(prop==="IsDivider"){return"IsDivider"}if(prop==="PrimaryKey"){return"PrimaryKey"}if($.type(val)==="string"){if(val.indexOf(".gif")>-1||val.indexOf(".png")>-1||val.indexOf(".jpg")>-1){return"ImageUrl"}if(val.indexOf("http://")===0||val.indexOf(".htm")>-1||val.indexOf(".aspx")>-1){return"NavigateUrl"}return"Text"}if($.type(val)==="number"){return"Count"}if($.type(val)==="boolean"){return"IsDivider"}return null},_fieldExists:function(prop,schema){var i;for(i=0;i<schema.fields.length;i++){if(schema.fields[i].name===prop){return true}}return false},_parseLayouts:function(layouts,cpath,options){var layout,p,cdp=null;if(options.childLayout){layout=options.childLayout;cdp=layout.key;if(!cdp){cdp=this.options.defaultChildrenDataProperty}p=cpath+this.options.pathSeparator+cdp+":";if(layout.bindings&&layout.bindings.primaryKey){p+=layout.bindings.primaryKey}else{p+="ig_pk"}layouts[p]=layout;this._parseLayouts(layouts,p,layout)}},_optsFor:function(popts){var i,o=[],layout;if(popts.childLayout){layout=popts.childLayout;this._inherit(popts,layout);o.push($.extend(true,{},$.mobile.igList.prototype.options,layout))}if(popts.dataSourceUrl){for(i=0;i<o.length;i++){if(!o[i].dataSource){o[i].dataSourceUrl=popts.dataSourceUrl}else{o[i].dataSourceUrl=o[i].dataSource}}}return o[0]},_inherit:function(parent,child){if(parent.dataSourceType&&!child.dataSourceType){child.dataSourceType=parent.dataSourceType}},_schemaGenerated:function(evnt,args){var hList,i,rec,schema=args.schema,ds=args.dataSource,$this=args.owner,prop,child;hList=$this.options._hParent;if(this.options.dataSource&&this.options.dataSource.tagName&&(this.options.dataSource.tagName.toLowerCase()==="ul"||this.options.dataSource.tagName.toLowerCase()==="ol")&&($this.options.childLayout===null||$this.options.childLayout===undefined)){child=$this.options.childLayout={};child.key="Children"}if(!hList||hList.options.initialDataBindDepth>-1){return}for(i=0;ds&&ds.length&&$.type(ds)==="array"&&i<ds.length;i++){rec=ds[i];for(prop in rec){if(rec.hasOwnProperty(prop)){if(!$this._fieldExists(prop,schema)&&($.type(rec[prop])==="array"||$.type(rec[prop])==="object")){schema.fields.push({name:prop,type:$.ig.getColType(rec[prop])})}}}}},_hierarchicalHasSubPage:function(val){var self=this,opts=this.options,hList=opts._hParent,hasSubPage,childprop,layout,lod;hasSubPage=opts.itemDetailsTemplate!==null&&opts.itemDetailsTemplate.length>0;if(!hasSubPage&&opts.childLayout!==null&&opts.childLayout!==undefined){lod=hList.options.initialDataBindDepth>-1;if(!lod){if(val[opts.childLayout.key]){childprop=opts.childLayout.key;layout=opts.childLayout}childprop=childprop||self.options.defaultChildrenDataProperty;if(childprop){if(layout&&layout.responseDataKey){if(val[childprop]&&val[childprop][layout.responseDataKey]&&val[childprop][layout.responseDataKey].length!==undefined&&val[childprop][layout.responseDataKey].length>0){hasSubPage=true}}else{if(val[childprop]&&val[childprop].length!==undefined&&val[childprop].length>0){hasSubPage=true}}}}else{hasSubPage=true}}return hasSubPage},_hierarchicalCreateSubPageContent:function(dataItem,listItem){var items=this._flatCreateSubPageContent(dataItem,listItem),parent=listItem.closest(".ig-listview").data("igFlatList"),parentOptions=parent.options,hList=this,cOpts,keyspath="",itemId="",parentListItem=parentOptions._parent,ds,childds,sp,childList,parentLevel,level,keyspathvar,isHierarchical,tmplist,tmpkey,pki,rootId,aList,noCancel,result;if(hList.root()&&hList.root().length>0){rootId=hList.root()[0].id}if(parentOptions.childLayout!==undefined&&parentOptions.childLayout!==null){cOpts=hList._optsFor(parentOptions);result=hList._getChildDataSource(parentOptions,cOpts,listItem,parentListItem,aList);itemId=result.itemId;keyspathvar=result.keyspathvar;keyspath=result.keyspath;if(!rootId&&aList){rootId=aList.element.id}else{if(!rootId){rootId=parent.element.id}}childList=$("<div></div>").attr("id",rootId+"_"+listItem.attr("data-id")+"_"+cOpts.key+"_child");parentLevel=parseInt(parent.element.attr("data-level"),10);childList.attr("id",childList.attr("id").replace(",","-")).attr("data-level",parentLevel+1);childds=hList._hds.dataAt(itemId,keyspath+keyspathvar);if($.type(childds)!=="array"&&!cOpts.responseDataKey&&childds!==undefined){childds=[childds]}else{if(childds===null||childds===undefined){childds=[]}}isHierarchical=false;if(cOpts.childLayout){isHierarchical=true}if(hList._hds.settings.dataSource.tagName&&(hList._hds.settings.dataSource.tagName.toLowerCase()==="ul"||hList._hds.settings.dataSource.tagName.toLowerCase()==="ol")){isHierarchical=true}if(isHierarchical){hList._regevents(childList,hList)}cOpts._parent=listItem;cOpts._hParent=hList;level=itemId.split(parentOptions.pathSeparator).length;if(level>this.options.initialDataBindDepth&&this.options.initialDataBindDepth!==-1){sp=true}ds=hList._hdsoptions().dataSource;if(!sp){cOpts.dataSource=childds;if($.type(ds)==="string"){cOpts.dataSourceUrl=ds}if(cOpts.dataSourceUrl&&$.type(cOpts.dataSourceUrl)==="string"){if(cOpts.dataSourceUrl.indexOf("?")!==-1){cOpts.dataSourceUrl+="&"+hList._hds._encodeUrlPath(itemId,cOpts.key)}else{cOpts.dataSourceUrl+="?"+hList._hds._encodeUrlPath(itemId,cOpts.key)}}childList.igList(cOpts);if(cOpts.bindings===null||cOpts.bindings===undefined||cOpts.bindings.primaryKey===null||cOpts.bindings.primaryKey===undefined){tmplist=childList.data("igFlatList");tmpkey=tmplist.dataSource.schema().schema.searchField;if(tmpkey!==null){for(pki=0;pki<cOpts.dataSource[tmpkey].length;pki++){cOpts.dataSource[tmpkey][pki].ig_pk=tmplist.dataSource.data()[pki].ig_pk}}else{for(pki=0;pki<cOpts.dataSource.length;pki++){if(cOpts.dataSource[pki]){cOpts.dataSource[pki].ig_pk=tmplist.dataSource.data()[pki].ig_pk}}}}}else{if(ds instanceof $.ig.DataSource){if(this.options.odata){childds=hList._hds.dataAt(itemId,keyspath+keyspathvar);if(childds.__deferred&&childds.__deferred.uri){cOpts.dataSource=childds.__deferred.uri;if(ds.settings.dataSource.indexOf("$callback=?")!==-1){cOpts.dataSource+="?$callback=?"}if(ds.settings.dataSource.indexOf("$format=")!==-1){if(ds.settings.dataSource.indexOf("$format=json")!==-1){cOpts.dataSource+="&$format=json"}else{cOpts.dataSource+="&$format=atom"}}}}else{cOpts.dataSource=ds.settings.dataSource+"?"+hList._hds._encodeUrlPath(itemId,cOpts.key)}}else{if(cOpts.dataSourceUrl){if(cOpts.dataSourceUrl.indexOf("?")!==-1){cOpts.dataSourceUrl+="&"+hList._hds._encodeUrlPath(itemId,cOpts.key)}else{cOpts.dataSourceUrl+="?"+hList._hds._encodeUrlPath(itemId,cOpts.key)}cOpts.dataSource=cOpts.dataSourceUrl;cOpts.dataSourceType="remoteUrl"}else{if($.type(cOpts.dataSource)==="string"&&$.type(ds)!=="string"){if(cOpts.dataSource.indexOf("?")===-1){cOpts.dataSource+="?"+hList._hds._encodeUrlPath(itemId,cOpts.key)}else{cOpts.dataSource+="&"+hList._hds._encodeUrlPath(itemId,cOpts.key)}cOpts.dataSourceType="remoteUrl"}else{if($.type(ds)==="string"){if(cOpts.dataSource.indexOf("?")===-1){cOpts.dataSource+="?"+hList._hds._encodeUrlPath(itemId,cOpts.key)}else{cOpts.dataSource+="&"+hList._hds._encodeUrlPath(itemId,cOpts.key)}}else{cOpts.dataSource=childds}}}}}if(sp){noCancel=this._trigger(this.events.childrenPopulating,null,{owner:this,parentitem:listItem,id:itemId});if(noCancel){childList.igList(cOpts);this._trigger(this.events.childrenPopulated,null,{owner:this,parentitem:listItem,id:itemId})}}items[items.length++]=childList.parent()[0]}return items},_getChildDataSource:function(parentOptions,cOpts,listItem,parentListItem,aList){var itemId="",keyspath="",keyspathvar="",o,k,curpath=0,hOpts=this.options;if(parentOptions.key){keyspath=parentOptions.key}while(parentListItem){if(curpath!==0){itemId+=hOpts.pathSeparator}aList=parentListItem.closest(".ig-listview").data("igFlatList");o=parentListItem.closest(".ig-listview").data("igFlatList").options;k=o.bindings.primaryKey;itemId+=k+":"+parentListItem.attr("data-id");if(o.key){keyspath+=hOpts.pathSeparator+o.key}parentListItem=o._parent;curpath++}keyspath=keyspath.split(hOpts.pathSeparator).reverse().join(hOpts.pathSeparator);itemId=itemId.split(hOpts.pathSeparator).reverse().join(hOpts.pathSeparator);k=parentOptions.bindings.primaryKey;if(itemId===""){itemId=k+":"+listItem.attr("data-id")}else{itemId+=hOpts.pathSeparator+k+":"+listItem.attr("data-id")}if(keyspath===""){keyspathvar=cOpts.key}else{keyspathvar=hOpts.pathSeparator+cOpts.key}return{itemId:itemId,keyspath:keyspath,keyspathvar:keyspathvar}},_listInitialized:function(event,args){args.owner._hasSubPage=$.proxy(this._hierarchicalHasSubPage,args.owner);this._flatCreateSubPageContent=$.proxy(args.owner._createSubPageContent,args.owner);args.owner._createSubPageContent=$.proxy(this._hierarchicalCreateSubPageContent,this)},_itemsRendered:function(evnt,args){var list=args.owner,hasSubPages=args.hasSubPages;if(hasSubPages&&!(list.options.itemDetailsTemplate!==undefined&&list.options.itemDetailsTemplate!==null&&list.options.itemDetailsTemplate.length>0)){list.element.bind("click",function(evnt){list._listTap(evnt)})}},_regevents:function(e,context){var schemaGenerated,cancelEvent,listInitialized,itemsRendered;schemaGenerated=$.proxy(this._schemaGenerated,context);e.bind("iglistschemagenerated",schemaGenerated);listInitialized=$.proxy(this._listInitialized,context);e.bind("iglistrenderingtray",listInitialized);itemsRendered=$.proxy(this._itemsRendered,context);e.bind("iglistitemsrendered",itemsRendered);cancelEvent=function(e){e.stopPropagation();e.preventDefault();return false}},_generateLayouts:function(){var rec,i,ds=this.options.dataSource;if(($.type(ds)!=="array"&&$.type(ds)!=="object")||ds.length===0){return}if($.type(ds)==="object"&&this.options.responseDataKey){ds=ds[this.options.responseDataKey]||ds}for(i=0;i<ds.length;i++){rec=ds[i];this._generateLayout(rec,this.options)}},_generateLayout:function(record,options){var name,layout,tmpLayout,i,rec,hasRespKey=false;for(name in record){if(record.hasOwnProperty(name)&&($.type(record[name])==="array"||($.type(record[name])==="object"&&options.responseDataKey&&$.type(record[name][options.responseDataKey])==="array"))){rec=record[name];if(options.responseDataKey&&$.type(rec)==="object"){if(rec[options.responseDataKey]&&$.type(rec[options.responseDataKey])==="array"){rec=rec[options.responseDataKey];hasRespKey=true}else{continue}}layout={key:name};if(hasRespKey){layout.responseDataKey=options.responseDataKey}tmpLayout=this._layoutExistsRecursive(this.options,name);if(!tmpLayout){if(options.childLayout===undefined||options.childLayout===null){options.childLayout=layout}}else{layout=tmpLayout}if(rec.length>0){for(i=0;i<rec.length;i++){this._generateLayout(rec[i],layout)}}}}},_layoutExistsRecursive:function(options,key){var tmpLayout=null;tmpLayout=options.key===key?options:tmpLayout;if(!tmpLayout&&options.childLayout){tmpLayout=this._layoutExistsRecursive(options.childLayout,key)}return tmpLayout},destroy:function(){this.tmpDataSource=null;this.rootWidget().destroy();$.Widget.prototype.destroy.call(this)}});function _addDash(c){return"-"+c.toLowerCase()}function parseBindings(element,options){var added=false,nullAtStart=false,binding,value,bindingsPrototype=$.mobile.igList.prototype.options.bindings;if(!options.bindings){nullAtStart=true;options.bindings={}}if(!bindingsPrototype){bindingsPrototype=_originalBindings}for(binding in bindingsPrototype){if(bindingsPrototype.hasOwnProperty(binding)){value=element.jqmData("bindings-"+binding.replace(/[A-Z]/g,_addDash));if(value!==undefined){added=true;options.bindings[binding]=value}}}if(!added&&nullAtStart){options.bindings=null}}function parseSimpleProps(element,options,type){var option,value;for(option in type.prototype.options){if(type.prototype.options.hasOwnProperty(option)){value=element.jqmData(option.replace(/[A-Z]/g,_addDash));if(value!==undefined){options[option]=value}}}}function parseSimpleFlatListProps(element,options){var value;parseSimpleProps(element,options,$.mobile.igList);value=element.jqmData("key");if(value!==undefined){options.key=value}}function parseLevel(list,options,parse){var items,args,subList;if(parse===undefined){parse=true}items=list.children(":jqmData(role='itemTemplate')");if(items.length>0){options.itemTemplate=unescape(items.first().html())}items=list.children(":jqmData(role='detailsTemplate')");if(items.length>0){options.itemDetailsTemplate=unescape(items.first().html())}if(parse){parseSimpleFlatListProps(list,options);parseBindings(list,options);args={element:list,options:options};$(document).trigger("_igListViewHtmlOptions",args);options=args.options}subList=list.children("li").children("ul:jqmData(role='childLayout'), ol:jqmData(role='childLayout')");if(subList.length>0){options.childLayout={};parseLevel(subList,options.childLayout)}}function _igmListAutoInit(e){var target=document;if(e){target=e.target}$($.mobile.igListView.prototype.options.initSelector,target).each(function(i){var $this=$(this),optObj={_fromHtml:true},options=$this.jqmData("options"),list=$this,args,parseLevelOne=true;if($this.data("igListView")){return}if(options){try{optObj=eval(options)}catch(exc){try{optObj=$.parseJSON(options)}catch(exc2){optObj={}}}}if(!(list.is("ul")||list.is("ol"))){parseSimpleFlatListProps($this,optObj);parseBindings($this,optObj);args={element:list,options:optObj,listElement:list.children("ul,ol")};$(document).trigger("_igListViewHtmlOptions",args);parseLevelOne=false;list=list.children("ul,ol")}parseSimpleProps(list,optObj,$.mobile.igListView);parseLevel(list,optObj,parseLevelOne);$this.igListView(optObj)})}if($.ig&&$.ig.loader){$.ig.loader().preinit(_igmListAutoInit)}$(document).bind("pagecreate create",_igmListAutoInit);if(typeof define==="function"&&define.amd&&define.amd.jQuery){define("ig.mobileui.list",["ig.util","ig.datasource","ig.mobileui.flatlist"],function(){return $.mobile.igListView})}$.extend($.mobile.igListView,{version:"12.1.20121.1010"})}(jQuery));
/*
 * Infragistics.Web.MobileUI ListView Filtering 12.1.20121.1010
 *
 * Copyright (c) 2011-2012 Infragistics Inc.
 *
 * http://www.infragistics.com/
 *
 * Depends on:
 *  jquery-1.6.4.js
 *	jquery.ui.core.js
 *  ig.mobileui.list.js
 *	ig.dataSource.js
 *  ig.ui.shared.js
 *	ig.util.js
 */
(function($){$.widget("mobile.igListViewFiltering",$.mobile.widget,{css:{filterKeywordArea:"ui-iglist-filter-key-word-area",filterPresets:"ui-iglist-filter-presets",filterScopeOptions:"ui-iglist-keyword-scope-options",preset:"ui-btn-inline ui-iglist-preset",presetSelected:"ui-iglist-preset-selected",presetHidden:"ui-iglist-preset-hidden",keywordFooterText:"ui-iglist-tray-footer-item ig-tray-keyword",presetFooterText:"ui-iglist-tray-footer-item ig-tray-filter-preset",separatorFooterText:"ui-iglist-tray-footer-sep",keywordSearchScopeHidden:"ui-iglist-search-scope-hidden"},options:{type:null,caseSensitive:false,filterExprUrlKey:null,searchBarEnabled:true,searchBarFields:[{text:"",fieldName:"",condition:""}],searchBarFieldName:"",searchBarPlaceHolder:null,searchBarCondition:"contains",filteredFields:[{fieldName:"",searchValue:"",condition:"",logic:"AND"}],filterPresetsLabel:null,filterState:"default",presets:[{text:"",filteredFields:[{fieldName:"",searchValue:"",condition:"",logic:"AND"}]}]},events:{presetChanging:"presetChanging",presetChanged:"presetChanged",keywordChanging:"keywordChanging",keywordChanged:"keywordChanged",scopeChanging:"scopeChanging",scopeChanged:"scopeChanged"},_createWidget:function(){this.options.filteredFields=[];this.options.presets=[];this.options.searchBarFields=[];$.Widget.prototype._createWidget.apply(this,arguments)},_create:function(){var self=this;this._searchScopeTapHandler=function(evnt){var target=self.list._itemFromTarget(evnt.target,"li","idx"),$li,liLeft,liWidth,$div,divWidth,divScrollLeft,newLeft,noCancel,newName,index,fields,field,condition,x,args;if(target&&!target.hasAttribute("scoping")){$li=$(target);index=$li.attr("idx");if(index!=="all"){newName=self.options.searchBarFields[index].fieldName;condition=self.options.searchBarFields[index].condition;if(!condition){fields=self.list.dataSource.schema().fields();if(!fields||fields.length===0){fields=self.list.options.schema.fields}condition="contains";for(x=0;x<fields.length;++x){field=fields[x];if(field.name===newName){if(field.type==="number"||field.type==="date"){condition="equals"}break}}}}else{newName="";condition="contains"}args={scopeField:newName,condition:condition,owner:self};noCancel=self._trigger(self.events.scopeChanging,null,args);if(noCancel){liLeft=$li.offset().left;liWidth=$li.outerWidth();$div=$li.parent().parent();divWidth=$div.outerWidth();divScrollLeft=$div.scrollLeft();$li.attr("scoping",1).addClass(self.css.presetSelected).siblings().attr("scoping",null).removeClass(self.css.presetSelected);self.options.searchBarFieldName=args.scopeField;self.options.searchBarCondition=args.condition;if(liLeft+liWidth>divWidth){newLeft=divScrollLeft+liWidth;$div.animate({scrollLeft:newLeft},function(){self._refreshPresets($div)})}else{if(liLeft<0){newLeft=divScrollLeft-liWidth;$div.animate({scrollLeft:newLeft},function(){self._refreshPresets($div)})}}if(self._filterInput.val()!==""){$.mobile.showPageLoadingMsg();self._shouldFireScopeChanged=true;self._refilter()}else{self._trigger(self.events.scopeChanged,null,{scopeField:newName,owner:self})}}}};this._presetTapHandler=function(evnt){var target=self.list._itemFromTarget(evnt.target,"li","idx"),$li,state,noCancel;if(target&&!target.hasAttribute("filtered")){$li=$(target);state=$li.attr("idx");noCancel=self._trigger(self.events.presetChanging,null,{state:state,owner:self});if(noCancel){self._adjustFilterState(state,$li);$.mobile.showPageLoadingMsg();self._shouldFirePresetChanged=true;self._refilter()}}};this.css.preset=this.css.preset.replace("{0}","c")},_setOption:function(key,value){$.Widget.prototype._setOption.apply(this,arguments);if(key==="type"){throw new Error(this.list._locale("optionChangeNotSupported")+" "+key)}else{if(key==="caseSensitive"){this.list.dataSource.settings.filtering.caseSensitive=this.options.caseSensitive}else{if(key==="filterState"){this._adjustFilterState(value);this._refilter()}}}},_locale:function(key){var val=this.options[key];if(val===undefined||val===null){val=$.ig.mobileListViewFiltering&&$.ig.mobileListViewFiltering.locale?$.ig.mobileListViewFiltering.locale[key]:null}return val||""},_adjustFilterState:function(filterState,li){var self=this,liLeft,liWidth,$div,divWidth,divScrollLeft,newLeft;if(li===null||li===undefined){li=this.list.container().find("."+this.css.filterPresets).find('[idx="'+filterState+'"]')}this.options.filterState=filterState;if(li&&li.length>0){liLeft=li.offset().left;liWidth=li.outerWidth();$div=li.parent().parent();divWidth=$div.outerWidth();divScrollLeft=$div.scrollLeft();li.attr("filtered",1).addClass(this.css.presetSelected).siblings().attr("filtered",null).removeClass(this.css.presetSelected);if(liLeft+liWidth>divWidth){newLeft=divScrollLeft+liWidth;$div.animate({scrollLeft:newLeft},function(){self._refreshPresets($div)})}else{if(liLeft<0){newLeft=divScrollLeft-liWidth;$div.animate({scrollLeft:newLeft},function(){self._refreshPresets($div)})}}}this._adjustTrayText(this.options.presets[this.options.filterState])},_adjustTrayText:function(preset){var showing;if(this._presetSpan){if(preset){showing=this._presetSpan.text()==="";this._presetSpan.text(preset.text).prev().show();if(showing){if(this._presetSpan.prevAll('[data-trayRole="keyword"]').text()){this._presetSpan.prevAll('[data-trayRole="bullet"]').show()}if(this._presetSpan.nextAll('[data-trayRole="keyword"]').text()){this._presetSpan.nextAll('[data-trayRole="bullet"]').show()}this._presetSpan.nextAll('[data-trayRole="empty"]').hide().next().hide()}}else{this._presetSpan.text("").prev().hide().siblings('[data-trayRole="bullet"]').hide();if(this._presetSpan.prevAll('[data-trayRole="keyword"]').text()&&this._presetSpan.nextAll('[data-trayRole="keyword"]').text()){this._presetSpan.prevAll('[data-trayRole="bullet"]').show()}else{this._presetSpan.nextAll('[data-trayRole="empty"]').show().next().show()}}}},_adjustKeywordTrayText:function(val){var showing,prevShown;if(this._keywordSpan){if(val){showing=this._keywordSpan.text()==="";prevShown=showing;this._keywordSpan.text('"'+val+'"');if(showing){this._keywordSpan.nextAll('[data-trayRole="keyword"]').each(function(i){if($(this).text()&&prevShown){$(this).prev().prev().show()}if(!prevShown){prevShown=$(this).text().length>0}});if(prevShown){this._keywordSpan.prev().prev().show()}this._keywordSpan.nextAll('[data-trayRole="empty"]').hide().next().hide()}}else{this._keywordSpan.text("").next().hide();prevShown=false;this._keywordSpan.nextAll('[data-trayRole="keyword"]').each(function(i){if(i>0&&!$(this).text()&&prevShown){$(this).prev().prev().hide();prevShown=false}if(!prevShown){prevShown=$(this).text().length>0}});if(!this._keywordSpan.nextAll('[data-trayRole="keyword"]').text()){this._keywordSpan.nextAll('[data-trayRole="empty"]').show().next().show()}}}},filter:function(fieldExpressions,trayText){this.options.filterState="custom";if(this.options.presets&&this.options.presets.length>0){this.list.container().find("."+this.css.filterPresets).find("."+this.css.presetSelected).removeClass(this.css.presetSelected).attr("filtered",null);this._adjustTrayText(trayText?{text:trayText}:null)}this._refilter(true,null,fieldExpressions)},_refilter:function(renderData,sortedFields,filteredFields){var x,filtering=this.options.filterState,filters=[],index=0,searchBarFields,val,allFilters=[],schema,fields;if(renderData===undefined){renderData=true}for(x=0;x<this.options.filteredFields.length;++x){filters[index++]={fieldName:this.options.filteredFields[x].fieldName,expr:this.options.filteredFields[x].searchValue,cond:this.options.filteredFields[x].condition,logic:this.options.filteredFields[x].logic}}if(filtering!==null&&filtering!==""&&filtering!=="default"&&filtering!=="custom"){filtering=this.options.presets[parseInt(filtering,10)].filteredFields}else{if(filteredFields&&filtering==="custom"){filtering=filteredFields}else{filtering=[]}}for(x=0;x<filtering.length;++x){filters[index++]={fieldName:filtering[x].fieldName,expr:filtering[x].searchValue,cond:filtering[x].condition,logic:filtering[x].logic}}if(this.options.searchBarEnabled){val=this._filterInput?this._filterInput.val():null;if(this.options.searchBarFieldName===null||this.options.searchBarFieldName.length===0){schema=this.list.dataSource.schema();fields=schema?schema.fields():null;if(!fields||fields.length===0){fields=this.list.options.schema}if(!(this.options.type==="remote"&&this.options.filterExprUrlKey)){for(x=0;x<fields.length&&val;++x){if(!(schema&&schema.schema&&schema.schema.childDataProperty&&schema.schema.childDataProperty.name===fields[x].name)&&fields[x].name!==this.list.options.bindings.isDividerKey&&!(this.list.options.childLayout&&this.list.options.childLayout.key===fields[x].name)){allFilters[allFilters.length]={fieldName:fields[x].name,expr:val,cond:this.options.searchBarCondition,logic:"or"}}}}else{if(val){this._needsAll=true}else{delete this._needsAll}}}else{searchBarFields=this.options.searchBarFieldName.split(",");for(x=0;x<searchBarFields.length&&val;++x){filters[index++]={fieldName:searchBarFields[x],expr:val,cond:this.options.searchBarCondition,logic:"or"}}delete this._needsAll}}delete this._dividers;if(this.list.dataSource.settings.sorting.enabled&&((sortedFields&&sortedFields.length>0)||(!sortedFields&&this.list.dataSource.settings.sorting.expressions.length>0))&&this._filterDividers){if(this.options.type==="local"||!this.options.filterExprUrlKey||(filters.length===0&&allFilters.length===0)){filters=this._filterDividers.concat(filters)}else{this._dividers="out"}}else{if(filters.length>0&&this._keepDividers){if(this.options.type==="local"||!this.options.filterExprUrlKey){filters=this._keepDividers.concat(filters)}else{this._dividers="keep"}}if(allFilters.length>0&&this._keepDividersAll&&(this.options.type==="local"||filters.length===0)){if(this.options.type==="local"||!this.options.filterExprUrlKey){allFilters=this._keepDividersAll.concat(allFilters)}else{this._dividers="keep"}}}this.list.dataSource.settings.filtering.expressions=filters.concat(allFilters);this.list.dataSource.settings.paging.appendPage=false;this.list.dataSource.settings.paging.pageIndex=0;this.list._requireRecordsClear=true;if(this.options.type==="local"){if(filters.length>0||allFilters.length>0){this.list.dataSource.filter(filters,"AND",true,allFilters)}else{this.list.dataSource.clearLocalFilter()}if(this.list.dataSource.settings.sorting.type==="local"&&this.list.dataSource.settings.sorting.expressions.length>0&&!sortedFields){this.list.dataSource.sort(this.list.dataSource.settings.sorting.expressions,"asc")}if(renderData){this.list._renderData()}this.list.dataSource.settings.paging.appendPage=true}else{if(renderData){this.list.dataSource.dataBind()}}},_renderingTray:function(e,ui){var self=this,wrapper,x,index,searchScope,insertedSearch,search,$this,val,noCancel;if(e.target.id!==this.list.element[0].id){return}if(this.options.searchBarEnabled){if(!ui.needTray){ui.needTray=1}ui.css=(ui.css+"-keyword").replace("-one-keyword","-keyword-one");wrapper=$("<div />").addClass(this.css.filterKeywordArea).append("<span>"+this._locale("keywordSearchLabel")+"</span>");search=this._filterInput=$("<input>",{placeholder:this._locale("searchBarPlaceHolder")}).jqmData("lastval","").attr("data-"+$.mobile.ns+"type","search").bind("keyup change",function(){$this=$(this);val=this.value;if(val!==$this.jqmData("lastVal")){noCancel=self._trigger(self.events.keywordChanging,null,{value:val,owner:self});if(noCancel){$.mobile.showPageLoadingMsg();self._shouldFireKeywordChanged=true;self._adjustKeywordTrayText(val);if(self._expr&&self.options.type==="remote"){self._filterNew=val}else{self._expr=val;self._refilter()}}if(searchScope){if(val.length>0){noCancel=searchScope.hasClass(self.css.keywordSearchScopeHidden);searchScope.removeClass(self.css.keywordSearchScopeHidden);searchScope.parent().parent().parent()[0].className=searchScope.parent().parent().parent()[0].className.replace("-keyword","-keyword-scope");if(noCancel){self._refreshPresets(searchScope)}}else{if(val.length===0){searchScope.addClass(self.css.keywordSearchScopeHidden);searchScope.parent().parent().parent()[0].className=searchScope.parent().parent().parent()[0].className.replace("-scope","")}}if(!this._setScopeWidths){searchScope.find("li").each(function(){var $this=$(this);$this.width($this.outerWidth())});this._setScopeWidths=true}}}$this.jqmData("lastVal",val)}).appendTo(wrapper).textinput();if(this.options.searchBarFields.length>0){wrapper.append("<div class='"+this.css.filterScopeOptions+"'><ul class='"+this.css.keywordSearchScopeHidden+"'></ul></div>").find("ul").bind("tap",this._searchScopeTapHandler).append("<li class='"+this.css.preset+" "+(!this.options.searchBarFieldName?this.css.presetSelected:"")+"' idx='all'>"+this._locale("keywordAllStateText")+"</li>");searchScope=wrapper=wrapper.find("ul");for(x=0;x<this.options.searchBarFields.length;++x){wrapper.append($("<li class='"+this.css.preset+"' idx='"+x+"'>"+this.options.searchBarFields[x].text+"</li>"));if(this.options.searchBarFields[x].fieldName===this.options.searchBarFieldName&&(this.options.searchBarFields[x].condition===this.options.searchBarCondition||(this.options.searchBarCondition==="contains"&&!this.options.searchBarFields[x].condition))){wrapper.children().removeClass(this.css.presetSelected).last().addClass(this.css.presetSelected)}}wrapper=wrapper.parent().bind({scroll:function(evnt){self._refreshPresets()}});if(wrapper.scrollview){wrapper.scrollview()}else{if(wrapper.igScroll){wrapper.igScroll({cancelStart:true})}}wrapper=wrapper.parent()}if(!ui.tray){ui.tray=$("<div />");ui.tray.append(wrapper)}else{wrapper.prependTo(ui.tray)}insertedSearch=true}if(this.options.presets&&this.options.presets.length>0){if(ui.needTray!==2){ui.needTray=2}if(ui.css.indexOf("one")>-1){ui.css=ui.css.replace("one","two")}else{ui.css=ui.css+"-one"}wrapper=$("<div />").addClass(this.css.filterPresets).append("<span>"+this._locale("filterPresetsLabel")+"</span>").append("<div><ul></ul></div>").find("ul").bind("click",this._presetTapHandler);wrapper.append("<li class='"+this.css.preset+"' idx='default'>"+this._locale("filterAllStateText")+"</li>");for(x=0;x<this.options.presets.length;++x){wrapper.append($("<li class='"+this.css.preset+"' idx='"+x+"'>"+this.options.presets[x].text+"</li>"))}index=parseInt(this.options.filterState,10)+1;if(isNaN(index)){index=0}wrapper.children().eq(index).addClass(this.css.presetSelected);wrapper=wrapper.parent().bind({scroll:function(evnt){self._refreshPresets()}});if(wrapper.scrollview){wrapper.scrollview()}else{if(wrapper.igScroll){wrapper.igScroll({cancelStart:true})}}wrapper=wrapper.parent();if(!ui.tray){ui.tray=$("<div />");wrapper.appendTo(ui.tray)}else{if(insertedSearch){wrapper.insertAfter(ui.tray.children().eq(0))}else{wrapper.prependTo(ui.tray)}}}},_renderedTray:function(e,ui){var self=this,$win=$(window),noCancel,needRendering=false;if((this.options.presets&&this.options.presets.length>0)||(this.options.searchBarEnabled&&this.options.searchBarFields&&this.options.searchBarFields.length>0)){this._refreshPresets();$win.bind("resize",function(){self._refreshPresets()});$win.bind("orientationchange",function(){self._refreshPresets()})}if(this.options.searchBarEnabled&&ui.needTray===2){$("<div>").text(this._locale("cancelButtonLabel")).buttonMarkup({inline:true}).insertAfter(this._filterInput.parent().css("display","inline-block")).bind("click",function(evnt){var needToBind;if(self._filterInput.val()!==""){noCancel=self._trigger(self.events.keywordChanging,null,{value:"",owner:self});if(noCancel){self._filterInput.val("");self._filterInput.jqmData("lastVal","");self._adjustKeywordTrayText("");self._shouldFireKeywordChanged=true;needRendering=true}}if(self.options.filterState!=="default"){noCancel=self._trigger(self.events.presetChanging,null,{state:"default",owner:self});if(noCancel){self._adjustFilterState("default");self._shouldFirePresetChanged=true;needRendering=true}}if(needRendering){$.mobile.showPageLoadingMsg();self._refilter(false)}needToBind=self._trigger("_cancelButtonClicked");self.list.toggleSearchArea();if(needToBind&&needRendering){if(self.options.type==="remote"){self.list.dataSource.dataBind()}else{self.list._renderData()}}})}},_refreshPresets:function(parent){var self=this,activePage=$.mobile.activePage,listPage=this.list.element.closest(".ui-page");if(activePage&&activePage[0]===listPage[0]){if(!parent){parent=this.list.container().find("."+this.css.filterPresets).parent()}$(parent).find("li").removeClass(this.css.presetHidden).each(function(i,val){var $div=$(val.parentNode.parentNode),$li=$(val),liLeft=$li.offset().left,liWidth=$li.width(),divWidth=$div.outerWidth(),divLeft=Math.min(0,$div.offset().left);if(liLeft+liWidth>divWidth+divLeft||liLeft<divLeft){$li.addClass(self.css.presetHidden)}})}},_renderingTrayFooterBar:function(e,ui){var wrapper=$("<div>");if(this.options.searchBarEnabled){wrapper.append(this._keywordSpan=$("<span data-trayRole='keyword' class='"+this.css.keywordFooterText+"'></span>").text(this._filterInput.val())).append("<span style='display:none;' class='"+this.css.separatorFooterText+"' data-trayRole='bullet'> &bull; </span>")}if(this.options.presets&&this.options.presets.length>0){wrapper.append("<span class='"+this.css.separatorFooterText+"' style='display:none;'> "+this._locale("showLabel")+" </span>").append(this._presetSpan=$("<span data-trayRole='keyword' class='"+this.css.presetFooterText+"'></span>"));if(this.options.filterState!=="default"){this._presetSpan.text(this.options.presets[this.options.filterState].text).prev().show();if(this._keywordSpan&&this._keywordSpan.text()){this._keywordSpan.next().show()}}}if(ui.trayFooter.children().length>0){wrapper.children().prependTo(ui.trayFooter)}else{ui.trayFooter.append(wrapper.children())}if(this.options.filterState!=="default"&&this._presetSpan.nextAll('[data-trayRole="keyword"]').text()){this._presetSpan.next().show()}},_dataRendering:function(e,ui){if(this.list._dataBinding&&this.options.type==="local"){this._refilter(false)}if(this._filterNew&&this._expr!==this._filterNew){this._expr=this._filterNew;this._refilter();return false}},_itemsRendering:function(e,ui){delete this._expr;delete this._filterNew},_itemsRendered:function(e,ui){if(this._shouldFirePresetChanged){this._trigger(this.events.presetChanged,null,{state:this.options.filterState,owner:this});this._shouldFirePresetChanged=false}if(this._shouldFireKeywordChanged){this._trigger(this.events.keywordChanged,null,{value:this._filterInput.val(),owner:this});this._shouldFireKeywordChanged=false}if(this._shouldFireScopeChanged){this._trigger(this.events.scopeChanged,null,{scopeField:this.options.searchBarFieldName,owner:this});this._shouldFireScopeChanged=false}$.mobile.hidePageLoadingMsg()},_sortChanging:function(e,ui){if(this._keepDividers&&this._filterDividers){this._refilter(false,ui.sortedFields);ui.handled=true}},_encodeExtraParams:function(dataSource,params){if(this._dividers){params.filteringParams.dividers=this._dividers}if(this._needsAll){params.filteringParams.allCondition=this.options.searchBarCondition;params.filteringParams.allValue=this._filterInput.val()}},_createHandlers:function(){this._renderingTrayHandler=$.proxy(this._renderingTray,this);this._renderedTrayHandler=$.proxy(this._renderedTray,this);this._renderingTrayFooterBarHandler=$.proxy(this._renderingTrayFooterBar,this);this._dataRenderingHandler=$.proxy(this._dataRendering,this);this._itemsRenderingHandler=$.proxy(this._itemsRendering,this);this._itemsRenderedHandler=$.proxy(this._itemsRendered,this);this._sortChangingHandler=$.proxy(this._sortChanging,this)},_registerEvents:function(){this.list.element.bind("iglistrenderingtray",this._renderingTrayHandler);this.list.element.bind("iglistrenderedtray",this._renderedTrayHandler);this.list.element.bind("iglistrenderingtrayfooterbar",this._renderingTrayFooterBarHandler);this.list.element.bind("iglistdatarendering",this._dataRenderingHandler);this.list.element.bind("iglistitemsrendering",this._itemsRenderingHandler);this.list.element.bind("iglistitemsrendered",this._itemsRenderedHandler);this.list.element.bind("iglistviewsorting_sortchanging",this._sortChangingHandler)},_unregisterEvents:function(){this.list.element.unbind("iglistrenderingtray",this._renderingTrayHandler);this.list.element.unbind("iglistrenderedtray",this._renderedTrayHandler);this.list.element.unbind("iglistrenderingtrayfooterbar",this._renderingTrayFooterBarHandler);this.list.element.unbind("iglistdatarendering",this._dataRenderingHandler);this.list.element.unbind("iglistitemsrendering",this._itemsRenderingHandler);this.list.element.unbind("iglistitemsrendered",this._itemsRenderedHandler);this.list.element.unbind("iglistviewsorting_sortchanging",this._sortChangingHandler);delete this._renderingTrayHandler;delete this._renderedTrayHandler;delete this._renderingTrayFooterBarHandler;delete this._dataRenderingHandler;delete this._itemsRenderedHandler;delete this._sortChangingHandler},_injectList:function(listInstance,isRebind){var x,presets,filteredFields=[];this.list=listInstance;if(this.options.type===null){this.options.type=this.list._inferOpType()}if(this.options.type){this.list.dataSource.settings.filtering.type=this.options.type}else{this.list.dataSource.settings.filtering.type="remote"}if(this.options.filterExprUrlKey){this.list.dataSource.settings.filtering.filterExprUrlKey=this.options.filterExprUrlKey;this._encodeExtraParamsHandler=$.proxy(this._encodeExtraParams,this);this.list.dataSource.settings.urlParamsEncoded=this._encodeExtraParamsHandler}this.list.dataSource.settings.filtering.caseSensitive=this.options.caseSensitive;presets=this.options.filteredFields;if(this.list.options.bindings&&this.list.options.bindings.isDividerKey){this._keepDividers=[];this._keepDividers[0]={fieldName:this.list.options.bindings.isDividerKey,cond:"true",logic:"Or"};this._keepDividersAll=[];this._keepDividersAll[0]={fieldName:this.list.options.bindings.isDividerKey,cond:"equals",expr:"true",logic:"Or"};this._filterDividers=[];this._filterDividers[0]={fieldName:this.list.options.bindings.isDividerKey,cond:"false",logic:"And"}}if(presets&&presets.length>0){for(x=0;x<presets.length;++x){filteredFields[filteredFields.length]={fieldName:presets[x].fieldName,cond:presets[x].condition,expr:presets[x].searchValue}}}if(this.options.filterState!=="default"&&this.options.presets){presets=this.options.presets[this.options.filterState].filteredFields}if(presets&&presets.length>0){for(x=0;x<presets.length;++x){filteredFields[filteredFields.length]={fieldName:presets[x].fieldName,cond:presets[x].condition,expr:presets[x].searchValue}}}if(this.list.dataSource.settings.sorting.enabled&&this.list.dataSource.settings.sorting.defaultFields.length>0&&this._filterDividers){filteredFields=this._filterDividers.concat(filteredFields)}else{if(filteredFields.length>0&&this._keepDividers){filteredFields=this._keepDividers.concat(filteredFields)}}if(filteredFields.length>0){this.list.dataSource.settings.filtering.expressions=filteredFields}this._createHandlers();this._registerEvents()},destroy:function(){if(this._presetSpan){this._presetSpan.prev().prev().remove().end().prev().remove().end().remove();delete this._presetSpan}if(this._keywordSpan){this._keywordSpan.prev().remove().end().remove();delete this._keywordSpan}if(this._filterInput){if(this._filterInput.data("textinput")){this._filterInput.data("textinput").destroy()}this._filterInput.parent().parent().remove();delete this._filterInput}this.list.container().find("."+this.css.filterPresets).remove();this._unregisterEvents();$.Widget.prototype.destroy.call(this);return this}});function _addDash(c){return"-"+c.toLowerCase()}function _fixSearchValue(searchValue){var temp=searchValue;try{searchValue=eval(searchValue)}catch(ex){searchValue=temp}if(searchValue===undefined&&temp){searchValue=temp}return searchValue}$(document).bind("_igListViewHtmlOptions",function(evnt,args){var elem=args.element,filtering,option,value,x,i;if(elem.jqmData("filtering")===true){if(!args.options.features){args.options.features=[]}filtering=args.options.features[args.options.features.length]={};filtering.name="Filtering";for(option in $.mobile.igListViewFiltering.prototype.options){if($.mobile.igListViewFiltering.prototype.options.hasOwnProperty(option)){value=elem.jqmData("filtering-"+option.replace(/[A-Z]/g,_addDash));if(value!==undefined){if(option==="presets"){for(x=0;x<value.length;++x){if(value[x]&&value[x].filteredFields){for(i=0;i<value[x].filteredFields.length;++i){value[x].filteredFields[i].searchValue=_fixSearchValue(value[x].filteredFields[i].searchValue)}}}}else{if(option==="filteredFields"){for(x=0;x<value.length;++x){if(value[x]){value[x].searchValue=_fixSearchValue(value[x].searchValue)}}}}filtering[option]=value}}}}});if(typeof define==="function"&&define.amd&&define.amd.jQuery){define("ig.mobileui.list.filtering",["ig.mobileui.list"],function(){return $.mobile.igListViewFiltering})}$.extend($.mobile.igListViewFiltering,{version:"12.1.20121.1010"})}(jQuery));
/*
 * Infragistics.Web.MobileUI ListView LoadOnDemand 12.1.20121.1010
 *
 * Copyright (c) 2011-2012 Infragistics Inc.
 *
 * http://www.infragistics.com/
 *
 * Depends on:
 *  jquery-1.6.4.js
 *	jquery.ui.core.js
 *  ig.mobileui.list.js
 *	ig.dataSource.js
 *  ig.ui.shared.js
 *	ig.util.js
 */
(function(a){a.widget("mobile.igListViewLoadOnDemand",a.mobile.widget,{css:{loadMoreBtn:"ui-iglist-load-more"},options:{type:null,pageSize:10,recordCountKey:null,pageSizeUrlKey:null,pageIndexUrlKey:null,mode:"button",autoHideButtonAtEnd:true},events:{itemsRequesting:"itemsRequesting",itemsRequested:"itemsRequested"},_create:function(){this._maxPosition=0;this._lastItemCount=0},_setOption:function(c,d){a.Widget.prototype._setOption.apply(this,arguments);if(c==="type"){throw new Error(a.ig.Grid.locale.optionChangeNotSupported+" "+c)}},_locale:function(c){var d=this.options[c];if(d===undefined||d===null){d=a.ig.mobileListViewLoadOnDemand&&a.ig.mobileListViewLoadOnDemand.locale?a.ig.mobileListViewLoadOnDemand.locale[c]:null}return d||""},_footerRendering:function(d,c){var f=this,e;if(this.options.mode!=="button"){return}a("<div>").addClass(this.css.loadMoreBtn).text(this._locale("loadMoreItemsLabel")).bind("click",function(g){e=f._trigger(f.events.itemsRequesting,null,{owner:f,newPageIndex:f.list.dataSource.settings.paging.pageIndex+1});if(e){f._shouldFireItemsRequested=true;if(f.list.dataSource.pageIndex()<f.list.dataSource.pageCount()-1){a.mobile.showPageLoadingMsg()}f.list.dataSource.nextPage()}}).buttonMarkup({inline:false}).appendTo(c.footerContents)},_itemsRendering:function(d,c){c.index=this.list.dataSource.settings.paging.pageIndex*this.list.dataSource.settings.paging.pageSize;if(this._skippedDivider&&c.index>0){c.index--}if(this.list.options.inset){c.listElement.children().last().removeClass("ui-corner-bottom").find(".ui-btn-inner").not(".ui-li-link-alt span:first-child").removeClass("ui-corner-bottom").end().end().find(".ui-li-thumb").not(".ui-li-icon").removeClass("ui-corner-bl")}},_itemsRendered:function(h,e){var c,d,g,w,u=this,v,m=this.list,p=m.options,o,j=p._hParent,k=j.options,n,s,r,q,l,f,t;if(this.list.options.bindings&&this.list.options.bindings.isDividerKey&&this.list.dataSource.dataView().length>0){v=this.list.dataSource.dataView()[this.list.dataSource.dataView().length-1];if(v[this.list.options.bindings.isDividerKey]===true){this._skippedDivider=true}else{delete this._skippedDivider}}else{delete this._skippedDivider}if(this._shouldFireItemsRequested){if(this.options.autoHideButtonAtEnd&&this.list.dataSource.pageIndex()===this.list.dataSource.pageCount()-1){this.list.container().find("."+this.css.loadMoreBtn).hide();if(this.options.mode==="automatic"){a(document).unbind("scroll",this._docScrolledHandler);this._notBoundScroll=true}}o=parseInt(m.element.attr("data-level"),10);if(j&&(o<k.initialDataBindDepth||k.initialDataBindDepth===-1)){q=this.list.dataSource.settings.paging.pageIndex;if(o>0){n=p._parent;s=n.closest(".ig-listview").data("igFlatList").options;r=s._parent;t=j._getChildDataSource(s,p,n,r);f=j._hds.dataAt(t.itemId,t.keyspath+t.keyspathvar)}else{f=j._hds.root()}if(f&&(a.type(f)==="array"||(p.responseDataKey&&a.type(f[p.responseDataKey])==="array"))){for(l=q*m.dataSource.settings.paging.pageSize;l<m.dataSource._dataView.length;++l){if(p.responseDataKey){f[p.responseDataKey][l]=this.list.dataSource._dataView[l]}else{f[l]=this.list.dataSource._dataView[l]}}}}this._trigger(this.events.itemsRequested,null,{owner:this});this._shouldFireItemsRequested=false}else{if(this.options.autoHideButtonAtEnd&&this.list.dataSource.pageCount()<=1){this.list.container().find("."+this.css.loadMoreBtn).hide();if(this.options.mode==="automatic"){a(document).unbind("scroll",this._docScrolledHandler);this._notBoundScroll=true}}else{this.list.container().find("."+this.css.loadMoreBtn).show();if(this._notBoundScroll){a(document).bind("scroll",this._docScrolledHandler);delete this._notBoundScroll}}}a.mobile.hidePageLoadingMsg();if(this.options.mode==="automatic"&&this.list.dataSource.pageIndex()<this.list.dataSource.pageCount()-1&&(this._docScrolledFired||!this._loadedAfterRender)){c=a(document);g=c.height();d=a(window);w=d.height();if(g<=w){setTimeout(function(){var x;x=u._trigger(u.events.itemsRequesting,null,{owner:u,newPageIndex:u.list.dataSource.settings.paging.pageIndex+1});if(x){if(!this._docScrolledFired){this._loadedAfterRender=true}u._shouldFireItemsRequested=true;if(u.list.dataSource.pageIndex()<u.list.dataSource.pageCount()-1){a.mobile.showPageLoadingMsg()}u.list.dataSource.nextPage();a.mobile.hidePageLoadingMsg()}})}}if(this.list.dataSource.dataView().length<this._lastItemCount){this._maxPosition=0}this._lastItemCount=this.list.dataSource.dataView().length},_docScrolled:function(e){var j=false,c=a(window),l=c.height(),k=c.scrollTop(),g=this.list.listElement.children().last(),f=g.offset(),d=a.mobile.activePage,h=this.list.element.closest(".ui-page");this._docScrolledFired=true;if(this._loadedAfterRender){delete this._loadedAfterRender;return}if(d&&d[0]===h[0]&&this._maxPosition<l+k&&f&&(f.top-g.outerHeight())<=l+k&&!this._shouldFireItemsRequested){j=this._trigger(this.events.itemsRequesting,null,{owner:this,newPageIndex:this.list.dataSource.settings.paging.pageIndex+1});if(j){if(this.list.dataSource.pageIndex()<this.list.dataSource.pageCount()-1){a.mobile.showPageLoadingMsg();this._shouldFireItemsRequested=true}this._maxPosition=l+k;this.list.dataSource.nextPage()}}},_createHandlers:function(){this._footerRendering=a.proxy(this._footerRendering,this);this._itemsRenderingHandler=a.proxy(this._itemsRendering,this);this._itemsRenderedHandler=a.proxy(this._itemsRendered,this);if(this.options.mode==="automatic"){this._docScrolledHandler=a.proxy(this._docScrolled,this)}},_registerEvents:function(){this.list.element.bind("iglistfooterrendering",this._footerRendering);this.list.element.bind("iglistitemsrendering",this._itemsRenderingHandler);this.list.element.bind("iglistitemsrendered",this._itemsRenderedHandler);if(this.options.mode==="automatic"){a(document).bind("scroll",this._docScrolledHandler)}},_unregisterEvents:function(){this.list.element.unbind("iglistfooterrendering",this._footerRendering);this.list.element.unbind("iglistitemsrendering",this._itemsRenderingHandler);this.list.element.unbind("iglistitemsrendered",this._itemsRenderedHandler);if(this.options.mode==="automatic"){a(document).unbind("scroll",this._docScrolledHandler)}delete this.footerRendering;delete this._itemsRenderingHandler;delete this._itemsRenderedHandler;delete this._docScrolledHandler},_injectList:function(d,c){this.list=d;if(this.options.type===null){this.options.type=this.list._inferOpType()}if(this.options.type){this.list.dataSource.settings.paging.type=this.options.type}else{this.list.dataSource.settings.paging.type="remote"}this.list.dataSource.settings.paging.enabled=true;if(this.options.pageSizeUrlKey){this.list.dataSource.settings.paging.pageSizeUrlKey=this.options.pageSizeUrlKey}if(this.options.pageIndexUrlKey){this.list.dataSource.settings.paging.pageIndexUrlKey=this.options.pageIndexUrlKey}if(this.options.recordCountKey!==null){this.list.dataSource.settings.responseTotalRecCountKey=this.options.recordCountKey}this.list.dataSource.settings.paging.pageSize=this.options.pageSize;this.list.dataSource.settings.paging.pageIndex=0;this.list.dataSource.settings.paging.appendPage=true;this.list._loadOnDemand=true;this._createHandlers();this._registerEvents()},destroy:function(){this._unregisterEvents();if(this.options.mode==="button"){this.list.container().find("."+this.css.loadMoreBtn).remove()}delete this.list._loadOnDemand;delete this._docScrolledFired;this.list._requireRecordsClear=true;delete this._notBoundScroll;this.list.dataSource.settings.paging.enabled=false;this.list.dataSource.settings.paging.pageIndex=0;if(this.options.type==="local"){this.list.dataSource.pageSize(this.list.dataSource._data.length)}else{this.list.dataSource.dataBind()}a.Widget.prototype.destroy.call(this);return this}});function b(d){return"-"+d.toLowerCase()}a(document).bind("_igListViewHtmlOptions",function(e,c){var d=c.element,f,g,h;if(d.jqmData("load-on-demand")===true){if(!c.options.features){c.options.features=[]}f=c.options.features[c.options.features.length]={};f.name="LoadOnDemand";for(g in a.mobile.igListViewLoadOnDemand.prototype.options){if(a.mobile.igListViewLoadOnDemand.prototype.options.hasOwnProperty(g)){h=d.jqmData("load-on-demand-"+g.replace(/[A-Z]/g,b));if(h!==undefined){f[g]=h}}}}});if(typeof define==="function"&&define.amd&&define.amd.jQuery){define("ig.mobileui.list.loadondemand",["ig.mobileui.list"],function(){return a.mobile.igListViewLoadOnDemand})}a.extend(a.mobile.igListViewLoadOnDemand,{version:"12.1.20121.1010"})}(jQuery));
/*
 * Infragistics.Web.MobileUI ListView Sorting 12.1.20121.1010
 *
 * Copyright (c) 2011-2012 Infragistics Inc.
 *
 * http://www.infragistics.com/
 *
 * Depends on:
 *  jquery-1.6.4.js
 *	jquery.ui.core.js
 *  ig.mobileui.list.js
 *	ig.dataSource.js
 *  ig.ui.shared.js
 *	ig.util.js
 */
(function(a){a.widget("mobile.igListViewSorting",a.mobile.widget,{css:{sortPresets:"ui-iglist-sort-presets",preset:"ui-btn-inline ui-iglist-preset",presetSelected:"ui-iglist-preset-selected",presetHidden:"ui-iglist-preset-hidden",listDivider:"ui-li ui-li-divider ui-btn ui-bar-{0} ui-li-has-count",count:"ui-li-count ui-btn-up-{0} ui-btn-corner-all",presetFooterText:"ui-iglist-tray-footer-item ig-tray-sort-preset",separatorFooterText:"ui-iglist-tray-footer-sep",insetDivider:"ui-corner-all",insetTopItem:"ui-corner-top",insetBottomItem:"ui-corner-bottom"},options:{type:null,caseSensitive:false,sortPresetsLabel:null,sortState:"default",sortUrlKey:null,sortUrlKeyAscValue:null,sortUrlKeyDescValue:null,customSortFunction:null,sortedFields:[{fieldName:"",direction:""}],showGrouping:false,groupComparerFunction:null,groupNameFunction:null,presets:[{text:"",sortedFields:[{fieldName:"",direction:""}],showGrouping:false,groupComparerFunction:null,groupNameFunction:null}],dividerTemplate:null,listDividerTheme:"b",countTheme:"c",presetTheme:"c",autoGenerateSortPresets:true},events:{presetChanging:"presetChanging",presetChanged:"presetChanged"},_createWidget:function(){this.options.sortedFields=[];this.options.presets=null;a.Widget.prototype._createWidget.apply(this,arguments)},_create:function(){var f=this,c=this.css,e=this.options,d;this._presetTapHandler=function(l){var r=f.list._itemFromTarget(l.target,"li","idx"),q,h,m,n,g,k,j,o,p;if(r&&!r.hasAttribute("sorted")){h=a(r);q=h.attr("idx");d=f._trigger(f.events.presetChanging,null,{state:q,owner:f});if(d){m=h.offset().left;n=h.outerWidth();g=h.parent().parent();k=g.outerWidth();j=g.scrollLeft();h.attr("sorted",1).addClass(f.css.presetSelected).siblings().attr("sorted",null).removeClass(f.css.presetSelected);f.options.sortState=q;if(m+n>k){o=j+n;g.animate({scrollLeft:o},function(){f._refreshPresets(g)})}else{if(m<0){o=j-n;g.animate({scrollLeft:o},function(){f._refreshPresets(g)})}}p=f.options.presets[f.options.sortState];f._adjustTrayText(p);a.mobile.showPageLoadingMsg();f._shouldFirePresetChanged=true;f._resort()}}};c.count=c.count.replace("{0}",e.countTheme);c.listDivider=c.listDivider.replace("{0}",e.listDividerTheme);c.preset=c.preset.replace("{0}",e.presetTheme)},_adjustTrayText:function(c){var e,d;if(this._presetSpan){if(c){e=this._presetSpan.text()==="";this._presetSpan.text(c.text).prev().show();if(e){a(this._presetSpan.prevAll('[data-trayRole="keyword"]').get().reverse()).each(function(f){if(f>0&&a(this).text()&&d){a(this).prev().prev().show();d=false}if(!d){d=a(this).text().length>0}});if(d){this._presetSpan.prev().prev().show()}this._presetSpan.nextAll('[data-trayRole="empty"]').hide().next().hide()}}else{this._presetSpan.text("").prev().hide().prev().hide();a(this._presetSpan.prevAll('[data-trayRole="keyword"]').get().reverse()).each(function(f){if(f>0&&!a(this).text()&&d){a(this).prev().prev().hide();d=false}if(!d){d=a(this).text().length>0}});if(!this._presetSpan.prevAll('[data-trayRole="keyword"]').text()){this._presetSpan.nextAll('[data-trayRole="empty"]').show().next().show()}}}},_setOption:function(c,d){a.Widget.prototype._setOption.apply(this,arguments);if(c==="type"){throw new Error(this.list._locale("optionChangeNotSupported")+" "+c)}else{if(c==="caseSensitive"){this.list.dataSource.settings.sorting.caseSensitive=this.options.caseSensitive}else{if(c==="sortState"){this.options.sortState=d;this.list.container().find("."+this.css.sortPresets).find('[idx="'+d+'"]').attr("sorted",1).addClass(this.css.presetSelected).siblings().attr("sorted",null).removeClass(this.css.presetSelected);this._adjustTrayText(this.options.presets[this.options.sortState]);this._resort()}}}},_locale:function(c){var d=this.options[c];if(d===undefined||d===null){d=a.ig.mobileListViewSorting&&a.ig.mobileListViewSorting.locale?a.ig.mobileListViewSorting.locale[c]:null}return d||""},group:function(d,c,g,e,f){if(d&&d.length>0){this._shouldGroup=true;this._grpFx=e;this._nameFx=f;this._grpField=d[0].fieldName}this.sort(d,c,g)},sort:function(d,c,g){var h,e=0,f=[];for(h=0;d&&h<d.length;++h){f[e]={fieldName:d[h].fieldName,dir:d[h].direction};if(f[e].dir===undefined||f[e].dir===null){if(c!==null&&c!==undefined){f[e].dir=c}else{f[e].dir="asc"}}e++}this.options.sortState="custom";if(this.options.presets&&this.options.presets.length>0){this.list.container().find("."+this.css.sortPresets).find("."+this.css.presetSelected).removeClass(this.css.presetSelected).attr("sorted",null);this._adjustTrayText(g?{text:g}:null)}this._resort(true,f)},_resort:function(e,f){var h,g=this.options.sortState,d=0,c;if(e===undefined){e=true}if(f===undefined){f=[]}if(g!==null&&g!==""){if(g==="default"){g=this.options.sortedFields}else{if(g!=="custom"){d=parseInt(g,10);g=this.options.presets[d].sortedFields}}if(a.type(g)==="array"){d=0;for(h=0;h<g.length;++h){f[d]={fieldName:g[h].fieldName,dir:g[h].direction};if(f[d].dir===undefined||f[d].dir===null){f[d].dir="asc"}d++}}}this.list.dataSource.settings.paging.appendPage=false;this.list.dataSource.settings.paging.pageIndex=0;this.list._requireRecordsClear=true;c={sortedFields:f};this._trigger("_sortChanging",null,c);if(this.list.options.bindings.isDividerKey&&!c.handled){this._filterOutDividers(f)}this.list.dataSource.settings.sorting.expressions=f;if(this.options.type==="local"){if(f.length>0){this.list.dataSource.sort(f,"asc")}else{this.list.dataSource.clearLocalSorting()}if(e){this.list._renderData()}this.list.dataSource.settings.paging.appendPage=true}else{if(e){this.list.dataSource.dataBind()}}},_filterOutDividers:function(d){var c=[];if(d.length>0){c[0]={fieldName:this.list.options.bindings.isDividerKey,cond:"false",logic:"And"}}this.list.dataSource.settings.filtering.expressions=c;if(this.options.type==="local"){if(c.length>0){this.list.dataSource.filter(c,"AND")}else{this.list.dataSource.clearLocalFilter()}}},_cmp:function(c,d,e){if(c){if(typeof(c)==="function"){return c(d,e)}return window[c](d,e)}return d===e},_groupName:function(c,d){if(c){if(typeof(c)==="function"){return c(d)}return window[c](d)}return d},_getPresetByFirstFieldName:function(c){var d;if(this.options.presets){for(d=0;d<this.options.presets.length;++d){if(this.options.presets[d].sortedFields&&this.options.presets[d].sortedFields.length>0&&this.options.presets[d].sortedFields[0].fieldName===c){return this.options.presets[d]}}}return null},_renderingTray:function(c,n){var l=this,o,p,h=0,g,f,d,k,m=[];if(c.target.id!==this.list.element[0].id){return}if(this.options.autoGenerateSortPresets){if(this.options.presets===undefined||this.options.presets===null){this.options.presets=[]}f=this.list.dataSource.schema()?this.list.dataSource.schema().fields():null;g=parseInt(this.options.sortState,10);for(p=0;f&&p<f.length;++p,++h){d=f[p].name;if(d&&!this._getPresetByFirstFieldName(d)){this.options.presets.push({text:d,sortedFields:[{fieldName:d}]});if(h===g){k=this.options.presets[h].sortedFields}}}if((!this.list.dataSource.settings.sorting.defaultFields||!this.list.dataSource.settings.sorting.defaultFields.length)&&k&&k.length>0){for(p=0;p<k.length;++p){m[m.length]={fieldName:k[p].fieldName,dir:k[p].direction};if(m[p].dir===undefined||m[p].dir===null){m[p].dir="asc"}}this.list.dataSource.settings.sorting.defaultFields=m;this.list.dataSource.settings.sorting.expressions=m;if(this.list.options.bindings&&this.list.options.bindings.isDividerKey){if(m&&m.length>0){this._needToFilterDividers=m}}}}if(this.options.autoGenerateSortPresets||(this.options.presets&&this.options.presets.length>0)){n.needTray=2;if(n.css.indexOf("one")>-1){n.css=n.css.replace("one","two")}else{n.css=n.css+"-one"}o=a("<div />").addClass(this.css.sortPresets).append("<span>"+this._locale("sortPresetsLabel")+"</span>").append("<div><ul></ul></div>").find("ul").bind("click",this._presetTapHandler);o.append("<li class='"+this.css.preset+"' idx='default'>"+this._locale("sortDefaultStateText")+"</li>");for(p=0;this.options.presets&&p<this.options.presets.length;++p){o.append(a("<li class='"+this.css.preset+"' idx='"+p+"'>"+this.options.presets[p].text+"</li>"))}g=parseInt(this.options.sortState,10)+1;if(isNaN(g)){g=0}o.children().eq(g).addClass(this.css.presetSelected);if(!n.tray){n.tray=a("<div />")}o.children().eq(g).addClass(this.css.presetSelected);o=o.parent().bind({scroll:function(e){l._refreshPresets()}});if(o.scrollview){o.scrollview()}else{if(o.igScroll){o.igScroll({cancelStart:true})}}o.parent().appendTo(n.tray)}},_renderedTray:function(d){var e=this,c=a(window);if(this.options.presets&&this.options.presets.length>0){this._refreshPresets();c.bind("resize",function(){e._refreshPresets()});c.bind("orientationchange",function(){e._refreshPresets()})}},_refreshPresets:function(e){var f=this,c=a.mobile.activePage,d=this.list.element.closest(".ui-page");if(c&&c[0]===d[0]){if(!e){e=this.list.container().find("."+this.css.sortPresets)}a(e).find("li").removeClass(f.css.presetHidden).each(function(l,o){var g=a(o.parentNode.parentNode),h=a(o),m=h.offset().left,n=h.width(),k=g.outerWidth(),j=Math.min(0,g.offset().left);if(m+n>k+j||m<j){h.addClass(f.css.presetHidden)}})}},_renderingTrayFooterBar:function(c,d){if((this.options.presets&&this.options.presets.length>0)||this.options.autoGenerateSortPresets){d.trayFooter.append("<span style='display:none;' class='"+this.css.separatorFooterText+"' data-trayRole='bullet'> &bull; </span>").append("<span class='"+this.css.separatorFooterText+"' style='display:none;'> "+this._locale("sortByLabel")+" </span>").append(this._presetSpan=a("<span data-trayRole='keyword' class='"+this.css.presetFooterText+"'></span>"));if(this.options.sortState!=="default"&&this.options.sortState!=="custom"&&this.options.presets[this.options.sortState]){this._presetSpan.text(this.options.presets[this.options.sortState].text).prev().show();if(this._presetSpan.prevAll('[data-trayRole="keyword"]').text()){this._presetSpan.prev().prev().show()}}}},_itemsRendering:function(g,q){var p=this.options.sortState,m,o,c=this.css,k,l=q.index,f=q.dataView,n,d=c.listDivider,r,j,h,s;if(!this.list._initialized&&this.options.autoGenerateSortPresets&&(!this.options.presets||this.options.presets.length===0)){if(this.options.presets===undefined||this.options.presets===null){this.options.presets=[]}j=this.list.dataSource.schema()?this.list.dataSource.schema().fields():null;if(!j||j.length===0){j=this.list.options.schema.fields}for(s=0;j&&s<j.length;++s){h=j[s].name;if(h&&!this._getPresetByFirstFieldName(h)){this.options.presets.push({text:h,sortedFields:[{fieldName:h}]})}}r=this.list.container().find("."+this.css.sortPresets).find("ul");for(s=0;this.options.presets&&s<this.options.presets.length;++s){r.append(a("<li class='"+this.css.preset+"' idx='"+s+"'>"+this.options.presets[s].text+"</li>"))}m=parseInt(this.options.sortState,10);if(!isNaN(m)){this.list.dataSource.settings.paging.appendPage=false;this.list.dataSource._data=[];this.list.dataSource._dataView=[];this._setOption("sortState",m);return false}}if(this.list.options.inset&&c.insetDivider){d+=" "+c.insetDivider}if(l===0&&this.list.dataSource.settings.paging.enabled&&this.list.dataSource.settings.paging.pageIndex>0){l=this.list.dataSource.settings.paging.pageSize*this.list.dataSource.settings.paging.pageIndex-1}if(this._shouldGroup===undefined&&p!==null&&p!==""){if(p==="default"){if(this.options.showGrouping&&this.options.sortedFields.length>0){this._shouldGroup=true;this._nameFx=this.options.groupNameFunction;this._grpFx=this.options.groupComparerFunction;k=this._grpField=this.options.sortedFields[0].fieldName}else{this._shouldGroup=false}}else{if(p!=="custom"){m=parseInt(p,10);o=this.options.presets[m];if(o.showGrouping&&o.sortedFields.length>0){this._shouldGroup=true;this._nameFx=o.groupNameFunction;this._grpFx=o.groupComparerFunction;k=this._grpField=o.sortedFields[0].fieldName}else{this._shouldGroup=false}}}}else{k=this._grpField}if(this._lastGroupCount===undefined){this._lastGroupCount=0}if(this._shouldGroup&&f.length>0){if(q.listElement.html()!==""){this._lastGroup=q.listElement.find("."+d.split(" ")[1]).last();n=f[l];if(this._cmp(this._grpFx,n[k],f[l+1][k])){if(!this._lastGroupCount){this._lastGroupCount=parseInt(this._lastGroup.find(".ui-li-count").html(),10)}}else{this._lastGroup=null;this._lastGroupCount=0;if(this.options.dividerTemplate!==null&&this.options.dividerTemplate!==undefined&&this.options.dividerTemplate!==""){q.items+="<li class='"+d+"'>{TMPL}</li>"}else{q.items+="<li class='"+d+"'>"+this._groupName(this._nameFx,f[l][k])+"<span class='"+c.count+"'>{GCNT}</span></li>"}}}else{this._lastGroupCount=0;if(this.options.dividerTemplate!==null&&this.options.dividerTemplate!==undefined&&this.options.dividerTemplate!==""){q.items+="<li class='"+d+"'>{TMPL}</li>"}else{q.items+="<li class='"+d+"'>"+this._groupName(this._nameFx,f[l][k])+"<span class='"+c.count+"'>{GCNT}</span></li>"}}}},_itemRendered:function(g,k){var h=k.index,f=k.dataView,l=k.value,c=this.css,d=c.listDivider,j;if(this.list.options.inset&&c.insetDivider){d+=" "+c.insetDivider}if(this._shouldGroup){this._lastGroupCount++;if(h<f.length-1&&!this._cmp(this._grpFx,l[this._grpField],f[h+1][this._grpField])){if(this._lastGroup){if(this.options.dividerTemplate===null||this.options.dividerTemplate===undefined||this.options.dividerTemplate===""){this._lastGroup.find(".ui-li-count").html(this._lastGroupCount.toString())}else{this._lastGroup.html(a.ig.tmpl(this.options.dividerTemplate,{Count:this._lastGroupCount,LastValue:f[h],Name:this._groupName(this._nameFx,f[h][this._grpField])},{}))}this._lastGroup=null}else{if(this.options.dividerTemplate!==null&&this.options.dividerTemplate!==undefined&&this.options.dividerTemplate!==""){k.items=k.items.replace("{TMPL}",a.ig.tmpl(this.options.dividerTemplate,{Count:this._lastGroupCount,LastValue:f[h],Name:this._groupName(this._nameFx,f[h][this._grpField])},{}))}else{k.items=k.items.replace("{GCNT}",this._lastGroupCount)}}if(this.list.options.inset){j=c.insetBottomItem;if(this._lastGroupCount===1){j=c.insetTopItem+" "+c.insetBottomItem}k.items=k.items.replace("{EXTRACSS}","{EXTRACSS} "+j)}if(this.options.dividerTemplate!==null&&this.options.dividerTemplate!==undefined&&this.options.dividerTemplate!==""){k.items+="<li class='"+d+"'>{TMPL}</li>"}else{k.items+="<li class='"+d+"'>"+this._groupName(this._nameFx,f[h+1][this._grpField])+"<span class='"+c.count+"'>{GCNT}</span></li>"}this._lastGroupCount=0}else{if(h===f.length-1){if(this.options.dividerTemplate!==null&&this.options.dividerTemplate!==undefined&&this.options.dividerTemplate!==""){k.items=k.items.replace("{TMPL}",a.ig.tmpl(this.options.dividerTemplate,{Count:this._lastGroupCount,LastValue:f[h],Name:this._groupName(this._nameFx,f[h][this._grpField])},{}))}else{k.items=k.items.replace("{GCNT}",this._lastGroupCount)}if(this.list.options.inset){k.items=k.items.replace("{EXTRACSS}","{EXTRACSS} "+this.css.insetBottomItem)}}}if(this._lastGroupCount===1&&this.list.options.inset){k.items=k.items.replace("{EXTRACSS}","{EXTRACSS} "+this.css.insetTopItem)}}},_itemsRendered:function(d,g){var c=this.list.dataSource.dataView(),f=c.length-1;if(this._shouldGroup&&this._lastGroup){if(this.options.dividerTemplate===null||this.options.dividerTemplate===undefined||this.options.dividerTemplate===""){this._lastGroup.find(".ui-li-count").html(this._lastGroupCount.toString())}else{this._lastGroup.html(a.ig.tmpl(this.options.dividerTemplate,{Count:this._lastGroupCount,LastValue:c[f],Name:this._groupName(this._nameFx,c[f][this._grpField])},{}))}this._lastGroup=null;if(this.list.options.inset){if(this.css.insetTopItem.indexOf("ui-corner-top")>-1){this.list.listElement.children(".ui-corner-top").find(".ui-btn-inner").not(".ui-li-link-alt span:first-child").addClass("ui-corner-top").end().end().find(".ui-li-thumb").not(".ui-li-icon").addClass("ui-corner-tl")}if(this.css.insetBottomItem.indexOf("ui-corner-bottom")>-1){this.list.listElement.children(".ui-corner-bottom").find(".ui-btn-inner").not(".ui-li-link-alt span:first-child").addClass("ui-corner-bottom").end().end().find(".ui-li-thumb").not(".ui-li-icon").addClass("ui-corner-bl")}}}delete this._shouldGroup;delete this._nameFx;delete this._grpFx;delete this._grpField;if(this.options.dividerTemplate===""||!this.list._loadOnDemand){delete this._lastGroupCount}if(this._shouldFirePresetChanged){this._trigger(this.events.presetChanged,null,{state:this.options.sortState,owner:this});this._shouldFirePresetChanged=false}a.mobile.hidePageLoadingMsg()},_cancelButtonClicked:function(c,f){var d;if(this.options.sortState!=="default"){d=this._trigger(this.events.presetChanging,null,{state:"default",owner:this});if(d){a.mobile.showPageLoadingMsg();this._shouldFirePresetChanged=true;this._setOption("sortState","default");return false}}return true},_dataRendering:function(c,d){if(this.list._dataBinding&&this.options.type==="local"&&this._needToFilterDividers){this._filterOutDividers(this._needToFilterDividers);delete this._needToFilterDividers}},_createHandlers:function(){this._renderingTrayHandler=a.proxy(this._renderingTray,this);this._renderedTrayHandler=a.proxy(this._renderedTray,this);this._itemsRenderingHandler=a.proxy(this._itemsRendering,this);this._renderingTrayFooterBarHandler=a.proxy(this._renderingTrayFooterBar,this);this._itemRenderedHandler=a.proxy(this._itemRendered,this);this._itemsRenderedHandler=a.proxy(this._itemsRendered,this);this._cancelButtonClickedHandler=a.proxy(this._cancelButtonClicked,this);this._dataRenderingHandler=a.proxy(this._dataRendering,this)},_registerEvents:function(){this.list.element.bind("iglistrenderingtray",this._renderingTrayHandler);this.list.element.bind("iglistrenderedtray",this._renderedTrayHandler);this.list.element.bind("iglistitemsrendering",this._itemsRenderingHandler);this.list.element.bind("iglistrenderingtrayfooterbar",this._renderingTrayFooterBarHandler);this.list.element.bind("iglist_itemrendered",this._itemRenderedHandler);this.list.element.bind("iglistitemsrendered",this._itemsRenderedHandler);this.list.element.bind("iglistviewfiltering_cancelbuttonclicked",this._cancelButtonClickedHandler);this.list.element.bind("iglistdatarendering",this._dataRenderingHandler)},_unregisterEvents:function(){this.list.element.unbind("iglistrenderingtray",this._renderingTrayHandler);this.list.element.unbind("iglistrenderedtray",this._renderedTrayHandler);this.list.element.unbind("iglistrenderingtrayfooterbar",this._renderingTrayFooterBarHandler);this.list.element.unbind("iglistitemsrendering",this._itemsRenderingHandler);this.list.element.unbind("iglist_itemrendered",this._itemRenderedHandler);this.list.element.unbind("iglistitemsrendered",this._itemsRenderedHandler);this.list.element.unbind("iglistviewfiltering_cancelbuttonclicked",this._cancelButtonClickedHandler);this.list.element.unbind("iglistdatarendering",this._dataRenderingHandler);delete this._renderingTrayHandler;delete this._renderedTrayHandler;delete this._itemsRenderingHandler;delete this._renderingTrayFooterBarHandler;delete this._itemRenderedHandler;delete this._itemsRenderedHandler;delete this._cancelButtonClickedHandler;delete this._dataRenderingHandler},_injectList:function(d,c){var g,e,f=[];this.list=d;if(this.options.type===null){this.options.type=this.list._inferOpType()}if(this.options.type){this.list.dataSource.settings.sorting.type=this.options.type}else{this.list.dataSource.settings.sorting.type="remote"}this.list.dataSource.settings.sorting.enabled=true;this.list.dataSource.settings.sorting.caseSensitive=this.options.caseSensitive;this.list.dataSource.settings.sorting.defaultFields=this.list.dataSource.settings.sorting.expressions;this.list.dataSource.settings.sorting.sortUrlKey=this.options.sortUrlKey;this.list.dataSource.settings.sorting.sortUrlAscValueKey=this.options.sortUrlKeyAscValue;this.list.dataSource.settings.sorting.sortUrlDescValueKey=this.options.sortUrlKeyDescValue;if(a.type(this.options.customSortFunction)==="function"){this.list.dataSource.settings.sorting.customFunc=this.options.customSortFunction}e=this.options.sortedFields;if(this.options.sortState!=="default"&&this.options.presets&&this.options.presets[this.options.sortState]){e=this.options.presets[this.options.sortState].sortedFields}if(e&&e.length>0){for(g=0;g<e.length;++g){f[f.length]={fieldName:e[g].fieldName,dir:e[g].direction};if(f[g].dir===undefined||f[g].dir===null){f[g].dir="asc"}}this.list.dataSource.settings.sorting.defaultFields=f;this.list.dataSource.settings.sorting.expressions=f}if(this.list.options.bindings&&this.list.options.bindings.isDividerKey){this.list.dataSource._filter=true;if(f&&f.length>0){this._needToFilterDividers=f}}this._createHandlers();this._registerEvents()},destroy:function(){delete this._shouldGroup;delete this._nameFx;delete this._grpFx;delete this._grpField;delete this._lastGroupCount;if(this._presetSpan){this._presetSpan.prev().prev().remove().end().prev().remove().end().remove();delete this._presetSpan}this.list.container().find("."+this.css.sortPresets).remove();this._unregisterEvents();a.Widget.prototype.destroy.call(this);return this}});function b(d){return"-"+d.toLowerCase()}a(document).bind("_igListViewHtmlOptions",function(e,c){var d=c.element,h,f,g,j;if(d.jqmData("sorting")===true){if(!c.options.features){c.options.features=[]}h=c.options.features[c.options.features.length]={};h.name="Sorting";f=d.children(":jqmData(role='dividerTemplate')");if(f.length>0){h.dividerTemplate=unescape(f.first().html())}else{if(c.listElement){f=c.listElement.children(":jqmData(role='dividerTemplate')");if(f.length>0){h.dividerTemplate=unescape(f.first().html())}}}for(g in a.mobile.igListViewSorting.prototype.options){if(a.mobile.igListViewSorting.prototype.options.hasOwnProperty(g)){j=d.jqmData("sorting-"+g.replace(/[A-Z]/g,b));if(j!==undefined){h[g]=j}}}}});if(typeof define==="function"&&define.amd&&define.amd.jQuery){define("ig.mobileui.list.sorting",["ig.mobileui.list"],function(){return a.mobile.igListViewSorting})}a.extend(a.mobile.igListViewSorting,{version:"12.1.20121.1010"})}(jQuery));
/*
* Infragistics.Web.MobileUI Rating 12.1.20121.1010
*
* Copyright (c) 2011-2012 Infragistics Inc.
*
* http://www.infragistics.com/
*
* Depends on: 
*  jquery-1.6.4.js
*	jquery.ui.core.js
*/
(function(a){a.widget("mobile.igRating",a.mobile.widget,{options:{value:null,voteCount:5,voteWidth:0,voteHeight:0,readOnly:false,inputName:null},css:{normal:"ui-igrating ui-state-default ui-widget-content",selected:"ui-igrating-selected ui-state-highlight",vote:"ui-igrating-vote ui-icon ui-icon-star",voteSelected:"ui-igrating-voteselected",voteReadOnly:"ui-igrating-votereadonly",voteReadOnlySelected:"ui-igrating-votereadonlyselected"},events:{valueChange:null},_create:function(){var d,l,c,f,k={fontSize:"1px",width:"100%",height:"100%",position:"relative",overflow:"hidden"},j=this.options,g=this.element,h=this,e=this.css;d=this._count(j);l=g[0].style;h._old={width:l.width,height:l.height,html:g[0].innerHTML};h._swap=g.css("direction")==="rtl";f=h._elem=a("<div/>").css(k).addClass(e.normal).appendTo(g);c=a("<div/>").css(k).appendTo(f);h._doVotes(j,c);h._val=h._toNum(j.value);h._doVal(h._val);f.bind(h._evts={vmousedown:function(m){h._doEvt(m)}})},_toNum:function(c){if(!c){return 0}return(isNaN(c)||c<0)?0:c},_count:function(c){c=parseInt(c.voteCount,10);return isNaN(c)?5:Math.max(c,1)},_doVotes:function(r,d){var s,h,n,w,j,t,g,v=d,e=this._count(r),u={width:"100%",height:"100%"},c={left:"0px",top:"0px",position:"absolute",overflow:"hidden",border:"none",background:"none",whiteSpace:"nowrap"},p=-1,q=this,f=this.css,k=this._elem,l=this.element;if(!d){d=q._div.parent();q._div.remove();q._sel.remove();q._selSwap=null}j=q._div=a("<div/>").addClass(f.vote).css(c).appendTo(d);if(r.readOnly){j.addClass(f.voteReadOnly)}n=parseInt(r.voteHeight,10);w=parseInt(r.voteWidth,10);if(isNaN(n)||n<2){n=j.css("height");n=(!n||n.indexOf("px")<1)?16:parseInt(n,10)}if(isNaN(w)||w<2){w=j.css("width");w=(!w||w.indexOf("px")<1)?16:parseInt(w,10)}j.removeClass(f.vote).removeClass(f.voteReadOnly);s=q._sel=a("<div/>").addClass(f.selected).css(u).css(c).appendTo(d);if(q._swap){q._selSwap=s=a("<div/>").css(u).appendTo(q._sel)}h={display:"inline-block",width:w,height:n,textIndent:"0px",overflow:"visible"};while(++p<e){t=a("<span />").addClass(f.vote).css(h).appendTo(j);if(r.readOnly){t.addClass(f.voteReadOnly)}g=r.cssVotes?r.cssVotes[p]:null;if(g&&g[0]){t.addClass(g[0])}t[0]._i=p;t=a("<span />").addClass(f.vote).addClass(f.voteSelected).css(h).appendTo(s);if(r.readOnly){t.addClass(f.voteReadOnlySelected)}if(g&&g[1]){t.addClass(g[1])}t[0]._i=p;if(q._swap&&!q._selSwap){q._selSwap=t}}q._size=w;w*=e;k.css({height:n+"px",width:w+"px"});try{n+=((p=Math.max(k.outerHeight()-k.innerHeight(),0))>10)?2:p;w+=((p=Math.max(k.outerWidth()-k.innerWidth(),0))>10)?2:p}catch(m){}l.css({height:n+"px",width:w+"px"});j.css(u);if(!v){q.value(q.value())}},_doEvt:function(c){var f,d=this,e=this.options;if(e.readOnly||!d._sel){return}f=d._valFromEvt(c);if(f<0){return}d._doVal(f,c);c.preventDefault()},_setOption:function(d,f){var c,e=this.options;if(e[d]===f){return}c=this._count(e);e[d]=f;if(d.indexOf("vote")===0||d==="readOnly"){this._doVotes(e)}if(d.indexOf("value")>=0){this._doVal(f,d.length>6)}},_valFromEvt:function(d){var j,e,l,h,f,k=d?d.target:null,g=this.options,c=this._count(g);f=(k&&k.nodeName==="SPAN")?k._i:null;if(f===null||f===undefined){return -1}if(!k.unselectable){k.unselectable="on"}h=d.offsetX;if(h===null||h===undefined){h=d.layerX;if((h===null||h===undefined)&&d.originalEvent){h=d.originalEvent.offsetX}}if(d.originalEvent&&d.originalEvent.type.indexOf("touch")!==-1){if(h<=0){h+=d.clientX+0.05}if(this._swap){e=parseInt(k.parentNode.style.marginLeft.replace("px",""),10);if(isNaN(e)){e=0}h-=e}}else{j=this._size;e=-1*parseInt(k.parentNode.style.marginLeft.replace("px",""),10);if(isNaN(e)){e=0}if(this._swap){h+=e}j*=this._swap?c-f-1:f;e=-(k.offsetLeft);if(this._swap){h-=e}if(this._swap&&a.browser.mozilla&&e<j){h+=e}if(j>h&&!this._swap){h+=j}h+=0.05}l=this._swap?Math.floor(h/this._size):Math.ceil(h/this._size);if(this._swap){l=c-l}return Math.max(Math.min(l,c),0)},_doVal:function(l,d){var c,g=this.options,j=this._sel,h=this._size,k=this._swap?this._selSwap:null,e,f;if(j){j=j[0];if(j){j=j.style}}if(!j){return}c=this._count(g);if(isNaN(l)){l=-1}if(d&&d.type&&!this._trigger("valueChange",d,{value:l,oldValue:this._val})){return}this._val=g.value=l;e=g.inputName;if(e){f=a('input[name="'+e+'"]');if(f.length===0){f=a('<input type="hidden" name="'+e+'" />').appendTo(this.element.parent())}f.val(l)}if(k){l=c-l}l=g.readOnly?Math.round(l*2)/2:Math.round(l);l=Math.floor(l*h+0.3);l+="px";if(k){k=k[0];if(k){k=k.style}}if(k){j.left=l;k.marginLeft="-"+l}else{j.width=l}},value:function(c){if(typeof c!=="number"){return this._val}this._doVal(c,false);return this},destroy:function(){var d=this._old,c=this.element;if(!this._elem){return this}this._elem.remove();c[0].style.width=d.width;c[0].style.height=d.height;c[0].innerHTML=d.html;a.Widget.prototype.destroy.apply(this,arguments);this._elem=this._sel=this._selSwap=this._evts=null;return this}});function b(c){var d=document;if(c){d=c.target}a.each(a(d).find(":jqmData(role='igrating')"),function(e,f){a(f).igRating(a(f).jqmData())})}if(a.ig&&a.ig.loader){a.ig.loader().preinit(b)}a(document).bind("pagecreate create",b);a.extend(a.mobile.igRating,{version:"12.1.20121.1010"})}(jQuery));